(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"B+Ku":function(e,t,n){"use strict";n.r(t),n.d(t,"CodeModule",(function(){return Io}));var i=n("3Pt+"),o=n("ofXK"),r=n("kt0X"),c=n("snw9"),a=n("B3rN"),s=n("BOKU"),l=n("fEDK"),u=n("eY+I"),d=n("M0ag"),p=n("OaQ9"),b=n("0P6F"),f=n("AytR"),h=n("mrSG"),v=Object(r.n)("[Code Custom App] load custom apps"),g=Object(r.n)("[Code Custom App] loaded custom apps",Object(r.s)()),m=Object(r.n)("[Code Custom App] load app",Object(r.s)()),j=Object(r.n)("[Code Custom App] load app links"),y=Object(r.n)("[Code Custom App] loaded app",Object(r.s)()),O=Object(r.n)("[Code Custom App] save app link",Object(r.s)()),S=Object(r.n)("[Code Custom App] saved app link",Object(r.s)()),w=Object(r.n)("[Code Custom App] delete app links",Object(r.s)()),C=Object(r.n)("[Code Files] load user file links"),T=Object(r.n)("[Code Files] loaded user files",Object(r.s)()),x=Object(r.n)("[Code Custom App] save app link",Object(r.s)()),k=Object(r.n)("[Code] created new file",Object(r.s)()),I=Object(r.n)("[Code] remove new files",Object(r.s)()),M=(Object(r.u)({loadApps:v,loadedApps:g,loadApp:m,loadedApp:y,deleteAppLinks:w,savedAppLink:S,loadAppLinks:j}),Object(r.n)("[Code Tabs] close all tabs")),E=Object(r.n)("[Code Tabs] open link",Object(r.s)()),N=Object(r.n)("[Code Tabs] close tab",Object(r.s)()),P=Object(r.n)("[Code Tabs] changed app content",Object(r.s)()),q=(Object(r.n)("[Code Tabs] changed table",Object(r.s)()),Object(r.n)("[Code Tabs] changed view",Object(r.s)())),A=Object(r.n)("[Code Tabs] save app contents"),D=Object(r.n)("[Code Tabs] save connection tables"),B=Object(r.n)("[Code Tabs] saved app changes"),F=Object(r.n)("[Code Tabs] saved db objects",Object(r.s)()),R=Object(r.n)("[Code Tabs] deleted db object",Object(r.s)()),$=Object(r.n)("[Code Tabs] save app contents error",Object(r.s)()),z=Object(r.n)("[Code Tabs] update tabs content",Object(r.s)()),_=(Object(r.u)({openTab:E,closeTab:N,savedAppTabs:B,savedDbObjects:F}),Object(r.n)("[Code Tabs] load connections")),L=Object(r.n)("[Code Tabs] loaded connections",Object(r.s)()),U=Object(r.n)("[Code Tabs] select connection",Object(r.s)()),Q=Object(r.n)("[Code] reset"),H=n("SvZ3"),V={active:void 0,list:void 0,loading:!1,appLoading:!1,files:[],newLinks:[]},J=Object(r.p)(V,Object(r.r)(v,(function(e){return Object(h.a)(Object(h.a)({},e),{loading:!0})})),Object(r.r)(g,(function(e,t){var n=t.apps;return Object(h.a)(Object(h.a)({},e),{list:n,loading:!1})})),Object(r.r)(m,(function(e,t){var n=t.app;return Object(h.a)(Object(h.a)({},e),{appLoading:Boolean(n),active:n?e.active:null})})),Object(r.r)(y,(function(e,t){var n=t.app,i=t.links;return Object(h.a)(Object(h.a)({},e),{appLoading:!1,active:{app:n,links:i,linksToSave:null}})})),Object(r.r)(S,(function(e,t){var n=t.link;return n&&(e.active?e.active.links=Object(h.g)(e.active.links,[n]):e.files=Object(h.g)(e.files,[n])),Object(h.a)({},e)})),Object(r.r)(T,(function(e,t){var n=t.files;return Object(h.a)(Object(h.a)({},e),{files:n,active:null})})),Object(r.r)(Q,(function(e){return Object(h.a)({},V)})),Object(r.r)(k,(function(e,t){var n=t.link;return e.newLinks.includes(n)?e:Object(h.a)(Object(h.a)({},e),{newLinks:Object(h.g)(e.newLinks,[n])})})),Object(r.r)(I,(function(e,t){var n=t.links;return n?Object(h.a)(Object(h.a)({},e),{newLinks:e.newLinks.filter((function(e){return!n.find((function(t){return Object(H.b)(t,e)}))}))}):Object(h.a)(Object(h.a)({},e),{newLinks:[]})}))),X=n("JUga"),G={active:void 0,list:[],contentToSave:null,objectsToSave:{}},K=Object(r.p)(G,Object(r.r)(E,(function(e,t){var n=t.info,i=t.app,o=t.tabType,r=e.list.find((function(e){return Object(H.c)(e.info,n,o)}));if(r&&r===e.active)return e.active.app||(e.active.app=i),e;if(r)return Object(h.a)(Object(h.a)({},e),{active:r});var c={info:n,app:i,tabType:o};return Object(h.a)(Object(h.a)({},e),{list:Object(h.g)(e.list,[c]),active:c})})),Object(r.r)(N,(function(e,t){var n=t.links,i=e.list.filter((function(e){return!n.find((function(t){return Object(H.c)(e.info,t,e.tabType)}))})),o=e.active;i.length&&n.find((function(e){return Object(H.c)(e,null==o?void 0:o.info,o.tabType)}))&&(o=i[0]),0===i.length&&(o=null);var r=e.contentToSave;(null==r?void 0:r.length)&&(r=r.filter((function(e){return!n.find((function(t){return Object(H.c)(t,e,X.a.APP)}))})));var c=e.objectsToSave;return c&&n.filter((function(e){return e.sqlObject})).forEach((function(e){var t=e.connection,n=e.sqlObject,i=Object(H.f)(t,n);c.hasOwnProperty(i)&&delete c[i]})),Object(h.a)(Object(h.a)({},e),{active:o,list:i,contentToSave:r,objectsToSave:c})})),Object(r.r)(M,(function(e){return Object(h.a)(Object(h.a)({},e),{list:[],contentToSave:null})})),Object(r.r)(P,(function(e,t){var n=t.link,i=n.content,o=Object(h.g)(e.contentToSave||[]),r=o.find((function(e){return Object(H.b)(e,n)}));return"string"==typeof i?r?r.content=i:o.push(Object(h.a)({},n)):null===i&&r&&(o=o.filter((function(e){return!Object(H.b)(e,n)}))),Object(h.a)(Object(h.a)({},e),{contentToSave:o})})),Object(r.r)(B,(function(e){return Object(h.a)(Object(h.a)({},e),{contentToSave:null})})),Object(r.r)(F,(function(e){return Object(h.a)(Object(h.a)({},e),{objectsToSave:{}})})),Object(r.r)(q,(function(e,t){var n=t.key,i=t.data;return i?e.objectsToSave[n]=i:delete e.objectsToSave[n],Object(h.a)(Object(h.a)({},e),{objectsToSave:Object(h.a)({},e.objectsToSave)})})),Object(r.r)(z,(function(e,t){var n=t.changes,i=e.list.map((function(e){var t,i=e.info.sqlObject,o=null===(t=n.find((function(e){return e.structure.objectName===i.objectName&&e.structure.schemaName===i.schemaName})))||void 0===t?void 0:t.structureChange;return o&&Object.assign(e.info.sqlObject,o),e}));return Object(h.a)(Object(h.a)({},e),{list:i})})),Object(r.r)(Q,(function(){return G}))),W={customApp:function(e,t){return void 0===e&&(e=V),J(e,t)},tabs:function(e,t){return void 0===e&&(e=G),K(e,t)},connections:Object(r.p)({list:[],active:null},Object(r.r)(L,(function(e,t){var n=t.connections;return Object(h.a)(Object(h.a)({},e),{list:n})})),Object(r.r)(Q,(function(){return{list:[],active:null}})),Object(r.r)(U,(function(e,t){var n=t.connection,i=!n.connectionId&&e.list.length?e.list.find((function(e){return e.connectionName===n.connectionName})):n;return Object(h.a)(Object(h.a)({},e),{active:i})})))},Z=[],Y=n("LRne"),ee=n("cp0P"),te=n("z6cu"),ne=n("EY2u"),ie=n("eIep"),oe=n("lJxs"),re=n("JIr8"),ce=n("pLZG"),ae=n("zp1y"),se=n("5+tZ"),le=n("ZF+8"),ue=n("0CDM"),de=Object(r.o)("customApp"),pe=Object(r.q)(de,(function(e){return e.list})),be=Object(r.q)(de,(function(e){return e.active})),fe=Object(r.q)(de,(function(e){var t;return null===(t=e.active)||void 0===t?void 0:t.app})),he=Object(r.q)(de,(function(e){return e.active?Object(h.g)(e.active.links,e.newLinks):Object(h.g)(e.files,e.newLinks)})),ve=Object(r.o)("tabs"),ge=Object(r.q)(ve,(function(e){return e.list})),me=Object(r.q)(ve,(function(e){return e.active})),je=Object(r.q)(ve,(function(e){return e.contentToSave})),ye=Object(r.q)(ve,(function(e){return e.objectsToSave})),Oe=Object(r.q)(ve,(function(e){var t;return!(!(null===(t=e.contentToSave)||void 0===t?void 0:t.length)&&!Object.keys(e.objectsToSave).length)})),Se=function(e){return e.connections.list},we=function(e){return e.connections.active},Ce=n("QDG+"),Te=n("fXoL"),xe=function(){function e(e,t){this.userFilesService=e,this.appService=t}return e.prototype.deleteContent=function(e,t){var n,i;return e?this.appService.deleteAppContent({appName:null===(n=e.app)||void 0===n?void 0:n.appName,appOwnerName:null===(i=e.app)||void 0===i?void 0:i.ownerName,appContent:t}):this.userFilesService.deleteFileContent(t)},e.prototype.saveContent=function(e,t){return e?this.appService.saveAppLink({appOwnerName:e.app.ownerName,appName:e.app.appName,appContent:t}):this.userFilesService.saveFileLink(t)},e.\u0275fac=function(t){return new(t||e)(Te.Xb(Ce.a),Te.Xb(ue.a))},e.\u0275prov=Te.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),ke=function(){function e(e,t,n,i,o,r){var a=this;this.actions$=e,this.appService=t,this.notificationService=n,this.userFilesService=i,this.codeService=o,this.store=r,this.loadApps$=Object(c.d)((function(){return a.actions$.pipe(Object(c.e)(v),Object(ie.a)((function(){return a.appService.loadMyApps()})),Object(oe.a)((function(e){return g({apps:e})})),Object(re.a)((function(e){return a.notificationService.error(e,"Failed to load apps list."),Object(Y.a)(g({apps:[]}))})))})),this.loadApp$=Object(c.d)((function(){return a.actions$.pipe(Object(c.e)(m),Object(ce.a)((function(e){return Boolean(e.app)})),Object(ie.a)((function(e){return Object(ee.a)([a.appService.getAppInfo().pipe(Object(re.a)((function(e){return Object(te.a)(e)}))),a.appService.getAllLinks().pipe(Object(re.a)((function(e){return Object(te.a)(e)})))]).pipe(Object(oe.a)((function(e){return y({app:e[0],links:e[1]})})),Object(re.a)((function(e){return a.notificationService.error(e,"Failed to load app info."),Object(Y.a)(y({app:null,links:[]}))})))})))})),this.loadAppLinks$=Object(c.d)((function(){return a.actions$.pipe(Object(c.e)(j),Object(ae.a)(a.store.select(be)),Object(ie.a)((function(e){var t=e[1].app;return a.appService.getAllLinks().pipe(Object(oe.a)((function(e){return y({app:t,links:e})})),Object(re.a)((function(e){return Object(Y.a)(y({app:null,links:[]}))})))})))})),this.loadFileLinks$=Object(c.d)((function(){return a.actions$.pipe(Object(c.e)(C),Object(ie.a)((function(){return a.userFilesService.getAllLinks().pipe(Object(oe.a)((function(e){return T({files:e})})),Object(re.a)((function(e){return Object(Y.a)(T({files:[]}))})))})))})),this.deleteAppLinks$=Object(c.d)((function(){return a.actions$.pipe(Object(c.e)(w),Object(ae.a)(a.store.select(be)),Object(ie.a)((function(e){var t=e[1],n=e[0].links.filter((function(e){return e.contentId}));return n.length?Object(ee.a)(n.map((function(e){return a.codeService.deleteContent(t,e)}))).pipe(Object(oe.a)((function(){return a.notificationService.success("Deleted content."),t?j():C()})),Object(re.a)((function(e){return a.notificationService.error(e.error,"Failed to delete content."),t?Object(Y.a)(j()):Object(Y.a)(C())}))):ne.a})))})),this.saveAppContent$=Object(c.d)((function(){return a.actions$.pipe(Object(c.e)(O),Object(ae.a)(a.store.select(be)),Object(se.a)((function(e){var t=e[0].link,n=e[1];return a.codeService.saveContent(n,t).pipe(Object(ie.a)((function(e){var i=[S(null)];return t.contentId||(t.contentId=e,i=[S({link:t}),E({info:t,app:null==n?void 0:n.app,tabType:X.a.APP})]),i})),Object(re.a)((function(e){return a.notificationService.error(e,"Failed to save app content."),Object(Y.a)({type:"[Code Custom App] failed to save app content"})})))})))})),this.createNewFile$=Object(c.d)((function(){return a.actions$.pipe(Object(c.e)(k),Object(ae.a)(a.store.select(be)),Object(ie.a)((function(e){var t=e[0].link,n=e[1];return t.content="",[P({link:t}),E({info:t,app:null==n?void 0:n.app,tabType:X.a.APP})]})))}))}return e.\u0275fac=function(t){return new(t||e)(Te.Xb(c.a),Te.Xb(ue.a),Te.Xb(le.e),Te.Xb(Ce.a),Te.Xb(xe),Te.Xb(r.h))},e.\u0275prov=Te.Jb({token:e,factory:e.\u0275fac}),e}(),Ie=n("tyNb"),Me=n("itXk"),Ee=n("vkgz"),Ne=n("TwVa"),Pe=n("JGTj"),qe=n("5sEi"),Ae=n("OLrf"),De=n("GXwU"),Be=n("Xn/w"),Fe=n("Kj3r"),Re=n("44PX"),$e=n("XNiG"),ze=n("1G5W"),_e=n("xgIS"),Le=n("/uUt"),Ue=n("bU/s"),Qe=n("iFvM"),He=n("t3T2"),Ve=n("iMDe"),Je=n("iMra"),Xe=n("ZZj6"),Ge=n("dZIy"),Ke=n("cdP3"),We=n("0yZh"),Ze=n("psEu"),Ye=["scriptsEl"];function et(e,t){if(1&e&&(Te.Tb(0,"span",25),Te.Ec(1),Te.Sb()),2&e){var n=Te.dc();Te.Bb(1),Te.Gc("",n.evaluationTime/1e3," s")}}function tt(e,t){1&e&&Te.Ob(0,"app-assertion-logs",26),2&e&&Te.jc("assertions",t.ngIf.asserts)}function nt(e,t){if(1&e&&(Te.Tb(0,"option",6),Te.Ec(1),Te.Sb()),2&e){var n=t.$implicit;Te.jc("value",n),Te.Bb(1),Te.Fc(n)}}function it(e,t){1&e&&Te.Ob(0,"i",27)}function ot(e,t){1&e&&Te.Ob(0,"i",28)}function rt(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"ul",29),Te.Tb(1,"li",30),Te.Tb(2,"a",31),Te.bc("click",(function(){return Te.vc(n),Te.dc().toggleDirection()})),Te.Ec(3,"Toggle direction"),Te.Sb(),Te.Sb(),Te.Sb()}}function ct(e,t){if(1&e&&(Te.Tb(0,"p",37),Te.Ec(1),Te.Sb()),2&e){var n=t.$implicit;Te.Bb(1),Te.Fc(n)}}function at(e,t){if(1&e&&(Te.Tb(0,"alert",35),Te.Tb(1,"strong"),Te.Ec(2,"Runtime Error:"),Te.Sb(),Te.Cc(3,ct,2,1,"p",36),Te.Sb()),2&e){var n=Te.dc().ngIf;Te.Bb(3),Te.jc("ngForOf",n.errors)}}function st(e,t){if(1&e&&(Te.Rb(0),Te.Cc(1,at,4,1,"alert",32),Te.Ob(2,"app-show-in-presenter",33,34),Te.Qb()),2&e){var n=t.ngIf;Te.Bb(1),Te.jc("ngIf",n.errors&&n.errors.length),Te.Bb(1),Te.jc("items",n.showInItems)}}function lt(e,t){1&e&&(Te.Tb(0,"div",38),Te.Tb(1,"div",39),Te.Tb(2,"span",40),Te.Ec(3,"Loading..."),Te.Sb(),Te.Sb(),Te.Sb())}var ut=function(){function e(e,t){this.dialogService=e,this.appApiService=t,this.functionsChange=new Te.p,this.scriptChange=new Te.p,this.functions=[],this.loading=!1,this.direction="vertical",this.scriptSize=100,this.minSize=20,this.restInterpreter=new He.a(this.dialogService)}return e.prototype.ngOnInit=function(){var e=this;this.scriptsEditor=Object(Ue.edit)(this.scriptsEl.nativeElement,{mode:"ace/mode/python",autoScrollEditorIntoView:!0,tabSize:2,useSoftTabs:!0,indentedSoftWrap:!0,theme:Object(Qe.i)(),value:this.scripts||"",readOnly:!0===this.isReadOnly}),this.scriptsEditor.setOptions({enableBasicAutocompletion:!0,enableSnippets:!1,enableLiveAutocompletion:!0}),Object(_e.a)(this.scriptsEditor,"change").pipe(Object(Fe.a)(500),Object(Ee.a)((function(){e.scriptChange.emit(e.scriptsEditor.getValue())})),Object(oe.a)((function(){return Object(Qe.t)(e.getValue())})),Object(Le.a)()).subscribe((function(t){e.functions=t,e.functionsChange.emit(t)}))},e.prototype.ngOnChanges=function(e){var t=e.scripts;t&&!t.firstChange&&t.currentValue!==t.previousValue&&(this.scriptsEditor.setValue(t.currentValue||"",-1),this.restInterpreter.reset())},e.prototype.getValue=function(){return this.scriptsEditor.getValue()},e.prototype.isEmpty=function(){var e=this.restInterpreter.scriptContext;return!(e.errors.length||e.showInItems.length)},e.prototype.testFunction=function(){return Object(h.b)(this,void 0,void 0,(function(){var e,t,n;return Object(h.e)(this,(function(i){switch(i.label){case 0:if(this.loading=!0,e=this.scriptsEditor.getValue(),this.restInterpreter.reset(),this.selectedFunction&&!this.restInterpreter.interpreter.hasFunction(e,this.selectedFunction))return[3,4];i.label=1;case 1:return i.trys.push([1,,3,4]),this.evaluationTime=null,t=(new Date).getTime(),[4,this.restInterpreter.evaluate(e,Object(h.a)({},this.context),this.selectedFunction)];case 2:return null!=(n=i.sent())&&(this.restInterpreter.scriptContext.showInItems=Object(h.g)(this.restInterpreter.scriptContext.showInItems,[{type:Ve.c.ObjectExplorer,title:"Return Value",data:n}])),this.evaluationTime=+new Date-t,[3,4];case 3:return this.loading=!1,this.scriptSize=this.isEmpty()?100:50,this.onResize(),[7];case 4:return[2]}}))}))},e.prototype.toggleDirection=function(){this.direction="horizontal"===this.direction?"vertical":"horizontal",this.onResize()},e.prototype.onResize=function(){var e=this;window.requestAnimationFrame((function(){e.scriptsEditor.resize(),e.presenter.resize()}))},e.\u0275fac=function(t){return new(t||e)(Te.Nb(le.b),Te.Nb(Je.a))},e.\u0275cmp=Te.Hb({type:e,selectors:[["app-jspy-script"]],viewQuery:function(e,t){var n;1&e&&(Te.Ac(Ye,!0),Te.Jc(Xe.a,!0)),2&e&&(Te.rc(n=Te.cc())&&(t.scriptsEl=n.first),Te.rc(n=Te.cc())&&(t.presenter=n.first))},inputs:{context:"context",scripts:"scripts",isReadOnly:"isReadOnly"},outputs:{functionsChange:"functionsChange",scriptChange:"scriptChange"},features:[Te.zb],decls:28,vars:18,consts:[[1,"d-flex","h-100","flex-column"],[1,"form-group","row","m-0","mb-2","align-items-center"],["class","badge badge-info p-1",4,"ngIf"],["class","d-flex ml-2",3,"assertions",4,"ngIf"],["for","jspy-functions",1,"col-form-label","col-auto","ml-auto","py-1","px-2"],["id","jspy-functions","name","jspy-functions",1,"form-control","form-control-sm","col-3","col-md-2",3,"disabled","ngModel","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary","ml-2","align-self-baseline","btn-sm",3,"disabled","click"],["class","fa fa-spinner",4,"ngIf"],["class","fa fa-play",4,"ngIf"],["dropdown","","placement","bottom right",1,"position-relative"],["dropdownToggle","","type","button","title","Settings",1,"btn","btn-sm","mx-1"],[1,"fa","fa-ellipsis-v"],["class","dropdown-menu left-bottom-menu","role","menu",4,"dropdownMenu"],[1,"h-100",3,"direction","useTransition","gutterSize","transitionEnd","dragEnd"],["split","asSplit"],[1,"d-flex",3,"size","minSize"],["area1","asSplitArea"],[1,"flex-fill","card","m-0"],["scriptsEl",""],[3,"size","minSize"],[1,"card","overflow-hidden","mb-0","w-100","h-100","p-2"],[4,"ngIf"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner",4,"ngIf"],[1,"badge","badge-info","p-1"],[1,"d-flex","ml-2",3,"assertions"],[1,"fa","fa-spinner"],[1,"fa","fa-play"],["role","menu",1,"dropdown-menu","left-bottom-menu"],["role","menuitem"],[1,"dropdown-item","cursor-pointer","px-2","py-1",3,"click"],["type","danger",4,"ngIf"],[1,"h-100","overflow-auto",3,"items"],["showIn",""],["type","danger"],["class","mb-0",4,"ngFor","ngForOf"],[1,"mb-0"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(e,t){1&e&&(Te.Tb(0,"div",0),Te.Tb(1,"div",1),Te.Cc(2,et,2,1,"span",2),Te.Cc(3,tt,1,1,"app-assertion-logs",3),Te.Tb(4,"label",4),Te.Ec(5,"Functions"),Te.Sb(),Te.Tb(6,"select",5),Te.bc("ngModelChange",(function(e){return t.selectedFunction=e})),Te.Tb(7,"option",6),Te.Ec(8,"File"),Te.Sb(),Te.Cc(9,nt,2,2,"option",7),Te.Sb(),Te.Tb(10,"button",8),Te.bc("click",(function(){return t.testFunction()})),Te.Cc(11,it,1,0,"i",9),Te.Cc(12,ot,1,0,"i",10),Te.Ec(13," Run "),Te.Sb(),Te.Tb(14,"span",11),Te.Tb(15,"button",12),Te.Ob(16,"i",13),Te.Sb(),Te.Cc(17,rt,4,0,"ul",14),Te.Sb(),Te.Sb(),Te.Tb(18,"as-split",15,16),Te.bc("transitionEnd",(function(){return t.onResize()}))("dragEnd",(function(){return t.onResize()})),Te.Tb(20,"as-split-area",17,18),Te.Ob(22,"div",19,20),Te.Sb(),Te.Tb(24,"as-split-area",21),Te.Tb(25,"div",22),Te.Cc(26,st,4,2,"ng-container",23),Te.Sb(),Te.Sb(),Te.Sb(),Te.Sb(),Te.Cc(27,lt,4,0,"div",24)),2&e&&(Te.Bb(2),Te.jc("ngIf",t.evaluationTime),Te.Bb(1),Te.jc("ngIf",null==t.restInterpreter?null:t.restInterpreter.scriptContext),Te.Bb(3),Te.jc("disabled",!(t.functions&&t.functions.length))("ngModel",t.selectedFunction),Te.Bb(1),Te.jc("value",void 0),Te.Bb(2),Te.jc("ngForOf",t.functions),Te.Bb(1),Te.jc("disabled",t.loading),Te.Bb(1),Te.jc("ngIf",t.loading),Te.Bb(1),Te.jc("ngIf",!t.loading),Te.Bb(6),Te.jc("direction",t.direction)("useTransition",!0)("gutterSize",100===t.scriptSize?0:11),Te.Bb(2),Te.jc("size",t.scriptSize)("minSize",t.minSize),Te.Bb(4),Te.jc("size",100-t.scriptSize)("minSize",t.minSize),Te.Bb(2),Te.jc("ngIf",t.restInterpreter.scriptContext),Te.Bb(1),Te.jc("ngIf",t.loading))},directives:[o.m,i.r,i.i,i.l,i.m,i.s,o.l,Ge.a,Ge.d,Ge.b,Ke.c,Ke.b,We.a,Xe.a,Ze.a],styles:["alert[_ngcontent-%COMP%]     .alert{padding-top:.5rem;padding-bottom:.5rem;margin-bottom:0;border:none}"]}),e}();function dt(e,t){1&e&&(Te.Tb(0,"div",4),Te.Tb(1,"div",5),Te.Tb(2,"span",6),Te.Ec(3,"Loading..."),Te.Sb(),Te.Sb(),Te.Sb())}function pt(e,t){if(1&e){var n=Te.Ub();Te.Rb(0),Te.Tb(1,"app-jspy-script",2),Te.bc("scriptChange",(function(e){return Te.vc(n),Te.dc().onChange(e)})),Te.ec(2,"async"),Te.Sb(),Te.Cc(3,dt,4,0,"div",3),Te.Qb()}if(2&e){var i=Te.dc();Te.Bb(1),Te.jc("context",i.appContext)("isReadOnly",i.isReadOnly)("scripts",Te.fc(2,4,i.content$)),Te.Bb(2),Te.jc("ngIf",i.loading)}}function bt(e,t){if(1&e&&(Te.Tb(0,"alert",7),Te.Tb(1,"strong"),Te.Ec(2,"Error: "),Te.Sb(),Te.Ec(3),Te.Sb()),2&e){var n=Te.dc();Te.Bb(3),Te.Gc("",n.error," ")}}var ft=function(){function e(e,t,n,i,o){this.store=e,this.appService=t,this.userFilesService=n,this.authService=i,this.actions$=o,this.loading=!1,this.error=null,this.destroy$=new $e.a,this.pos=!0}return e.prototype.ngOnInit=function(){var e,t,n=this,i=this.tabData.info,o={appName:null===(e=this.tabData.app)||void 0===e?void 0:e.appName,appOwnerName:null===(t=this.tabData.app)||void 0===t?void 0:t.ownerName,folder:i.folder,name:i.name,contentType:i.contentType};this.contentPath=Object(qe.b)(o),this.appContext=this.appService.getAppContext(),this.content$=this.store.select(me).pipe(Object(ae.a)(this.store.select(je)),Object(ce.a)((function(e){var t=e[0],i=e[1];return t&&t.info===n.tabData.info&&!(null==i?void 0:i.some((function(e){return Object(H.b)(t.info,e)})))})),Object(ie.a)((function(){return n.loadContent(o).pipe(Object(oe.a)((function(e){if(!e)throw Error("No content for requested file "+n.contentPath);return n.tabData.info.contentId=e.contentId,e.content})),Object(Ee.a)((function(e){n.content=e,n.loading=!1})),Object(re.a)((function(e){var t;return(null===(t=n.appContext)||void 0===t?void 0:t.appInfo)?n.store.dispatch(N({links:[o]})):n.store.dispatch(k({link:o})),n.loading=!1,ne.a})))}))),this.actions$&&this.actions$.pipe(Object(ze.a)(this.destroy$),Object(c.e)($)).subscribe((function(e){var t=e.link,i=e.error;Object(H.b)(t,n.tabData.info)&&(n.error=i,n.store.dispatch(E(n.tabData)))}))},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.onChange=function(e){this.store.dispatch(P({link:Object(h.a)(Object(h.a)({},this.tabData.info),{content:e===this.content?null:e})}))},Object.defineProperty(e.prototype,"isReadOnly",{get:function(){var e;return(null===(e=this.appService.appContentService)||void 0===e?void 0:e.source)===Pe.b.FROM_FILE},enumerable:!1,configurable:!0}),e.prototype.loadContent=function(e){var t=this;return this.authService.isAuthenticated$.pipe(Object(ie.a)((function(){return t.loading=!0,t.tabData.app?t.appService.getAppContent(e):t.userFilesService.getFileContent(e)})))},e.\u0275fac=function(t){return new(t||e)(Te.Nb(r.h),Te.Nb(ue.a),Te.Nb(Ce.a),Te.Nb(Ae.b),Te.Nb(c.a))},e.\u0275cmp=Te.Hb({type:e,selectors:[["app-tab-jspy"]],hostVars:2,hostBindings:function(e,t){2&e&&Te.Fb("position-relative",t.pos)},inputs:{tabData:"tabData"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["errorTmpl",""],[1,"h-100","w-100",3,"context","isReadOnly","scripts","scriptChange"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner",4,"ngIf"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner"],["role","status",1,"spinner-border"],[1,"sr-only"],["type","danger"]],template:function(e,t){if(1&e&&(Te.Cc(0,pt,4,6,"ng-container",0),Te.Cc(1,bt,4,1,"ng-template",null,1,Te.Dc)),2&e){var n=Te.sc(2);Te.jc("ngIf",!t.error)("ngIfElse",n)}},directives:[o.m,ut,Ze.a],pipes:[o.b],styles:[".spinner[_ngcontent-%COMP%]{left:0}"]}),e}(),ht=n("K3ix"),vt=n("SxV6"),gt=n("UShy"),mt=n("Czp8"),jt=n("dv3C"),yt=n("u5sK"),Ot=n("Yh5v"),St=["uiModelEl"];function wt(e,t){if(1&e&&(Te.Tb(0,"alert",17),Te.Tb(1,"strong"),Te.Ec(2,"Error:"),Te.Sb(),Te.Ec(3),Te.Sb()),2&e){var n=Te.dc();Te.Bb(3),Te.Gc(" ",n.error," ")}}function Ct(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"app-page",18),Te.bc("error",(function(e){return Te.vc(n),Te.dc().onError(e.error)})),Te.Sb()}if(2&e){var i=Te.dc();Te.jc("queryParams",i.queryParams)("pageContent",i.pageContent)}}function Tt(e,t){1&e&&(Te.Tb(0,"div",19),Te.Tb(1,"div",20),Te.Tb(2,"span",21),Te.Ec(3,"Loading..."),Te.Sb(),Te.Sb(),Te.Sb())}function xt(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"div",22),Te.Tb(1,"h4",23),Te.Ec(2,"Page Data Model"),Te.Sb(),Te.Tb(3,"button",24),Te.bc("click",(function(){return Te.vc(n),Te.dc().modalRef.hide()})),Te.Tb(4,"span",25),Te.Ec(5,"\xd7"),Te.Sb(),Te.Sb(),Te.Sb(),Te.Tb(6,"div",26),Te.Ob(7,"ngx-dynamic-component",27),Te.Sb(),Te.Tb(8,"div",28),Te.Tb(9,"button",29),Te.bc("click",(function(){return Te.vc(n),Te.dc().modalRef.hide()})),Te.Ec(10,"Close"),Te.Sb(),Te.Sb()}if(2&e){var i=Te.dc();Te.Bb(7),Te.lc("uiModel",'<grid-object-explorer host="',i.contentPath,'-data-model" binding="$"></grid-object-explorer>'),Te.jc("dataModel",i.pageComponent.dataModel)}}var kt=function(e){function t(t,n,i,o,r,c){var a=e.call(this,t,n,o,r,i)||this;return a.store=t,a.appService=n,a.actions$=i,a.userFilesService=o,a.authService=r,a.modalService=c,a}return Object(h.d)(t,e),t.prototype.ngOnInit=function(){return Object(h.b)(this,void 0,void 0,(function(){var t,n=this;return Object(h.e)(this,(function(i){switch(i.label){case 0:return e.prototype.ngOnInit.call(this),this.loading=!0,this.bindingProp=u.c.get("binding")||{name:"binding"},this.bindingProp.valuesFn=Object(yt.a)((function(){var e;return null===(e=n.pageComponent)||void 0===e?void 0:e.dataModel})),u.c.set("binding",this.bindingProp),[4,this.initModelEditor()];case 1:return t=i.sent(),this.onReload(t),[2]}}))}))},t.prototype.ngOnDestroy=function(){this.bindingProp.valuesFn=null},t.prototype.showDataModel=function(e){this.modalRef=this.modalService.show(e,{class:"modal-xl full-height"})},t.prototype.initModelEditor=function(){var e=this;return this.interpretator=Object(gt.a)(),this.uiModelEditor=Object(Ue.edit)(this.uiModelEl.nativeElement,{mode:"ace/mode/xml",autoScrollEditorIntoView:!0,tabSize:2,useSoftTabs:!0,indentedSoftWrap:!0,theme:Object(d.f)(),readOnly:this.isReadOnly}),this.uiModelEditor.setOptions({enableBasicAutocompletion:!0,enableSnippets:!1,enableLiveAutocompletion:!0}),this.content$.subscribe((function(t){return e.uiModelEditor.setValue(t||"",-1)})),Object(_e.a)(this.uiModelEditor,"change").pipe(Object(Fe.a)(500)).subscribe((function(){return e.onChange(e.uiModelEditor.getValue())})),this.content$.pipe(Object(vt.a)()).toPromise()},t.prototype.onReload=function(e){return Object(h.b)(this,void 0,void 0,(function(){var t,n,i,o;return Object(h.e)(this,(function(r){switch(r.label){case 0:this.loading=!0,this.pageContent=null,this.error=null,r.label=1;case 1:return r.trys.push([1,6,7,8]),t={pageContentId:null,pageContent:this.uiModelEditor.getValue()||e},[4,this.appService.getDesignQueryUrl$(t).toPromise()];case 2:return n=r.sent(),this.tabData.info.queryString=n,this.queryParams=Object(d.j)(null,n),[4,this.appService.getPageDesignCode$(t).toPromise()];case 3:return(i=r.sent())?[4,this.interpretator.evaluate(i,{session:mt.a.contextVariables,app:mt.a.variables,mockObject:function(e,t){Object.entries(t).forEach((function(t){var n=t[0],i=t[1];Object(gt.c)(e,n,i)}))}},"beforeReload")]:[3,5];case 4:r.sent(),r.label=5;case 5:return this.pageContent=t,[3,8];case 6:return o=r.sent(),this.error=Object(d.h)(o),[3,8];case 7:return this.loading=!1,[7];case 8:return[2]}}))}))},t.prototype.onError=function(e){this.error=Object(d.h)(e)},t.\u0275fac=function(e){return new(e||t)(Te.Nb(r.h),Te.Nb(ue.a),Te.Nb(c.a),Te.Nb(Ce.a),Te.Nb(Ae.b),Te.Nb(ht.a))},t.\u0275cmp=Te.Hb({type:t,selectors:[["app-tab-page"]],viewQuery:function(e,t){var n;1&e&&(Te.Ac(St,!0),Te.Jc(jt.a,!0)),2&e&&(Te.rc(n=Te.cc())&&(t.uiModelEl=n.first),Te.rc(n=Te.cc())&&(t.pageComponent=n.first))},features:[Te.yb],decls:23,vars:4,consts:[[1,"row","m-0","mb-2"],[1,"mb-0","align-self-center"],["type","button","title","Page Data Model",1,"btn","btn-light","ml-auto","mr-2",3,"click"],["type","button",1,"btn","btn-primary","mr-1",3,"click"],[1,"h-100","overflow-hidden"],["left","",1,"w-100"],["uiModelEl",""],["right",""],[1,"position-relative","h-100","overflow-hidden"],["type","danger",4,"ngIf"],[3,"queryParams","pageContent","error",4,"ngIf"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],["left-label",""],[1,"fa","fa-code","fa-lg"],["right-label",""],[1,"fa","fa-picture-o","fa-lg"],["dataModelTmpl",""],["type","danger"],[3,"queryParams","pageContent","error"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-new-rest.restborder"],[1,"sr-only"],[1,"modal-header"],[1,"modal-title","pull-left"],["type","button","aria-label","Close",1,"close","pull-right",3,"click"],["aria-hidden","true"],[1,"modal-body","overflow-hidden","px-4"],[3,"uiModel","dataModel"],[1,"modal-footer","flex-column"],["type","button",1,"btn","btn-light","ml-auto","mr-2",3,"click"]],template:function(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"div",0),Te.Tb(1,"h5",1),Te.Ec(2),Te.Sb(),Te.Tb(3,"button",2),Te.bc("click",(function(){Te.vc(n);var e=Te.sc(22);return t.showDataModel(e)})),Te.Ec(4,"Data Model"),Te.Sb(),Te.Tb(5,"button",3),Te.bc("click",(function(){return t.onReload()})),Te.Ec(6,"Reload"),Te.Sb(),Te.Sb(),Te.Tb(7,"app-split-content",4),Te.Ob(8,"div",5,6),Te.Rb(10,7),Te.Tb(11,"div",8),Te.Cc(12,wt,4,1,"alert",9),Te.Cc(13,Ct,1,2,"app-page",10),Te.Cc(14,Tt,4,0,"div",11),Te.Sb(),Te.Qb(),Te.Rb(15,12),Te.Ob(16,"i",13),Te.Ec(17," Code "),Te.Qb(),Te.Rb(18,14),Te.Ob(19,"i",15),Te.Ec(20," Preview "),Te.Qb(),Te.Sb(),Te.Cc(21,xt,11,2,"ng-template",null,16,Te.Dc)}2&e&&(Te.Bb(2),Te.Fc(t.tabData.info.name),Te.Bb(10),Te.jc("ngIf",t.error),Te.Bb(1),Te.jc("ngIf",t.pageContent),Te.Bb(1),Te.jc("ngIf",t.loading))},directives:[Ot.a,o.m,Ze.a,jt.a,u.h],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"]}),t}(ft),It=["uiModelEl"];function Mt(e,t){1&e&&(Te.Tb(0,"div",5),Te.Tb(1,"div",6),Te.Tb(2,"span",7),Te.Ec(3,"Loading..."),Te.Sb(),Te.Sb(),Te.Sb())}function Et(e,t){if(1&e&&(Te.Rb(0),Te.Ob(1,"div",2,3),Te.Cc(3,Mt,4,0,"div",4),Te.Qb()),2&e){var n=Te.dc();Te.Bb(3),Te.jc("ngIf",n.loading)}}function Nt(e,t){if(1&e&&(Te.Tb(0,"alert",8),Te.Tb(1,"strong"),Te.Ec(2,"Error: "),Te.Sb(),Te.Ec(3),Te.Sb()),2&e){var n=Te.dc();Te.Bb(3),Te.Gc("",n.error," ")}}var Pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(h.d)(t,e),t.prototype.ngAfterViewInit=function(){var e=this;this.uiModelEditor=Object(Ue.edit)(this.uiModelEl.nativeElement,{mode:"ace/mode/xml",autoScrollEditorIntoView:!0,tabSize:2,useSoftTabs:!0,indentedSoftWrap:!0,theme:Object(d.f)()}),this.content$.subscribe((function(t){return e.uiModelEditor.setValue(t||"",-1)})),Object(_e.a)(this.uiModelEditor,"change").pipe(Object(Fe.a)(500)).subscribe((function(){return e.onChange(e.uiModelEditor.getValue())}))},t.\u0275fac=function(e){return qt(e||t)},t.\u0275cmp=Te.Hb({type:t,selectors:[["app-tab-xml"]],viewQuery:function(e,t){var n;1&e&&Te.Jc(It,!0),2&e&&Te.rc(n=Te.cc())&&(t.uiModelEl=n.first)},features:[Te.yb],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["errorTmpl",""],[1,"d-flex","flex-fill","h-100"],["uiModelEl",""],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner",4,"ngIf"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner"],["role","status",1,"spinner-border"],[1,"sr-only"],["type","danger"]],template:function(e,t){if(1&e&&(Te.Cc(0,Et,4,1,"ng-container",0),Te.Cc(1,Nt,4,1,"ng-template",null,1,Te.Dc)),2&e){var n=Te.sc(2);Te.jc("ngIf",!t.error)("ngIfElse",n)}},directives:[o.m,Ze.a],styles:[".spinner[_ngcontent-%COMP%]{left:0}"]}),t}(ft),qt=Te.Vb(Pt),At=n("lMX+"),Dt=n("efbX"),Bt=n("01LN"),Ft=n("0Iky"),Rt=["sqlElement"],$t=["dcGrid"];function zt(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"li",22),Te.Tb(1,"a",23),Te.bc("click",(function(){Te.vc(n);var e=t.$implicit;return Te.dc(2).onSelectConnection(e.connectionName)})),Te.Ec(2),Te.Sb(),Te.Sb()}if(2&e){var i=t.$implicit;Te.Bb(2),Te.Fc(i.connectionName)}}function _t(e,t){if(1&e&&(Te.Tb(0,"ul",20),Te.Cc(1,zt,3,1,"li",21),Te.Sb()),2&e){var n=Te.dc();Te.Bb(1),Te.jc("ngForOf",n.connections)}}function Lt(e,t){if(1&e&&(Te.Tb(0,"span",24),Te.Ec(1),Te.Sb()),2&e){var n=Te.dc();Te.Bb(1),Te.Gc("",n.data.length," rows")}}function Ut(e,t){1&e&&(Te.Tb(0,"div",25),Te.Tb(1,"div",26),Te.Tb(2,"span",27),Te.Ec(3,"Loading..."),Te.Sb(),Te.Sb(),Te.Sb())}function Qt(e,t){if(1&e&&(Te.Tb(0,"alert",28),Te.Tb(1,"strong"),Te.Ec(2,"Error:"),Te.Sb(),Te.Ec(3),Te.Sb()),2&e){var n=Te.dc();Te.Bb(3),Te.Gc(" ",n.error," ")}}function Ht(e,t){if(1&e&&Te.Ob(0,"dc-grid",29,30),2&e){var n=Te.dc();Te.jc("uiModel",n.gridUIModel)("dataModel",n.dataModel)}}var Vt=function(e){function t(t,n,i,o,r,c,a){var s=e.call(this,t,n,o,r,i)||this;return s.store=t,s.appService=n,s.actions$=i,s.userFilesService=o,s.authService=r,s.sqlDbService=c,s.notificationService=a,s.connections=[],s.executed=!1,s.loading=!1,s.gridUIModel={type:"grid",itemProperties:{headersVisibility:At.HeadersVisibility.All,binding:"$.data",footer:!1,isReadOnly:!0,selectionMode:At.SelectionMode.MultiRange}},s.dataModel={data:[]},s}return Object(h.d)(t,e),Object.defineProperty(t.prototype,"selectConnection",{get:function(){return this.connections.map((function(e){return e.connectionName})).includes(this.connection)?this.connection:"Select connection"},enumerable:!1,configurable:!0}),t.prototype.handleKeyboardEvent=function(e){("F5"===e.key||e.ctrlKey&&"Enter"===e.key)&&(e.preventDefault(),e.stopImmediatePropagation(),this.onRun())},t.prototype.ngOnInit=function(){return Object(h.b)(this,void 0,void 0,(function(){var t,n=this;return Object(h.e)(this,(function(i){switch(i.label){case 0:return e.prototype.ngOnInit.call(this),this.initSqlEditor(),this.store.select(Se).subscribe((function(e){n.connections=e,!n.connection&&e.length&&n.onSelectConnection(e[0].connectionName)})),[4,this.content$.pipe(Object(vt.a)()).toPromise()];case 1:return t=i.sent(),this.connection=this.getConnection(t),t&&this.sqlEditor.setValue(t,-1),[2]}}))}))},t.prototype.initSqlEditor=function(){var e=this;this.sqlEditor=Object(Ue.edit)(this.sqlElement.nativeElement,{mode:"ace/mode/sql",autoScrollEditorIntoView:!0,theme:Object(d.f)(),readOnly:this.isReadOnly}),Object(_e.a)(this.sqlEditor,"change").pipe(Object(Fe.a)(500)).subscribe((function(){return e.onChange(e.sqlEditor.getValue())}))},t.prototype.onRun=function(){var e=this;this.connections.map((function(e){return e.connectionName})).includes(this.connection)?(this.loading=!0,this.sqlDbService.executeQuery(this.connection,{sql:this.sqlEditor.getSelectedText()||this.sqlEditor.getValue()}).pipe(Object(re.a)((function(t){return e.error="string"==typeof t.error?t.error:"Failed to query data.",Object(Y.a)(null)}))).subscribe((function(t){t?(e.error=null,e.fields=t.fields.map((function(e){return{bindingName:e.fieldName,dataType:Ne.SqlTypesToWijmoMap[e.dataType],headerText:e.fieldName}})),e.data=Object(Bt.fromTable)(t.table)):(e.fields=null,e.data=null),e.gridUIModel.itemProperties.columns=e.fields,e.dataModel.data=e.data,e.executed=!0,e.loading=!1,setTimeout((function(){var t;e.grid=null===(t=e.dcGrid)||void 0===t?void 0:t.grid}))}))):this.notificationService.error(null,"Connection "+this.connection+" is not available. Choose one of "+this.connections.map((function(e){return e.connectionName})).join(", "))},t.prototype.onChange=function(t){var n=this.getConnection(t);n!==this.connection&&(this.connection=n),e.prototype.onChange.call(this,t)},t.prototype.onSelectConnection=function(e){this.connection=e;var t=this.sqlEditor.getValue(),n=this.getConnection(t),i=this.getConnectionLine(e),o=n?t.replace(/.*\n/,i):""+i+t;this.sqlEditor.setValue(o,o.length)},t.prototype.getConnectionLine=function(e){return"-- Connection: "+e+"\n"},t.prototype.getConnection=function(e){if(!e)return null;var t=e.split("\n")[0].match(/--\sConnection:\s(.*)/);return t&&t[1]},t.\u0275fac=function(e){return new(e||t)(Te.Nb(r.h),Te.Nb(ue.a),Te.Nb(c.a),Te.Nb(Ce.a),Te.Nb(Ae.b),Te.Nb(le.f),Te.Nb(le.e))},t.\u0275cmp=Te.Hb({type:t,selectors:[["app-tab-sql"]],viewQuery:function(e,t){var n;1&e&&(Te.Ac(Rt,!0),Te.Jc($t,!0)),2&e&&(Te.rc(n=Te.cc())&&(t.sqlElement=n.first),Te.rc(n=Te.cc())&&(t.dcGrid=n.first))},hostBindings:function(e,t){1&e&&Te.bc("keydown",(function(e){return t.handleKeyboardEvent(e)}),!1,Te.tc)},features:[Te.yb],decls:25,vars:7,consts:[[1,"row","mx-0","mb-2"],[1,"mb-0","align-self-center"],["dropdown","",1,"ml-auto","btn-group"],["id","button-basic","dropdownToggle","","type","button","disabled","disabled","aria-controls","dropdown-basic",1,"btn","btn-primary","btn-sm","dropdown-toggle"],[1,"caret"],["id","dropdown-basic","class","dropdown-menu","role","menu","aria-labelledby","button-basic",4,"dropdownMenu"],["class","mx-1 align-self-center",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-sm","mx-1",3,"click"],[3,"grid","disabled"],[1,"h-100","overflow-hidden"],["left","",1,"w-100"],["sqlElement",""],["right",""],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner",4,"ngIf"],["type","danger",4,"ngIf"],[3,"uiModel","dataModel",4,"ngIf"],["left-label",""],[1,"fa","fa-cogs","fa-lg"],["right-label",""],[1,"fa","fa-table","fa-lg"],["id","dropdown-basic","role","menu","aria-labelledby","button-basic",1,"dropdown-menu"],["role","menuitem",4,"ngFor","ngForOf"],["role","menuitem"],[1,"dropdown-item",3,"click"],[1,"mx-1","align-self-center"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner"],["role","status",1,"spinner-border"],[1,"sr-only"],["type","danger"],[3,"uiModel","dataModel"],["dcGrid",""]],template:function(e,t){1&e&&(Te.Tb(0,"div",0),Te.Tb(1,"h5",1),Te.Ec(2,"Sql Query"),Te.Sb(),Te.Tb(3,"div",2),Te.Tb(4,"button",3),Te.Ec(5),Te.Ob(6,"span",4),Te.Sb(),Te.Cc(7,_t,2,1,"ul",5),Te.Sb(),Te.Cc(8,Lt,2,1,"span",6),Te.Tb(9,"button",7),Te.bc("click",(function(){return t.onRun()})),Te.Ec(10,"Run"),Te.Sb(),Te.Ob(11,"app-export-menu",8),Te.Sb(),Te.Tb(12,"app-split-content",9),Te.Ob(13,"div",10,11),Te.Rb(15,12),Te.Cc(16,Ut,4,0,"div",13),Te.Cc(17,Qt,4,1,"alert",14),Te.Cc(18,Ht,2,2,"dc-grid",15),Te.Qb(),Te.Rb(19,16),Te.Ob(20,"i",17),Te.Ec(21," SQL "),Te.Qb(),Te.Rb(22,18),Te.Ob(23,"i",19),Te.Ec(24," Data "),Te.Qb(),Te.Sb()),2&e&&(Te.Bb(5),Te.Fc(t.selectConnection),Te.Bb(3),Te.jc("ngIf",null==t.data?null:t.data.length),Te.Bb(3),Te.jc("grid",t.grid)("disabled",!t.grid||!(null!=t.data&&t.data.length)),Te.Bb(5),Te.jc("ngIf",t.loading),Te.Bb(1),Te.jc("ngIf",t.error),Te.Bb(1),Te.jc("ngIf",t.executed&&!t.error))},directives:[Ge.a,Ge.d,Ge.b,o.m,Ft.a,Ot.a,o.l,Ze.a,Dt.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}"]}),t}(ft),Jt=n("uh6x"),Xt=n("UfhM"),Gt=n("BgSd"),Kt=n("cSY5"),Wt=n("M2rw"),Zt=n("jyck"),Yt=["bodyEditor"],en=["header"],tn=["requestTabs"],nn=["script"];function on(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"li",55),Te.Tb(1,"a",56),Te.bc("click",(function(){Te.vc(n);var e=t.$implicit;return Te.dc(3).selectMethod(e)})),Te.Ec(2),Te.Sb(),Te.Sb()}if(2&e){var i=t.$implicit;Te.Bb(2),Te.Fc(i)}}function rn(e,t){if(1&e&&(Te.Tb(0,"ul",53),Te.Cc(1,on,3,1,"li",54),Te.Sb()),2&e){var n=Te.dc(2);Te.Bb(1),Te.jc("ngForOf",n.methods)}}function cn(e,t){}var an=function(e,t){return{"fa-chevron-right":e,"fa-chevron-down":t}};function sn(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"div",32,33),Te.Tb(2,"div",34),Te.Tb(3,"a",35),Te.bc("click",(function(){return Te.vc(n),Te.dc().toggleCard()})),Te.Ob(4,"i",36),Te.Sb(),Te.Tb(5,"div",37),Te.Tb(6,"div",38),Te.Tb(7,"button",39),Te.Ec(8),Te.Ob(9,"span",40),Te.Sb(),Te.Cc(10,rn,2,1,"ul",41),Te.Sb(),Te.Sb(),Te.Tb(11,"div",42),Te.Tb(12,"input",43),Te.bc("ngModelChange",(function(e){return Te.vc(n),Te.dc().requestModel.url=e}))("input",(function(){return Te.vc(n),Te.dc().onUrlInput()})),Te.Sb(),Te.Sb(),Te.Tb(13,"div",44),Te.Tb(14,"div",45),Te.Tb(15,"button",46),Te.bc("click",(function(){return Te.vc(n),Te.dc().sendRequest()})),Te.Ob(16,"i",47),Te.Ec(17,"\xa0Send"),Te.Sb(),Te.Tb(18,"button",48),Te.Ob(19,"i",49),Te.Sb(),Te.Tb(20,"a",50),Te.bc("click",(function(){return Te.vc(n),Te.dc().toggleDirection()})),Te.Ob(21,"i",51),Te.Sb(),Te.Cc(22,cn,0,0,"ng-template",52),Te.Sb(),Te.Sb(),Te.Sb(),Te.Sb()}if(2&e){var i=Te.dc(),o=Te.sc(41);Te.Bb(4),Te.jc("ngClass",Te.oc(5,an,i.isCollapsed,!i.isCollapsed)),Te.Bb(4),Te.Gc(" ",i.requestModel.method," "),Te.Bb(4),Te.jc("ngModel",i.requestModel.url),Te.Bb(9),Te.jc("ngClass","vertical"===i.direction?"fa-arrows-h":"fa-arrows-v"),Te.Bb(1),Te.jc("ngTemplateOutlet",o)}}function ln(e,t){if(1&e&&(Te.Tb(0,"alert",57),Te.Tb(1,"strong"),Te.Ec(2,"Error:"),Te.Sb(),Te.Ec(3),Te.Sb()),2&e){var n=Te.dc();Te.Bb(3),Te.Gc(" ",n.error," ")}}var un=function(e){return{active:e}};function dn(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"button",61),Te.bc("click",(function(){return Te.vc(n),Te.dc(2),Te.sc(13).validateJSON()})),Te.Ec(1," Validate "),Te.Sb()}if(2&e){var i=Te.dc(2);Te.jc("ngClass",Te.nc(1,un,i.formatted))}}function pn(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"button",62),Te.bc("click",(function(){return Te.vc(n),Te.dc(2).formatJSON()})),Te.Ob(1,"i",63),Te.Sb(),Te.Tb(2,"button",64),Te.bc("click",(function(){return Te.vc(n),Te.dc(2).formatJSON(!1)})),Te.Ob(3,"i",65),Te.Sb()}if(2&e){var i=Te.dc(2);Te.jc("ngClass",Te.nc(2,un,i.formatted)),Te.Bb(2),Te.jc("ngClass",Te.nc(4,un,!i.formatted))}}function bn(e,t){if(1&e&&(Te.Tb(0,"div",58),Te.Cc(1,dn,2,3,"button",59),Te.ec(2,"async"),Te.Cc(3,pn,4,6,"ng-template",null,60,Te.Dc),Te.Sb()),2&e){var n=Te.sc(4);Te.dc();var i=Te.sc(13);Te.Bb(1),Te.jc("ngIf",!Te.fc(2,2,i.isJSON$))("ngIfElse",n)}}function fn(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"li",55),Te.Tb(1,"a",70),Te.bc("click",(function(){Te.vc(n);var e=t.$implicit;return Te.dc(3).onAuthTypeChange(e)})),Te.Ec(2),Te.Sb(),Te.Sb()}if(2&e){var i=t.$implicit;Te.Bb(2),Te.Fc(i)}}function hn(e,t){if(1&e&&(Te.Tb(0,"ul",69),Te.Cc(1,fn,3,1,"li",54),Te.Sb()),2&e){var n=Te.dc(2);Te.Bb(1),Te.jc("ngForOf",n.authTypes)}}function vn(e,t){if(1&e&&(Te.Tb(0,"div",66),Te.Ec(1," Authentication "),Te.Tb(2,"button",67),Te.Ec(3),Te.Ob(4,"span",40),Te.Sb(),Te.Cc(5,hn,2,1,"ul",68),Te.Sb()),2&e){var n=Te.dc();Te.Bb(3),Te.Gc(" ",n.requestModel.auth.type," ")}}function gn(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"div",71),Te.Tb(1,"div",72),Te.Tb(2,"label",73),Te.Ec(3,"Username"),Te.Sb(),Te.Tb(4,"div",74),Te.Tb(5,"input",75),Te.bc("ngModelChange",(function(e){return Te.vc(n),Te.dc().requestModel.auth.username=e}))("input",(function(e){return Te.vc(n),Te.dc().updateAuthData(e,"username")})),Te.Sb(),Te.Sb(),Te.Sb(),Te.Tb(6,"div",76),Te.Tb(7,"label",77),Te.Ec(8,"Password"),Te.Sb(),Te.Tb(9,"div",74),Te.Tb(10,"input",78),Te.bc("ngModelChange",(function(e){return Te.vc(n),Te.dc().requestModel.auth.password=e}))("input",(function(e){return Te.vc(n),Te.dc().updateAuthData(e,"password")})),Te.Sb(),Te.Sb(),Te.Sb(),Te.Sb()}if(2&e){var i=Te.dc();Te.Bb(5),Te.jc("ngModel",i.requestModel.auth.username),Te.Bb(5),Te.jc("ngModel",i.requestModel.auth.password)}}function mn(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"div",76),Te.Tb(1,"label",79),Te.Ec(2,"Bearer Token"),Te.Sb(),Te.Tb(3,"div",74),Te.Tb(4,"input",80),Te.bc("ngModelChange",(function(e){return Te.vc(n),Te.dc().requestModel.auth.token=e}))("input",(function(e){return Te.vc(n),Te.dc().updateAuthData(e)})),Te.Sb(),Te.Sb(),Te.Sb()}if(2&e){var i=Te.dc();Te.Bb(4),Te.jc("ngModel",i.requestModel.auth.token)}}function jn(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"div",81),Te.Tb(1,"div"),Te.Tb(2,"input",82),Te.bc("ngModelChange",(function(e){return Te.vc(n),t.$implicit.active=e}))("change",(function(){Te.vc(n);var e=Te.dc();return e.syncQueryParams(),e.updateModel()})),Te.Sb(),Te.Sb(),Te.Tb(3,"div",83),Te.Tb(4,"input",84),Te.bc("ngModelChange",(function(e){return Te.vc(n),t.$implicit.name=e}))("change",(function(){return Te.vc(n),Te.dc().updateModel()}))("input",(function(){return Te.vc(n),Te.dc().syncQueryParams()})),Te.Sb(),Te.Sb(),Te.Tb(5,"div",85),Te.Tb(6,"input",86),Te.bc("ngModelChange",(function(e){return Te.vc(n),t.$implicit.value=e}))("change",(function(){return Te.vc(n),Te.dc().updateModel()}))("input",(function(){return Te.vc(n),Te.dc().syncQueryParams()})),Te.Sb(),Te.Sb(),Te.Tb(7,"button",87),Te.bc("click",(function(){Te.vc(n);var e=t.index;return Te.dc().deleteQueryParam(e)})),Te.Ob(8,"i",88),Te.Sb(),Te.Sb()}if(2&e){var i=t.$implicit,o=t.index;Te.Bb(2),Te.lc("name","active-param-",o,""),Te.jc("ngModel",i.active),Te.Bb(2),Te.lc("name","name-param-",o,""),Te.jc("ngModel",i.name),Te.Bb(2),Te.lc("name","value-param-",o,""),Te.jc("ngModel",i.value)}}function yn(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"div",81),Te.Tb(1,"div"),Te.Tb(2,"input",82),Te.bc("ngModelChange",(function(e){return Te.vc(n),t.$implicit.active=e}))("change",(function(){return Te.vc(n),Te.dc().updateModel()})),Te.Sb(),Te.Sb(),Te.Tb(3,"div",85),Te.Tb(4,"input",89),Te.bc("ngModelChange",(function(e){return Te.vc(n),t.$implicit.name=e}))("change",(function(){return Te.vc(n),Te.dc().updateModel()})),Te.Sb(),Te.Sb(),Te.Tb(5,"div",85),Te.Tb(6,"input",90),Te.bc("ngModelChange",(function(e){return Te.vc(n),t.$implicit.value=e}))("change",(function(){return Te.vc(n),Te.dc().updateModel()})),Te.Sb(),Te.Sb(),Te.Tb(7,"button",87),Te.bc("click",(function(){Te.vc(n);var e=t.index;return Te.dc().deleteHeader(e)})),Te.Ob(8,"i",88),Te.Sb(),Te.Sb()}if(2&e){var i=t.$implicit,o=t.index;Te.Bb(2),Te.lc("name","active-header-",o,""),Te.jc("ngModel",i.active),Te.Bb(2),Te.lc("name","name-header-",o,""),Te.jc("ngModel",i.name),Te.Bb(2),Te.lc("name","value-header-",o,""),Te.jc("ngModel",i.value)}}function On(e,t){}function Sn(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"div",91),Te.Tb(1,"a",92),Te.bc("click",(function(){return Te.vc(n),Te.dc().toggleCard()})),Te.Ob(2,"i",36),Te.Sb(),Te.Tb(3,"button",93),Te.bc("click",(function(){return Te.vc(n),Te.dc().sendRequest()})),Te.Ob(4,"i",47),Te.Sb(),Te.Tb(5,"a",94),Te.bc("click",(function(){return Te.vc(n),Te.dc().toggleDirection()})),Te.Ob(6,"i",51),Te.Sb(),Te.Cc(7,On,0,0,"ng-template",95),Te.Sb()}if(2&e){var i=Te.dc(),o=Te.sc(41);Te.Bb(2),Te.jc("ngClass",Te.oc(3,an,i.isCollapsed,!i.isCollapsed)),Te.Bb(4),Te.jc("ngClass","vertical"===i.direction?"fa-arrows-h":"fa-arrows-v"),Te.Bb(1),Te.jc("ngTemplateOutlet",o)}}function wn(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"ul",100),Te.Tb(1,"li",55),Te.Tb(2,"div",101),Te.Tb(3,"input",102),Te.bc("click",(function(e){return Te.vc(n),e.stopPropagation()}))("change",(function(e){return Te.vc(n),Te.dc(2).onRunOnloadToggle(e.target.checked)})),Te.Sb(),Te.Tb(4,"label",103),Te.bc("click",(function(e){return Te.vc(n),e.stopPropagation()})),Te.Ec(5,"Run onload"),Te.Sb(),Te.Sb(),Te.Sb(),Te.Tb(6,"li",55),Te.Tb(7,"a",56),Te.bc("click",(function(){return Te.vc(n),Te.dc(2).onFileImport()})),Te.Ec(8,"Import file"),Te.Sb(),Te.Sb(),Te.Tb(9,"li",55),Te.Tb(10,"a",56),Te.bc("click",(function(){return Te.vc(n),Te.dc(2).onCurlImport()})),Te.Ec(11,"Import cUrl"),Te.Sb(),Te.Sb(),Te.Tb(12,"li",55),Te.Tb(13,"a",56),Te.bc("click",(function(){return Te.vc(n),Te.dc(2).onCurlExport()})),Te.Ec(14,"Export cUrl"),Te.Sb(),Te.Sb(),Te.Tb(15,"li",55),Te.Tb(16,"a",56),Te.bc("click",(function(){return Te.vc(n),Te.dc(2).onFileExport()})),Te.Ec(17,"Export file"),Te.Sb(),Te.Sb(),Te.Sb()}if(2&e){var i=Te.dc(2);Te.Bb(3),Te.jc("checked",i.uiSettings.runOnload)}}function Cn(e,t){1&e&&(Te.Tb(0,"span",96),Te.Tb(1,"button",97),Te.Ob(2,"i",98),Te.Sb(),Te.Cc(3,wn,18,1,"ul",99),Te.Sb())}var Tn=function(e){return{"min-height":e}},xn=function(){function e(e,t,n,i){this.authService=e,this.fileManager=t,this.dialogService=n,this.requestsService=i,this.scriptResult=new Te.p,this.receiveResponse=new Te.p,this.changed=new Te.p,this.minCardBodyHeight=90,this.newRequestLink={ownerName:null,name:null,folder:null,description:null,linkType:Jt.d.RestRequest,isPublic:!1},this.explorerUIModel={type:"grid-object-explorer",containerProperties:{},itemProperties:{dataSource:null,isReadOnly:!1,allowDelete:!0,allowAddNew:!0,host:"request-body-object-explorer",selectionMode:4}},this.isCollapsed=!0,this.direction="vertical",this.saveRequestLink=Object(h.a)({},this.newRequestLink),this.isAuthenticated=!1,this.formatted=!1,this.authTypes=Object.values(Jt.a),this.AuthTypes=Jt.a,this.userName=null,this.defaultScript=["def preRequest(request):","  request.cancelRequest = False\n","def successResponse(response):",'  showInObjectExplorer(response.body, "Content")','  showInJSON(response.headers, "Header")\n',"def errorResponse(response):",'  showInObjectExplorer(response.body, "Error")','  showInJSON(response.headers, "Header")'].join("\n"),this.methods=["GET","POST","PUT","DELETE","OPTIONS"],this.destroy$=new $e.a}return e.prototype.ngOnInit=function(){var e=this;this.setData(),this.uiSettings.runOnload&&window.requestAnimationFrame((function(){e.sendRequest()}))},e.prototype.ngOnChanges=function(e){var t=e.restModel;t&&!t.firstChange&&this.setData()},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.setData=function(e){var t,n;void 0===e&&(e=this.restModel),this.uiSettings=e.uiSettings,this.direction=(null===(t=this.uiSettings)||void 0===t?void 0:t.direction)||"vertical",this.requestModel=e.request,this.bodyData=this.requestModel.body,this.bodyEditor&&this.bodyEditor.setReadOnly("GET"===this.requestModel.method),this.syncUrl(),this.isCollapsed=Boolean(null===(n=this.uiSettings)||void 0===n?void 0:n.isRequestPanelCollapsed),this.exportData=e,this.script.setScript(e.scripts||this.defaultScript)},Object.defineProperty(e.prototype,"isFormatActionActive",{get:function(){return this.requestTabs.tabs[0].active&&"GET"!==this.requestModel.method},enumerable:!1,configurable:!0}),e.prototype.onUrlInput=function(){this.syncUrl(),this.updateModel()},e.prototype.formatJSON=function(e){void 0===e&&(e=!0);try{this.requestTabs.tabs[0].active&&this.bodyEditor.formatJSON(e),this.formatted=e,this.error=null}catch(t){console.error(t),this.error=t,this.formatted=!1}},e.prototype.updateModel=function(){this.error=null;var e=this.script.getScript();this.changed.emit({request:this.requestModel,uiSettings:this.uiSettings,scripts:e})},e.prototype.onRunOnloadToggle=function(e){this.uiSettings.runOnload=e,this.updateModel()},e.prototype.updateAuthData=function(e,t){var n=e.target.value;switch(this.requestModel.auth.type){case Jt.a.Basic:this.requestModel.auth[t]=n;break;case Jt.a.Bearer:this.requestModel.auth.token=n}this.updateModel()},e.prototype.selectMethod=function(e){this.requestModel.method=e,this.updateModel(),this.bodyEditor.setReadOnly("GET"===e),this.bodyData="GET"===e?void 0:{}},e.prototype.sendRequest=function(){return Object(h.b)(this,void 0,void 0,(function(){var e,t,n;return Object(h.e)(this,(function(i){switch(i.label){case 0:return"GET"!==this.requestModel.method&&this.bodyEditor.dataModel&&(this.requestModel.body="string"==typeof(e=this.bodyEditor.dataModel)?e:JSON.stringify(e)),this.receiveResponse.emit({response:null,status:null,loading:!0}),t=this.script.getScript(),this.script.restInterpreter&&this.script.restInterpreter.reset(),[4,this.requestsService.sendRequest(this.requestModel,t,this.script.restInterpreter)];case 1:return n=i.sent(),this.scriptResult.emit(this.script.context),this.receiveResponse.emit({response:n.response,status:n.status,loading:!1}),[2]}}))}))},e.prototype.toggleCard=function(){this.isCollapsed=!this.isCollapsed,this.uiSettings.isRequestPanelCollapsed=this.isCollapsed,this.updateModel()},e.prototype.addQueryParam=function(){this.requestModel.queryParameters.push({name:"",value:"",active:!0}),this.syncQueryParams(),this.updateModel()},e.prototype.deleteQueryParam=function(e){this.requestModel.queryParameters.splice(e,1),this.syncQueryParams(),this.updateModel()},e.prototype.addHeader=function(){this.requestModel.headers.push({name:"",value:"",active:!0}),this.updateModel()},e.prototype.deleteHeader=function(e){this.requestModel.headers.splice(e,1),this.updateModel()},e.prototype.onBodyTabSelect=function(){var e=this;window.requestAnimationFrame((function(){e.bodyEditor.setReadOnly("GET"===e.requestModel.method),e.bodyEditor.resize()}))},e.prototype.onAuthTypeChange=function(e){this.requestModel.auth.type=e,this.updateModel()},e.prototype.onFileExport=function(){var e=Object(d.g)(this.exportData.request.url);this.fileManager.exportToFile({requestContentModel:this.exportData},{fileName:"rc-"+e})},e.prototype.onFileImport=function(){var e=this;this.fileManager.importFromFile$().subscribe((function(t){var n=t.result.requestContentModel;e.changed.emit(n),e.setData(n)}),(function(t){e.error=t.message,e.uiSettings.isRequestPanelCollapsed=!1}))},e.prototype.onCurlImport=function(){var e=this,t=this.dialogService.open(Gt.a);t.init.pipe(Object(ie.a)((function(){return t.component.import}))).subscribe((function(t){e.setData(t)}))},e.prototype.onCurlExport=function(){var e=this,t=this.dialogService.open(Gt.a);t.init.pipe().subscribe((function(){t.component.isExport=!0,t.component.exportData=e.exportData.request}))},e.prototype.resize=function(){this.bodyEditor.resize(),this.script.resize()},e.prototype.toggleDirection=function(){this.direction="vertical"===this.direction?"horizontal":"vertical",this.uiSettings.direction=this.direction,this.updateModel()},e.prototype.syncQueryParams=function(){var e=this.requestModel.url.split("?")[0],t=this.requestModel.queryParameters.filter((function(e){return e.active&&e.name})).map((function(e){return e.name+"="+encodeURIComponent(e.value)})).join("&");this.requestModel.url=e+(t?"?"+t:"")},e.prototype.syncUrl=function(){var e=this;if(this.requestModel.url){var t=this.requestModel.url.split("?")[1];this.requestModel.queryParameters=[],t&&t.split("&").forEach((function(t){var n=t.split("="),i=n[1];e.requestModel.queryParameters.push({active:!0,name:n[0],value:i?decodeURIComponent(i):null})}))}},e.\u0275fac=function(t){return new(t||e)(Te.Nb(Xt.a),Te.Nb(le.c),Te.Nb(le.b),Te.Nb(Kt.a))},e.\u0275cmp=Te.Hb({type:e,selectors:[["app-request-card"]],viewQuery:function(e,t){var n;1&e&&(Te.Ac(Yt,!0),Te.Jc(en,!0),Te.Ac(tn,!0),Te.Ac(nn,!0)),2&e&&(Te.rc(n=Te.cc())&&(t.bodyEditor=n.first),Te.rc(n=Te.cc())&&(t.header=n.first),Te.rc(n=Te.cc())&&(t.requestTabs=n.first),Te.rc(n=Te.cc())&&(t.script=n.first))},inputs:{restModel:"restModel"},outputs:{scriptResult:"scriptResult",receiveResponse:"receiveResponse",changed:"changed"},features:[Te.Ab([le.c]),Te.zb],decls:42,vars:18,consts:[[1,"card","overflow-hidden","mb-0","w-100"],["class","card-header d-flex pl-0 pb-0 pt-2 pr-2",4,"ngIf","ngIfElse"],[1,"card-body","p-0","flex-column",3,"ngStyle","ngClass"],["type","danger",4,"ngIf"],[1,"row","flex-fill","flex-column","p-2","h-100"],["form",""],[1,"col-12","d-flex","flex-column","h-100"],[1,"row","flex-fill","position-relative","h-100"],["class","tabs-actions position-absolute mr-3",4,"ngIf"],[1,"col-12","nav-tabs-boxed","tabset-fx","nav-tabs-boxed"],["requestTabs",""],["heading","Body",1,"h-100",3,"selectTab"],[1,"h-100",3,"isTextAvailable","data","uiModel","formatter"],["bodyEditor",""],["tabHeading",""],[3,"ngSwitch"],["class","row flex-column m-0 h-100",4,"ngSwitchCase"],["class","row m-0",4,"ngSwitchCase"],["heading","Query Params"],[1,"row","flex-fill","overflow-auto"],[1,"col-12"],["class","row my-1 mx-0 flex-nowrap",4,"ngFor","ngForOf"],[1,"row","mx-0"],["type","button",1,"btn","btn-sm","btn-light",3,"click"],[1,"fa","fa-plus","fa-xl"],["heading","Headers"],[1,"fa","fa-plus"],["heading","Script"],[1,"w-100","h-100",3,"defaultScript"],["script",""],["bar",""],["settingMenu",""],[1,"card-header","d-flex","pl-0","pb-0","pt-2","pr-2"],["header",""],[1,"row","w-100","ml-0","align-items-center"],[1,"p-2","mb-2",3,"click"],[1,"fa","text-center",3,"ngClass"],[1,"form-group","method-group","mb-2"],["dropdown","","container","body"],["dropdownToggle","","type","button",1,"btn","btn-light","dropdown-toggle","w-100","border"],[1,"caret"],["class","dropdown-menu","role","menu",4,"dropdownMenu"],[1,"form-group","flex-fill","p-0","pl-2","mb-2"],["type","text","id","url","placeholder","Enter request URL","name","url",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"form-group","mb-0","pl-2","actions-group","mb-2"],[1,"d-flex","flex-fill"],["title","Send request",1,"btn","flex-fill","btn-primary","mr-2",3,"click"],[1,"fa","fa-send"],[1,"btn","flex-fill","btn-primary","disabled","mr-2"],[1,"fa","fa-share-alt"],["title","Switch to horizontal/vertical layout",1,"cursor-pointer","btn","btn-secondary","mr-2",3,"click"],[1,"fa",3,"ngClass"],[3,"ngTemplateOutlet"],["role","menu",1,"dropdown-menu"],["role","menuitem",4,"ngFor","ngForOf"],["role","menuitem"],[1,"dropdown-item",3,"click"],["type","danger"],[1,"tabs-actions","position-absolute","mr-3"],["type","button","class","btn btn-light btn-sm px-1 py-0","title","Validate JSON",3,"ngClass","click",4,"ngIf","ngIfElse"],["formatBtns",""],["type","button","title","Validate JSON",1,"btn","btn-light","btn-sm","px-1","py-0",3,"ngClass","click"],["type","button","title","Format JSON data, with proper indentation and line feeds (Ctrl+\\)",1,"btn","btn-light","btn-sm","px-1","py-0",3,"ngClass","click"],[1,"fa","fa-indent"],["type","button","title","Compact JSON data, remove all whitespaces (Ctrl+Shift+\\)",1,"btn","btn-light","btn-sm","ml-1","px-1","py-0",3,"ngClass","click"],[1,"fa","fa-align-justify"],["dropdown","","placement","bottom right",1,"btn-group","align-self-center","tab-button"],["id","auth-types-btn-group","dropdownToggle","","type","button","title","Select Authentication type","aria-controls","dropdown-menu-auth-types","tabindex","0","role","button",1,"btn","btn-primary","dropdown-toggle","btn-sm","m-0","py-0","px-1","ml-1"],["id","dropdown-menu-auth-types","class","dropdown-menu dropdown-menu-right","role","menu","aria-labelledby","auth-types-btn-group",4,"dropdownMenu"],["id","dropdown-menu-auth-types","role","menu","aria-labelledby","auth-types-btn-group",1,"dropdown-menu","dropdown-menu-right"],[1,"dropdown-item","cursor-pointer",3,"click"],[1,"row","flex-column","m-0","h-100"],[1,"row","m-0","mb-2"],["for","username",1,"col-form-label","pr-2"],[1,"flex-fill"],["id","bearer-token","name","username","type","text","placeholder","Username ...",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"row","m-0"],["for","password",1,"col-form-label","pr-2"],["id","password","name","password","type","password","placeholder","Password ...",1,"form-control",3,"ngModel","ngModelChange","input"],["for","bearer-selection",1,"col-form-label","pr-2"],["id","bearer-token","name","bearer-token","type","text","placeholder","Bearer ...",1,"form-control",3,"ngModel","ngModelChange","input"],[1,"row","my-1","mx-0","flex-nowrap"],["type","checkbox",1,"mx-2","mt-0","h-100",3,"name","ngModel","ngModelChange","change"],[1,"col-4","col-sm-4","px-2"],["type","text","placeholder","name",1,"form-control",3,"ngModel","name","ngModelChange","change","input"],[1,"flex-fill","px-2"],["type","text","placeholder","value",1,"form-control",3,"name","ngModel","ngModelChange","change","input"],["type","button",1,"btn","btn-light",3,"click"],[1,"fa","fa-remove","fa-lg"],["type","text","placeholder","name",1,"form-control",3,"name","ngModel","ngModelChange","change"],["type","text","placeholder","value",1,"form-control",3,"name","ngModel","ngModelChange","change"],[1,"card-header","h-100","p-2","d-flex","flex-column","align-items-baseline","bar"],[1,"cursor-pointer","p-2","d-block","text-center",2,"width","37px",3,"click"],["title","Send request",1,"btn","btn-primary","px-0",3,"click"],["title","Switch to horizontal/vertical layout",1,"cursor-pointer","text-center","my-2","d-block","btn","btn-secondary",3,"click"],["class","mt-2",3,"ngTemplateOutlet"],["dropdown","","placement","bottom left","container","body",1,"position-relative"],["dropdownToggle","","type","button","title","Settings",1,"btn"],[1,"fa","fa-ellipsis-v"],["class","dropdown-menu left-bottom-menu","role","menu",4,"dropdownMenu"],["role","menu",1,"dropdown-menu","left-bottom-menu"],[1,"form-check","form-check-inline","w-100","dropdown-item","d-flex","pl-3"],["type","checkbox","id","run-onload",1,"form-check-input","mr-2",3,"checked","click","change"],["for","run-onload",1,"form-check-label",3,"click"]],template:function(e,t){if(1&e&&(Te.Tb(0,"div",0),Te.Cc(1,sn,23,8,"div",1),Te.Tb(2,"div",2),Te.Cc(3,ln,4,1,"alert",3),Te.Tb(4,"form",4,5),Te.Tb(6,"div",6),Te.Tb(7,"div",7),Te.Cc(8,bn,5,4,"div",8),Te.Tb(9,"tabset",9,10),Te.Tb(11,"tab",11),Te.bc("selectTab",(function(){return t.onBodyTabSelect()})),Te.Ob(12,"app-content-explorer",12,13),Te.Sb(),Te.Tb(14,"tab"),Te.Cc(15,vn,6,1,"ng-template",14),Te.Rb(16,15),Te.Cc(17,gn,11,2,"div",16),Te.Cc(18,mn,5,1,"div",17),Te.Qb(),Te.Sb(),Te.Tb(19,"tab",18),Te.Tb(20,"div",19),Te.Tb(21,"div",20),Te.Cc(22,jn,9,6,"div",21),Te.Sb(),Te.Sb(),Te.Tb(23,"div",22),Te.Tb(24,"button",23),Te.bc("click",(function(){return t.addQueryParam()})),Te.Ob(25,"i",24),Te.Ec(26,"\xa0Add query parameter"),Te.Sb(),Te.Sb(),Te.Sb(),Te.Tb(27,"tab",25),Te.Tb(28,"div",19),Te.Tb(29,"div",20),Te.Cc(30,yn,9,6,"div",21),Te.Sb(),Te.Sb(),Te.Tb(31,"div",22),Te.Tb(32,"button",23),Te.bc("click",(function(){return t.addHeader()})),Te.Ob(33,"i",26),Te.Ec(34,"\xa0Add header"),Te.Sb(),Te.Sb(),Te.Sb(),Te.Tb(35,"tab",27),Te.Ob(36,"app-script",28,29),Te.Sb(),Te.Sb(),Te.Sb(),Te.Sb(),Te.Sb(),Te.Sb(),Te.Sb(),Te.Cc(38,Sn,8,6,"ng-template",null,30,Te.Dc),Te.Cc(40,Cn,4,0,"ng-template",null,31,Te.Dc)),2&e){var n=Te.sc(39);Te.Bb(1),Te.jc("ngIf",!("horizontal"===t.direction&&t.isCollapsed))("ngIfElse",n),Te.Bb(1),Te.jc("ngStyle",Te.nc(16,Tn,t.minCardBodyHeight+"px"))("ngClass","horizontal"===t.direction&&t.isCollapsed?"d-none":"d-flex"),Te.Bb(1),Te.jc("ngIf",t.error),Te.Bb(5),Te.jc("ngIf",t.isFormatActionActive),Te.Bb(4),Te.jc("isTextAvailable",!0)("data",t.bodyData)("uiModel",t.explorerUIModel)("formatter",!1),Te.Bb(4),Te.jc("ngSwitch",t.requestModel.auth.type),Te.Bb(1),Te.jc("ngSwitchCase",t.AuthTypes.Basic),Te.Bb(1),Te.jc("ngSwitchCase",t.AuthTypes.Bearer),Te.Bb(4),Te.jc("ngForOf",t.requestModel.queryParameters),Te.Bb(8),Te.jc("ngForOf",t.requestModel.headers),Te.Bb(6),Te.jc("defaultScript",t.defaultScript)}},directives:[o.m,o.n,o.k,i.t,i.j,i.k,Re.d,Re.a,Zt.a,Re.b,o.o,o.p,o.l,Wt.a,Ge.a,Ge.d,Ge.b,i.b,i.i,i.l,o.r,Ze.a,i.a],pipes:[o.b],styles:[".card-header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.card-header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .fa-chevron-right[_ngcontent-%COMP%]{width:14px}.tab-button[_ngcontent-%COMP%]{height:19px}.dropdown-item[_ngcontent-%COMP%]{cursor:pointer}.dropdown-menu[_ngcontent-%COMP%]{min-width:auto}.method-group[_ngcontent-%COMP%]{flex:0 0 110px}@media (max-width:575.98px){.form-group[_ngcontent-%COMP%]{align-items:baseline;display:flex;justify-content:center}.method-group[_ngcontent-%COMP%]{flex:0 0 80px}.actions-group[_ngcontent-%COMP%]{margin-top:.5rem;width:100%}}.body-editor[_ngcontent-%COMP%]{min-height:28px}.bar[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:36px}span[dropdown][_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]{color:var(--color)}"]}),e}(),kn=function(e,t){return{"badge-success":e,"badge-danger":t}};function In(e,t){if(1&e&&(Te.Rb(0),Te.Tb(1,"span",11),Te.Ec(2),Te.Sb(),Te.Tb(3,"span",12),Te.Ec(4),Te.Sb(),Te.Qb()),2&e){var n=Te.dc();Te.Bb(1),Te.jc("ngClass",Te.oc(4,kn,200===n.responseStatus.status,200!==n.responseStatus.status)),Te.Bb(1),Te.Hc(" ",n.responseStatus.status," ",n.responseStatus.statusText,""),Te.Bb(2),Te.Gc("",(n.responseStatus.time/1e3).toFixed(2)," s")}}function Mn(e,t){1&e&&(Te.Tb(0,"div",13),Te.Tb(1,"div",14),Te.Tb(2,"span",15),Te.Ec(3,"Loading..."),Te.Sb(),Te.Sb(),Te.Sb())}function En(e,t){if(1&e&&(Te.Tb(0,"alert",16),Te.Tb(1,"strong"),Te.Ec(2,"Response Error:"),Te.Sb(),Te.Ec(3),Te.Sb()),2&e){var n=Te.dc().ngIf;Te.Bb(3),Te.Gc(" ",n.error," ")}}function Nn(e,t){if(1&e&&(Te.Rb(0),Te.Cc(1,En,4,1,"alert",8),Te.Qb()),2&e){var n=t.ngIf;Te.Bb(1),Te.jc("ngIf",n.error)}}function Pn(e,t){if(1&e&&(Te.Tb(0,"p",18),Te.Ec(1),Te.Sb()),2&e){var n=t.$implicit;Te.Bb(1),Te.Fc(n)}}function qn(e,t){if(1&e&&(Te.Tb(0,"alert",16),Te.Tb(1,"strong"),Te.Ec(2,"Runtime Error:"),Te.Sb(),Te.Cc(3,Pn,2,1,"p",17),Te.Sb()),2&e){var n=Te.dc();Te.Bb(3),Te.jc("ngForOf",n.scriptContext.errors)}}function An(e,t){if(1&e&&Te.Ob(0,"app-show-in-presenter",19),2&e){var n=Te.dc();Te.jc("items",n.scriptContext.showInItems)}}var Dn=function(){function e(){}return e.prototype.ngOnInit=function(){this.setResponse()},e.prototype.ngOnChanges=function(){this.setResponse()},e.prototype.setResponse=function(){this.responseState?(this.responseStatus=this.responseState.status,this.setContentValue(this.responseState.response)):this.responseStatus=null},e.prototype.resize=function(){this.tabs&&this.tabs.resize()},e.prototype.setContentValue=function(e){var t=mt.a.resolveString("{{responseContent}}");t&&"{{responseContent}}"!==t?(this.responseType=e.contentType===Jt.b.JSON&&"object"==typeof t?"json":t.toLowerCase().startsWith("<!doctype html")?"html":"text",this.dataModel=t):(this.dataModel=null,this.responseType=null)},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Te.Hb({type:e,selectors:[["app-response-card"]],viewQuery:function(e,t){var n;1&e&&Te.Jc(Xe.a,!0),2&e&&Te.rc(n=Te.cc())&&(t.tabs=n.first)},inputs:{scriptContext:"scriptContext",responseState:"responseState"},features:[Te.zb],decls:13,vars:6,consts:[[1,"card","flex-fill","overflow-hidden","mb-0"],[1,"card-header","p-2","d-flex","align-items-center"],["header",""],[4,"ngIf"],[1,"ml-auto",3,"assertions"],[1,"card-body","overflow-hidden","response-container","p-0","d-flex","flex-column"],["body",""],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner",4,"ngIf"],["type","danger",4,"ngIf"],[1,"p-2","h-100"],[3,"items",4,"ngIf"],[1,"badge","ml-2","p-1",3,"ngClass"],[1,"badge","badge-info","ml-2","p-1"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner"],["role","status",1,"spinner-border"],[1,"sr-only"],["type","danger"],["class","mb-0",4,"ngFor","ngForOf"],[1,"mb-0"],[3,"items"]],template:function(e,t){1&e&&(Te.Tb(0,"div",0),Te.Tb(1,"div",1,2),Te.Ec(3," Response "),Te.Cc(4,In,5,7,"ng-container",3),Te.Ob(5,"app-assertion-logs",4),Te.Sb(),Te.Tb(6,"div",5,6),Te.Cc(8,Mn,4,0,"div",7),Te.Cc(9,Nn,2,1,"ng-container",3),Te.Cc(10,qn,4,1,"alert",8),Te.Tb(11,"div",9),Te.Cc(12,An,1,1,"app-show-in-presenter",10),Te.Sb(),Te.Sb(),Te.Sb()),2&e&&(Te.Bb(4),Te.jc("ngIf",t.responseStatus),Te.Bb(1),Te.jc("assertions",t.scriptContext&&t.scriptContext.asserts),Te.Bb(3),Te.jc("ngIf",null==t.responseState?null:t.responseState.loading),Te.Bb(1),Te.jc("ngIf",t.responseStatus),Te.Bb(1),Te.jc("ngIf",t.scriptContext&&t.scriptContext.errors.length),Te.Bb(2),Te.jc("ngIf",t.scriptContext))},directives:[o.m,We.a,o.k,Ze.a,o.l,Xe.a],styles:['[_ngcontent-%COMP%]:root{--bg:#fff;--body-bg:#e4e5e6;--header-bg:#ebedef;--color:#4f5d73;--border-color:#c4c9d0;--wj-alt:#f7f7f7;--form-input-bg:#fff;--form-input-color:#768192;--nav-link-color:#8a93a2;--secondary-color:#c4c9d0;--opacity:0.05;--hover:"#f0f3f5"}.response-json[_ngcontent-%COMP%], wj-flex-grid[_ngcontent-%COMP%]{border:1px solid #d8dbe0;height:100%;width:auto}.response-container[_ngcontent-%COMP%]{padding:8px}tabset[_ngcontent-%COMP%]     .nav-link.active>.bs-remove-tab{display:inline}.bs-remove-tab[_ngcontent-%COMP%]{display:none}.bs-remove-tab[_ngcontent-%COMP%]:hover{color:#636f83;cursor:pointer}.left-menu[_ngcontent-%COMP%]{left:auto!important;min-width:100px;right:0!important}.tabs-actions[_ngcontent-%COMP%]{z-index:7}.tabs-options[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-bottom:3px;vertical-align:middle}  .workflow-logs-container.popover{max-width:400px;width:400px}alert[_ngcontent-%COMP%]    >.alert{margin-bottom:0}']}),e}(),Bn=["requestCard"],Fn=["responseCard"],Rn=function(e){return{collapsed:e}},$n=function(){function e(e){this.container=e,this.changed=new Te.p,this.minCardBodyHeight=90,this.headerHeight=54,this.direction="vertical",this.requestHeight=0,this.requestMinHeight=254,this.isCollapsed=!1,this.defaultSizes={},this.defaultMinSizes={vertical:54,horizontal:254},this.destroy$=new $e.a}return e.prototype.ngOnInit=function(){var e=this;this.uiSettings=this.restModel.uiSettings,this.isCollapsed=Boolean(this.uiSettings.isRequestPanelCollapsed),this.setSize(),this.currentRequest=this.restModel.request,this.scriptContext=null,this.resetDefaultSizes(),this.direction=this.uiSettings.direction||"vertical";var t=this.uiSettings.sizes;t?this.defaultSizes[this.direction]=t[0]:this.resetDefaultSizes(),this.requestCard.receiveResponse.subscribe((function(t){e.responseCard.responseState=t})),this.requestCard.changed.subscribe((function(t){e.changed.emit(JSON.stringify(t)),e.direction=t.uiSettings.direction,e.isCollapsed=t.uiSettings.isRequestPanelCollapsed,e.setSize()}))},e.prototype.ngOnChanges=function(e){var t=this;window.requestAnimationFrame((function(){t.uiSettings.isRequestPanelCollapsed||t.setSize()}))},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.onScriptChange=function(e){this.scriptContext=e},e.prototype.onResize=function(){this.requestCard.resize(),this.responseCard.resize()},e.prototype.onDragEnd=function(e){mt.a.setSettingsVariable(this.getSettingsKey(),e.sizes),this.uiSettings.sizes=e.sizes,this.onResize()},e.prototype.setSize=function(){if(this.isCollapsed)this.requestHeight=this.headerHeight;else if(this.currentRequest){var e=mt.a.settingsVariables[this.getSettingsKey()];this.requestHeight=e?e[0]:this.defaultSizes[this.direction]}else this.requestHeight=this.defaultSizes[this.direction];this.requestMinHeight=this.defaultMinSizes[this.direction]},e.prototype.getSettingsKey=function(){var e=this.currentRequest;return"rest-request-"+e.method+"-"+e.url},e.prototype.resetDefaultSizes=function(){this.defaultSizes={horizontal:.4*this.container.nativeElement.offsetHeight,vertical:.5*this.container.nativeElement.offsetWidth}},e.\u0275fac=function(t){return new(t||e)(Te.Nb(Te.n))},e.\u0275cmp=Te.Hb({type:e,selectors:[["app-rest"]],viewQuery:function(e,t){var n;1&e&&(Te.Ac(Bn,!0),Te.Ac(Fn,!0)),2&e&&(Te.rc(n=Te.cc())&&(t.requestCard=n.first),Te.rc(n=Te.cc())&&(t.responseCard=n.first))},inputs:{restModel:"restModel"},outputs:{changed:"changed"},features:[Te.zb],decls:10,vars:12,consts:[["unit","pixel",3,"direction","useTransition","ngClass","disabled","gutterSize","dragEnd","transitionEnd"],["split","asSplit"],[1,"d-flex",3,"size","minSize"],["area1","asSplitArea"],[1,"d-flex","flex-fill","w-100",3,"restModel","scriptResult"],["requestCard",""],["size","*",1,"d-flex","mb-0",3,"minSize"],["area2","asSplitArea"],[1,"d-flex","flex-fill","w-100",3,"scriptContext"],["responseCard",""]],template:function(e,t){1&e&&(Te.Tb(0,"as-split",0,1),Te.bc("dragEnd",(function(e){return t.onDragEnd(e)}))("transitionEnd",(function(){return t.onResize()})),Te.Tb(2,"as-split-area",2,3),Te.Tb(4,"app-request-card",4,5),Te.bc("scriptResult",(function(e){return t.onScriptChange(e)})),Te.Sb(),Te.Sb(),Te.Tb(6,"as-split-area",6,7),Te.Ob(8,"app-response-card",8,9),Te.Sb(),Te.Sb()),2&e&&(Te.jc("direction",t.direction)("useTransition",!0)("ngClass",Te.nc(10,Rn,t.isCollapsed))("disabled","horizontal"===t.direction&&t.isCollapsed)("gutterSize",t.isCollapsed?0:11),Te.Bb(2),Te.jc("size",t.requestHeight)("minSize",t.requestMinHeight),Te.Bb(2),Te.jc("restModel",t.restModel),Te.Bb(2),Te.jc("minSize",t.requestMinHeight),Te.Bb(2),Te.jc("scriptContext",t.scriptContext))},directives:[Ke.c,o.k,Ke.b,xn,Dn],styles:["[_nghost-%COMP%] {\n      display: flex;\n      flex-direction: column;\n      height: 100%;\n    }\n\n    as-split.collapsed[_ngcontent-%COMP%]   as-split-area[_ngcontent-%COMP%]:not(:last-child) {\n      margin-bottom: .5rem;\n      margin-right: .5rem;\n    }"]}),e}();function zn(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"app-rest",2),Te.bc("changed",(function(e){return Te.vc(n),Te.dc().onChange(e)})),Te.Sb()}if(2&e){var i=Te.dc();Te.jc("restModel",i.restModel)}}function _n(e,t){1&e&&(Te.Tb(0,"div",3),Te.Tb(1,"div",4),Te.Tb(2,"span",5),Te.Ec(3,"Loading..."),Te.Sb(),Te.Sb(),Te.Sb())}var Ln=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(h.d)(t,e),t.prototype.ngOnInit=function(){var t=this;e.prototype.ngOnInit.call(this),this.restModel={request:{method:"GET",url:"",headers:[{name:"Content-Type",value:"application/json",active:!0}],queryParameters:[],contentType:Jt.b.JSON,body:void 0,auth:{type:Jt.a.None}},uiSettings:{isRequestPanelCollapsed:!1,runOnload:!1}},this.content$.subscribe((function(e){e&&(t.restModel=JSON.parse(e))}))},t.\u0275fac=function(e){return Un(e||t)},t.\u0275cmp=Te.Hb({type:t,selectors:[["app-tab-rest"]],features:[Te.yb],decls:2,vars:2,consts:[["class","h-100 w-100",3,"restModel","changed",4,"ngIf"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner",4,"ngIf"],[1,"h-100","w-100",3,"restModel","changed"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(e,t){1&e&&(Te.Cc(0,zn,1,1,"app-rest",0),Te.Cc(1,_n,4,0,"div",1)),2&e&&(Te.jc("ngIf",!t.loading&&t.restModel),Te.Bb(1),Te.jc("ngIf",t.loading))},directives:[o.m,$n],styles:[""]}),t}(ft),Un=Te.Vb(Ln),Qn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(h.d)(t,e),t.\u0275fac=function(e){return Hn(e||t)},t.\u0275cmp=Te.Hb({type:t,selectors:[["app-tab-json"]],features:[Te.yb],decls:3,vars:4,consts:[[1,"h-100",3,"data","formatter","changed"],["dataEditor",""]],template:function(e,t){1&e&&(Te.Tb(0,"app-content-explorer",0,1),Te.bc("changed",(function(e){return t.onChange(e)})),Te.ec(2,"async"),Te.Sb()),2&e&&Te.jc("data",Te.fc(2,2,t.content$))("formatter",!0)},directives:[Zt.a],pipes:[o.b],styles:[""]}),t}(ft),Hn=Te.Vb(Qn),Vn=n("dDP7"),Jn=n("KYMM");function Xn(e,t){1&e&&(Te.Tb(0,"div",5),Te.Tb(1,"div",6),Te.Tb(2,"span",7),Te.Ec(3,"Loading..."),Te.Sb(),Te.Sb(),Te.Sb())}var Gn=function(e){function t(t,n,i,o,r){var c=e.call(this,t,n,i,o)||this;return c.store=t,c.appService=n,c.userFilesService=i,c.authService=o,c.dialogService=r,c}return Object(h.d)(t,e),t.prototype.ngOnInit=function(){var t=this;e.prototype.ngOnInit.call(this),this.content$.subscribe((function(e){e&&(t.queryData=JSON.parse(e),t.dataGrid.setQueryData(t.queryData))}))},t.prototype.openDialog=function(){var e=this,t=this.dialogService.open(Vn.a,{class:"modal-xl full-height",keyboard:!1});t.config=this.queryData,t.init.pipe(Object(ie.a)((function(){return t.component.save}))).subscribe((function(t){e.uiModel=null,e.onChange(JSON.stringify(t)),e.queryData=t,e.dataGrid.setQueryData(e.queryData)}))},t.\u0275fac=function(e){return new(e||t)(Te.Nb(r.h),Te.Nb(ue.a),Te.Nb(Ce.a),Te.Nb(Ae.b),Te.Nb(le.b))},t.\u0275cmp=Te.Hb({type:t,selectors:[["app-tab-query"]],viewQuery:function(e,t){var n;1&e&&Te.Ac(Jn.a,!0),2&e&&Te.rc(n=Te.cc())&&(t.dataGrid=n.first)},features:[Te.yb],decls:7,vars:1,consts:[[1,"d-flex","h-100","flex-column"],[1,"col-auto","px-0","mb-2"],[1,"btn","btn-primary",3,"click"],[1,"d-flex","h-100","overflow-hidden"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner",4,"ngIf"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(e,t){1&e&&(Te.Tb(0,"div",0),Te.Tb(1,"div",1),Te.Tb(2,"button",2),Te.bc("click",(function(){return t.openDialog()})),Te.Ec(3,"Query Dialog"),Te.Sb(),Te.Sb(),Te.Tb(4,"div",3),Te.Ob(5,"dc-data-grid"),Te.Sb(),Te.Sb(),Te.Cc(6,Xn,4,0,"div",4)),2&e&&(Te.Bb(6),Te.jc("ngIf",t.loading))},directives:[Jn.a,o.m],styles:[""]}),t}(ft),Kn=n("AXyZ");function Wn(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"app-db-table",2),Te.bc("tableChange",(function(e){return Te.vc(n),Te.dc().onChange(e)}))("deleted",(function(){return Te.vc(n),Te.dc().onDeleted()})),Te.Sb()}if(2&e){var i=Te.dc();Te.jc("dataObject",i.dataObject)("connection",i.tabData.info.connection)("connections",i.connections)("saveBtn",!1)}}function Zn(e,t){1&e&&(Te.Tb(0,"div",3),Te.Tb(1,"div",4),Te.Tb(2,"span",5),Te.Ec(3,"Loading..."),Te.Sb(),Te.Sb(),Te.Sb())}var Yn=function(){function e(e,t,n,i,o){this.dbService=e,this.notificationService=t,this.store=n,this.authService=i,this.actions$=o,this.loading=!1,this.destroy$=new $e.a}return e.prototype.ngOnInit=function(){return Object(h.b)(this,void 0,void 0,(function(){var e=this;return Object(h.e)(this,(function(t){return this.actions$.pipe(Object(c.e)(F),Object(ze.a)(this.destroy$)).subscribe((function(t){t.keys.includes(e.getKey())&&e.loadData()})),this.authService.isAuthenticated$.subscribe((function(t){t&&e.loadData()})),this.store.select(Se).subscribe((function(t){e.connections=t})),[2]}))}))},e.prototype.getKey=function(){return Object(H.f)(this.tabData.info.connection,this.tabData.info.sqlObject)},e.prototype.onChange=function(e){this.store.dispatch(q({key:this.getKey(),data:e}))},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.onDeleted=function(){this.store.dispatch(R({link:this.tabData.info})),this.store.dispatch(q({key:this.getKey(),data:null})),this.store.dispatch(N({links:[this.tabData.info]}))},e.prototype.loadData=function(){return Object(h.b)(this,void 0,void 0,(function(){var e,t,n,i;return Object(h.e)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,3,4]),this.loading=!0,n=this,[4,this.dbService.getMetaDataObject((e=this.tabData.info).connection.connectionName,(t=e.sqlObject).schemaName,t.objectName,t.objectType).toPromise()];case 1:return n.dataObject=o.sent(),this.dataObject||(this.dataObject={fields:[],objectId:0,schemaName:null,objectName:null,objectType:Ne.DbObjectType.Table}),[3,4];case 2:return i=o.sent(),this.notificationService.error(i),this.dataObject=null,[3,4];case 3:return this.loading=!1,[7];case 4:return[2]}}))}))},e.\u0275fac=function(t){return new(t||e)(Te.Nb(le.f),Te.Nb(le.e),Te.Nb(r.h),Te.Nb(Ae.b),Te.Nb(c.a))},e.\u0275cmp=Te.Hb({type:e,selectors:[["app-tab-table"]],inputs:{tabData:"tabData"},decls:2,vars:2,consts:[[3,"dataObject","connection","connections","saveBtn","tableChange","deleted",4,"ngIf"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[3,"dataObject","connection","connections","saveBtn","tableChange","deleted"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(e,t){1&e&&(Te.Cc(0,Wn,1,4,"app-db-table",0),Te.Cc(1,Zn,4,0,"div",1)),2&e&&(Te.jc("ngIf",!t.loading),Te.Bb(1),Te.jc("ngIf",t.loading))},directives:[o.m,Kn.a],styles:["[_nghost-%COMP%]{position:relative}"]}),e}(),ei=n("xpqn");function ti(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"app-db-view",2),Te.bc("viewChanged",(function(e){return Te.vc(n),Te.dc().onChange(e)}))("deleted",(function(){return Te.vc(n),Te.dc().onDeleted()})),Te.Sb()}if(2&e){var i=Te.dc();Te.jc("dataObject",i.dataObject)("connection",i.tabData.info.connection)}}function ni(e,t){1&e&&(Te.Tb(0,"div",3),Te.Tb(1,"div",4),Te.Tb(2,"span",5),Te.Ec(3,"Loading..."),Te.Sb(),Te.Sb(),Te.Sb())}var ii=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(h.d)(t,e),t.\u0275fac=function(e){return oi(e||t)},t.\u0275cmp=Te.Hb({type:t,selectors:[["app-tab-view"]],features:[Te.yb],decls:2,vars:2,consts:[[3,"dataObject","connection","viewChanged","deleted",4,"ngIf"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[3,"dataObject","connection","viewChanged","deleted"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(e,t){1&e&&(Te.Cc(0,ti,1,2,"app-db-view",0),Te.Cc(1,ni,4,0,"div",1)),2&e&&(Te.jc("ngIf",!t.loading&&t.dataObject),Te.Bb(1),Te.jc("ngIf",t.loading))},directives:[o.m,ei.a],styles:[""]}),t}(Yn),oi=Te.Vb(ii),ri=n("8gf/");function ci(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"app-db-procedure",2),Te.bc("procedureChanged",(function(e){return Te.vc(n),Te.dc().onChange(e)}))("procedureDeleted",(function(){return Te.vc(n),Te.dc().onDeleted()})),Te.Sb()}if(2&e){var i=Te.dc();Te.jc("dataObject",i.dataObject)("connection",i.tabData.info.connection)}}function ai(e,t){1&e&&(Te.Tb(0,"div",3),Te.Tb(1,"div",4),Te.Tb(2,"span",5),Te.Ec(3,"Loading..."),Te.Sb(),Te.Sb(),Te.Sb())}var si=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(h.d)(t,e),t.\u0275fac=function(e){return li(e||t)},t.\u0275cmp=Te.Hb({type:t,selectors:[["app-tab-procedure"]],features:[Te.yb],decls:2,vars:2,consts:[[3,"dataObject","connection","procedureChanged","procedureDeleted",4,"ngIf"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[3,"dataObject","connection","procedureChanged","procedureDeleted"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(e,t){1&e&&(Te.Cc(0,ci,1,2,"app-db-procedure",0),Te.Cc(1,ai,4,0,"div",1)),2&e&&(Te.jc("ngIf",!t.loading&&t.dataObject),Te.Bb(1),Te.jc("ngIf",t.loading))},directives:[o.m,ri.a],styles:[""]}),t}(Yn),li=Te.Vb(si),ui=n("FbUF");function di(e,t){if(1&e&&Te.Ob(0,"app-tab-jspy",9),2&e){var n=Te.dc(2).$implicit;Te.jc("tabData",n)}}function pi(e,t){if(1&e&&Te.Ob(0,"app-tab-page",9),2&e){var n=Te.dc(2).$implicit;Te.jc("tabData",n)}}function bi(e,t){if(1&e&&Te.Ob(0,"app-tab-xml",9),2&e){var n=Te.dc(2).$implicit;Te.jc("tabData",n)}}function fi(e,t){if(1&e&&Te.Ob(0,"app-tab-xml",9),2&e){var n=Te.dc(2).$implicit;Te.jc("tabData",n)}}function hi(e,t){if(1&e&&Te.Ob(0,"app-tab-sql",9),2&e){var n=Te.dc(2).$implicit;Te.jc("tabData",n)}}function vi(e,t){if(1&e&&Te.Ob(0,"app-tab-rest",9),2&e){var n=Te.dc(2).$implicit;Te.jc("tabData",n)}}function gi(e,t){if(1&e&&Te.Ob(0,"app-tab-json",9),2&e){var n=Te.dc(2).$implicit;Te.jc("tabData",n)}}function mi(e,t){if(1&e&&Te.Ob(0,"app-tab-query",10),2&e){var n=Te.dc(2).$implicit;Te.jc("tabData",n)}}function ji(e,t){if(1&e&&(Te.Tb(0,"div"),Te.Ec(1),Te.Sb()),2&e){var n,i=Te.dc(2).$implicit,o=Te.dc();Te.Bb(1),Te.Gc(" Content handler for application content type ",null==(n=o.getAppInfo(i))?null:n.contentType," not implemented yet. ")}}function yi(e,t){if(1&e&&(Te.Rb(0,5),Te.Cc(1,di,1,1,"app-tab-jspy",6),Te.Cc(2,pi,1,1,"app-tab-page",6),Te.Cc(3,bi,1,1,"app-tab-xml",6),Te.Cc(4,fi,1,1,"app-tab-xml",6),Te.Cc(5,hi,1,1,"app-tab-sql",6),Te.Cc(6,vi,1,1,"app-tab-rest",6),Te.Cc(7,gi,1,1,"app-tab-json",6),Te.Cc(8,mi,1,1,"app-tab-query",7),Te.Cc(9,ji,2,1,"div",8),Te.Qb()),2&e){var n,i=Te.dc().$implicit,o=Te.dc();Te.jc("ngSwitch",null==(n=o.getAppInfo(i))?null:n.contentType),Te.Bb(1),Te.jc("ngSwitchCase","jspy"),Te.Bb(1),Te.jc("ngSwitchCase","page.xml"),Te.Bb(1),Te.jc("ngSwitchCase","shell.xml"),Te.Bb(1),Te.jc("ngSwitchCase","xml"),Te.Bb(1),Te.jc("ngSwitchCase","sql"),Te.Bb(1),Te.jc("ngSwitchCase","rest"),Te.Bb(1),Te.jc("ngSwitchCase","json"),Te.Bb(1),Te.jc("ngSwitchCase","query")}}function Oi(e,t){if(1&e&&Te.Ob(0,"app-tab-table",9),2&e){var n=Te.dc(2).$implicit;Te.jc("tabData",n)}}function Si(e,t){if(1&e&&Te.Ob(0,"app-tab-view",9),2&e){var n=Te.dc(2).$implicit;Te.jc("tabData",n)}}function wi(e,t){if(1&e&&Te.Ob(0,"app-tab-procedure",9),2&e){var n=Te.dc(2).$implicit;Te.jc("tabData",n)}}function Ci(e,t){if(1&e&&(Te.Tb(0,"div"),Te.Ec(1," Content handler for Database content types not implemented yet. "),Te.Ob(2,"br"),Te.Ec(3),Te.Sb()),2&e){var n=Te.dc(2).$implicit,i=Te.dc();Te.Bb(3),Te.Gc(" ",i.renderDbTabInfo(n)," ")}}function Ti(e,t){if(1&e&&(Te.Rb(0,5),Te.Cc(1,Oi,1,1,"app-tab-table",6),Te.Cc(2,Si,1,1,"app-tab-view",6),Te.Cc(3,wi,1,1,"app-tab-procedure",6),Te.Cc(4,Ci,4,1,"div",8),Te.Qb()),2&e){var n,i=Te.dc().$implicit,o=Te.dc();Te.jc("ngSwitch",null==(n=o.getDbInfo(i))?null:n.sqlObject.objectType),Te.Bb(1),Te.jc("ngSwitchCase","Table"),Te.Bb(1),Te.jc("ngSwitchCase","View"),Te.Bb(1),Te.jc("ngSwitchCase","Procedure")}}function xi(e,t){if(1&e&&Te.Ob(0,"app-db-query",11),2&e){var n=Te.dc().$implicit;Te.jc("connections",n.info)}}function ki(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"tab",2),Te.bc("removed",(function(){Te.vc(n);var e=t.$implicit;return Te.dc().onTabRemove(e)}))("selectTab",(function(){Te.vc(n);var e=t.$implicit;return Te.dc().onSelectTab(e)})),Te.Cc(1,yi,10,9,"ng-container",3),Te.Cc(2,Ti,5,4,"ng-container",3),Te.Cc(3,xi,1,1,"app-db-query",4),Te.Sb()}if(2&e){var i=t.$implicit,o=Te.dc();Te.jc("heading",o.getHeader(i))("removable",!0),Te.Bb(1),Te.jc("ngIf",i.tabType===o.tabTypes.APP),Te.Bb(1),Te.jc("ngIf",i.tabType===o.tabTypes.DB),Te.Bb(1),Te.jc("ngIf",i.tabType===o.tabTypes.SQLQuery)}}var Ii=function(){function e(e,t,n){this.store=e,this.router=t,this.route=n,this.tabTypes=X.a}return e.prototype.ngOnInit=function(){var e=this;this.tabs$=this.store.select(ge),this.store.select(me).pipe(Object(ce.a)((function(e){return Boolean(e)})),Object(Fe.a)(1)).subscribe((function(t){var n=e.tabset.tabs.map((function(e){return e.heading})).indexOf(e.getHeader(t));-1!==n&&(e.tabset.tabs[n].active=!0)})),this.store.select(je).subscribe((function(t){e.changedContent=t})),this.store.select(ye).subscribe((function(t){e.changedObjects=t}))},e.prototype.getHeader=function(e){if(e.tabType===X.a.APP){var t=e.info;return((this.changedContent||[]).find((function(e){return Object(H.b)(e,t)}))?"*  ":"")+Object(qe.b)(t)}if(e.tabType===X.a.DB){var n=e.info,i=n.connection,o=n.sqlObject,r=Object(H.f)(i,o);return(this.changedObjects.hasOwnProperty(r)?"* ":"")+r}return e.tabType},e.prototype.getAppInfo=function(e){if(e.tabType===X.a.APP)return e.info},e.prototype.getDbInfo=function(e){if(e.tabType===X.a.DB)return e.info},e.prototype.onTabRemove=function(e){this.store.dispatch(N({links:[e.info]}))},e.prototype.onSelectTab=function(e){var t;if(e.tabType===X.a.APP)t={file:Object(qe.b)(e.info)},this.route.snapshot.queryParams.source&&(t.source=this.route.snapshot.queryParams.source);else if(e.tabType===X.a.DB){var n=e.info,i=n.connection,o=n.sqlObject;t={connection:Object(H.f)(i,o),tab:this.route.snapshot.queryParams.tab}}else e.tabType===X.a.SQLQuery&&(t={});t&&this.router.navigate([],{relativeTo:this.route,queryParams:t})},e.prototype.renderDbTabInfo=function(e){return JSON.stringify(e.info)},e.\u0275fac=function(t){return new(t||e)(Te.Nb(r.h),Te.Nb(Ie.f),Te.Nb(Ie.a))},e.\u0275cmp=Te.Hb({type:e,selectors:[["app-tabs"]],viewQuery:function(e,t){var n;1&e&&Te.Ac(Re.d,!0),2&e&&Te.rc(n=Te.cc())&&(t.tabset=n.first)},decls:3,vars:3,consts:[[1,"tabset-fx","nav-tabs-boxed"],[3,"heading","removable","removed","selectTab",4,"ngFor","ngForOf"],[3,"heading","removable","removed","selectTab"],[3,"ngSwitch",4,"ngIf"],["class","h-100 w-100",3,"connections",4,"ngIf"],[3,"ngSwitch"],["class","h-100 w-100",3,"tabData",4,"ngSwitchCase"],["class","h-100 w-100 test",3,"tabData",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"h-100","w-100",3,"tabData"],[1,"h-100","w-100","test",3,"tabData"],[1,"h-100","w-100",3,"connections"]],template:function(e,t){1&e&&(Te.Tb(0,"tabset",0),Te.Cc(1,ki,4,5,"tab",1),Te.ec(2,"async"),Te.Sb()),2&e&&(Te.Bb(1),Te.jc("ngForOf",Te.fc(2,1,t.tabs$)))},directives:[Re.d,o.l,Re.a,o.m,o.o,o.p,o.q,ft,kt,Pt,Vt,Ln,Qn,Gn,Yn,ii,si,ui.a],pipes:[o.b],styles:['tabset[_ngcontent-%COMP%]     .bs-remove-tab{visibility:hidden;position:relative}tabset[_ngcontent-%COMP%]     .bs-remove-tab:after{content:"\\f00d";font-family:FontAwesome;color:inherit;position:absolute;visibility:visible;right:0}tabset[_ngcontent-%COMP%]     .tab-content{position:relative}']}),e}();function Mi(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"a",9),Te.bc("click",(function(e){return Te.vc(n),Te.dc().openApp(e)})),Te.Ec(1,"Open App"),Te.Sb()}if(2&e){var i=Te.dc();Te.jc("routerLink",i.appUrl)}}var Ei=function(){return["/code"]},Ni=function(){function e(e,t,n,i,o){this.store=e,this.router=t,this.route=n,this.authService=i,this.dialogService=o,this.layoutConfig={icon:"worksheets_logo",smIcon:"worksheets_logo",sidebar:Ne.SidebarState.Opened,appName:"code",menuItems:[]},this.isAuthenticated=!1}return e.prototype.ngOnInit=function(){var e=this;this.hasLinksToSave$=this.store.select(Oe),this.authService.isAuthenticated$.subscribe((function(t){return e.isAuthenticated=t})),this.store.select(Se).subscribe((function(t){e.connections=t}));var t=this.store.select(fe).pipe(Object(Ee.a)((function(t){return e.app=t})),Object(oe.a)((function(e){return e?"/app/"+e.ownerName+"/"+e.appName:null})));Object(Me.a)([t,this.route.queryParams]).subscribe((function(t){var n=t[1],i=n.file,o=n.connection;if(e.appUrl=t[0],i)e.store.dispatch(E({info:Object(qe.a)(i),app:e.app,tabType:X.a.APP}));else if(o){var r=Object(H.e)(o);e.store.dispatch(U({connection:r.connection})),r.sqlObject&&e.store.dispatch(E({info:r,app:e.app,tabType:X.a.DB}))}})),this.store.select(me).pipe(Object(ce.a)((function(e){return void 0!==e})),Object(oe.a)((function(t){t||e.router.navigate([],{relativeTo:e.route,queryParams:{}});var n=null==t?void 0:t.info;return(null==t?void 0:t.tabType)===X.a.APP&&n.contentType===Pe.a.PAGE?n:null}))).subscribe((function(t){return e.pageInfo=t}))},e.prototype.openApp=function(e){if(this.pageInfo){e.preventDefault();var t=this.pageInfo,n=t.queryString;window.open(this.appUrl+"/"+t.name+(n?"?"+n:""),"_blank")}},e.prototype.handleKeyboardEvent=function(e){e.ctrlKey&&"s"===e.key&&(e.preventDefault(),e.stopImmediatePropagation(),this.onSave())},e.prototype.onSave=function(){this.store.dispatch(A()),this.store.dispatch(D())},e.prototype.onImport=function(){var e=this,t=this.dialogService.open(De.a,{class:"modal-xl full-height",keyboard:!1});t.config={connections:this.connections,connection:null},t.init.pipe(Object(ie.a)((function(){return t.component.import}))).subscribe((function(t){t.newTable&&e.store.dispatch(_())}))},e.prototype.ngOnDestroy=function(){this.store.dispatch(Q())},e.\u0275fac=function(t){return new(t||e)(Te.Nb(r.h),Te.Nb(Ie.f),Te.Nb(Ie.a),Te.Nb(Ae.b),Te.Nb(le.b))},e.\u0275cmp=Te.Hb({type:e,selectors:[["app-code-layout"]],hostBindings:function(e,t){1&e&&Te.bc("keydown",(function(e){return t.handleKeyboardEvent(e)}),!1,Te.tc)},decls:14,vars:10,consts:[[3,"config"],["title","",1,"cursor-pointer","h2","mb-0","ml-0","top-sub-header","w-md-down-50","mr-auto",3,"routerLink"],["header",""],["type","button",1,"btn","btn-light","btn-sm","ml-auto","align-self-center","mr-2",3,"disabled","title","click"],["type","button",1,"btn","btn-primary","btn-sm","align-self-center","mr-2",3,"disabled","title","click"],["class","btn btn-light btn-sm mr-2 align-self-center","target","_blank",3,"routerLink","click",4,"ngIf"],["sidebar",""],["content","",1,"main","h-100"],[1,"container-fluid","p-md-0","p-sm-2","h-100"],["target","_blank",1,"btn","btn-light","btn-sm","mr-2","align-self-center",3,"routerLink","click"]],template:function(e,t){1&e&&(Te.Tb(0,"app-layout",0),Te.Tb(1,"a",1),Te.Ec(2,"Code"),Te.Sb(),Te.Rb(3,2),Te.Tb(4,"button",3),Te.bc("click",(function(){return t.onImport()})),Te.Ec(5,"Import Data"),Te.Sb(),Te.Tb(6,"button",4),Te.bc("click",(function(){return t.onSave()})),Te.ec(7,"async"),Te.Ec(8,"Save"),Te.Sb(),Te.Cc(9,Mi,2,1,"a",5),Te.Qb(),Te.Ob(10,"router-outlet",6),Te.Tb(11,"main",7),Te.Tb(12,"div",8),Te.Ob(13,"app-tabs"),Te.Sb(),Te.Sb(),Te.Sb()),2&e&&(Te.jc("config",t.layoutConfig),Te.Bb(1),Te.jc("routerLink",Te.mc(9,Ei)),Te.Bb(3),Te.jc("disabled",!t.isAuthenticated)("title",t.isAuthenticated?"Import data to DB":"Login to be able to import data"),Te.Bb(2),Te.jc("disabled",!Te.fc(7,7,t.hasLinksToSave$)||!t.isAuthenticated)("title",t.isAuthenticated?"Save changes":"Login to be able to save"),Te.Bb(3),Te.jc("ngIf",t.app))},directives:[Be.a,Ie.h,o.m,Ie.j,Ii],pipes:[o.b],styles:['[_ngcontent-%COMP%]:root{--bg:#fff;--body-bg:#e4e5e6;--header-bg:#ebedef;--color:#4f5d73;--border-color:#c4c9d0;--wj-alt:#f7f7f7;--form-input-bg:#fff;--form-input-color:#768192;--nav-link-color:#8a93a2;--secondary-color:#c4c9d0;--opacity:0.05;--hover:"#f0f3f5"}[_nghost-%COMP%]{display:flex;flex-direction:column;max-height:100%;min-height:100vh}[_nghost-%COMP%]   router-outlet[_ngcontent-%COMP%] +   app-code-sidebar{display:flex;flex-direction:column;height:100%;padding:.5rem 0;width:100%}']}),e}(),Pi=n("Ep24"),qi=n("wxzg"),Ai=n("Uwcb"),Di=n("I7ZH"),Bi=["folderMenu"],Fi=["fileMenu"],Ri=function(){function e(e,t,n,i,o){this.store=e,this.route=t,this.router=n,this.notificationService=i,this.dialogService=o,this.links=[],this.addToRoot=!1,this.destroy=new $e.a}return e.prototype.ngOnInit=function(){var e=this;this.links$=this.store.select(he).pipe(Object(ze.a)(this.destroy),Object(oe.a)((function(e){return Object(Pi.sort)(Object(H.g)(e),"children DESC","label ASC")}))),this.links$.subscribe((function(t){return e.links=t})),this.store.select(be).pipe(Object(ze.a)(this.destroy)).subscribe((function(){window.requestAnimationFrame((function(){e.selectItem()}))})),this.store.select(me).pipe(Object(ze.a)(this.destroy)).subscribe((function(t){(null==t?void 0:t.tabType)===X.a.APP?(e.link=null==t?void 0:t.info,e.selectItem()):(e.link=null,e.tree.selectedItem=void 0)}))},e.prototype.ngOnDestroy=function(){this.destroy.next(),this.destroy.complete()},e.prototype.showContextMenu=function(e,t){var n,i;if(!this.isReadOnly){if(e.preventDefault(),"app.xml"===(null===(n=t.selectedItem)||void 0===n?void 0:n.label))return;this.addToRoot="WJ-TREE-VIEW"===e.toElement.tagName,(null===(i=t.selectedItem)||void 0===i?void 0:i.children)||this.addToRoot?this.folderMenu.show(e):this.fileMenu.show(e)}},e.prototype.folderMenuClick=function(e,t){switch(e.selectedValue){case"new-script":this.createContentFile("new-script",Pe.a.SCRIPT);break;case"new-page":this.createContentFile("new-page",Pe.a.PAGE);break;case"new-sql":this.createContentFile("new-sql",Pe.a.SQL);break;case"new-rest":this.createContentFile("new-rest",Pe.a.REST);break;case"new-json":this.createContentFile("new-json",Pe.a.JSON);break;case"new-query":this.createContentFile("new-query",Pe.a.QUERY);break;case"new-folder":this.createContentFile("new-folder");break;case"rename":t.startEditing(t.selectedNode);break;case"delete":this.deleteNode(t.selectedNode)}},e.prototype.fileMenuClick=function(e,t){switch(e.selectedValue){case"rename":t.startEditing(t.selectedNode);break;case"delete":this.deleteNode(t.selectedNode)}},e.prototype.onFileSelect=function(e){e.selectedItem.children||e.selectedItem.link&&this.router.navigate([],{relativeTo:this.route,queryParams:{file:Object(qe.b)(e.selectedItem.link),source:this.route.snapshot.queryParams.source}})},e.prototype.onEditStarting=function(e){var t;"app.xml"===(null===(t=e.node.dataItem)||void 0===t?void 0:t.label)&&(e.cancel=!0)},e.prototype.onEditEnding=function(e){var t=e.node;return this.getNodeText(t)?this.validateName(t)&&this.validateNameUnique(t)?(e.cancel=!1,e):(e.cancel=!0,e):(e.node.dataItem.previousLabel=t.dataItem.label,e)},e.prototype.onEditEnded=function(e){var t,n=e.node;n.element.classList.remove("error"),n.element.removeAttribute("title");var i=n.dataItem,o=!1;i.label?o=i.children?this.updateRenameFolders(n):this.saveLink(n):n.hasChildren||(null===(t=i.link)||void 0===t?void 0:t.contentId)?(i.label=i.previousLabel,delete i.previousLabel,n.element.querySelector("span.wj-node-text").innerText=i.label):n.remove(),o&&this.refreshTree(n)},e.prototype.createFolder=function(e){void 0===e&&(e="new-folder"),this.tree.selectedNode=null,this.createNode(this.tree,{label:e,children:[]})},e.prototype.createFile=function(e){this.tree.selectedNode=null,this.createNode(this.tree,{label:e})},e.prototype.createContentFile=function(e,t,n){var i;void 0===n&&(n=!1);var o=!1,r=0,c=t?e+"."+t:e;n&&(this.tree.selectedNode=null);for(var a=(null===(i=this.tree.selectedNode)||void 0===i?void 0:i.hasChildren)?this.tree.selectedNode.nodes.map((function(e){return e.dataItem})):this.links;!o;)0===r?r++:c=t?e+"-"+r+++"."+t:e+"-"+r++,o=!a.some((function(e){return e.label===c}));t?this.createNode(this.tree,{label:c}):this.createFolder(c)},e.prototype.formatItem=function(e){var t,n,i;i=e.dataItem.children?"fa-folder-o":((t={})[Pe.a.PAGE]="fa-file-code-o",t[Pe.a.SCRIPT]="fa-file-text-o",t[Pe.a.SHELL]="fa-file-image-o",t[Pe.a.APP]="fa-file-o",t[Pe.a.QUERY]="fa-code",t[Pe.a.SQL]="fa-code",t[Pe.a.REST]="fa-send",t[Pe.a.JSON]="fa-code",t)[null===(n=e.dataItem.link)||void 0===n?void 0:n.contentType],e.element.innerHTML='<i class="fa '+i+'"></i> '+e.element.innerHTML},e.prototype.onDragStart=function(e){e&&e.node&&e.node.hasChildren&&(e.node.isCollapsed=!0)},e.prototype.onDragOver=function(e){e.dropTarget.dataItem.children||e.position!==Di.DropPosition.Into||(e.position=Di.DropPosition.Before)},e.prototype.onDrop=function(e){e.dragSource&&e.dropTarget&&this.updateDragFolders(e.dragSource,e.dropTarget)},e.prototype.isFolder=function(e){return Boolean(e.dataItem.children)},e.prototype.updateDragFolders=function(e,t,n){var i=this;if(void 0===n&&(n=[]),e.nodes)this.isFolder(e)&&n.push(e.dataItem.label),e.nodes.map((function(e){return i.updateDragFolders(e,t,n)}));else if(e.dataItem.link){var o=e.dataItem.link,r=(n=Object(h.g)([this.getFolder(t),this.isFolder(t)?t.dataItem.label:null],n)).filter((function(e){return e})).join("/");o.folder!==r&&(o.folder=r,this.store.dispatch(this.appInfo?O({link:o}):x({link:o})))}},e.prototype.selectItem=function(){var e,t=this;if((null===(e=this.tree.itemsSource)||void 0===e?void 0:e.length)&&this.link){var n=Object(d.e)(this.tree.itemsSource,"children").find((function(e){return Object(H.b)(e.link,t.link)}));n&&n!==this.tree.selectedItem&&(this.tree.selectedItem=n)}},e.prototype.refreshTree=function(e){var t,n=null===(t=e.parentNode)||void 0===t?void 0:t.dataItem;n?(Object(Pi.sort)(n.children,"children DESC","label ASC"),n.children=Object(h.g)(n.children)):Object(Pi.sort)(this.links,"children DESC","label ASC"),this.tree.loadTree()},e.prototype.saveLink=function(e){var t,n=e.dataItem,i=this.getContentType(n.label),o=n.label.replace("."+i,""),r=this.getFolder(e);if(o===(null===(t=n.link)||void 0===t?void 0:t.name))return!1;var c={name:o,contentType:i,folder:r};return n.link=Object.assign(n.link||{},c),void 0===n.link.contentId&&n.link.contentType===Pe.a.PAGE&&(n.link.content='<page title="New page">\n  <body></body>\n</page>\n'),n.link.contentId&&n.link.hasOwnProperty("content")&&delete n.link.content,n.link.contentId?(c.contentId=n.link.contentId,this.store.dispatch(this.appInfo?O({link:c}):x({link:c}))):this.store.dispatch(k({link:n.link})),!0},e.prototype.updateRenameFolders=function(e,t){var n=this;if(void 0===t&&(t=""),e.nodes)return e.nodes.map((function(e){return n.updateRenameFolders(e,t)})).some((function(e){return e}));if(e.dataItem.link){var i=e.dataItem.link,o=t+this.getFolder(e);if(i.folder!==o)return i.folder=o,this.store.dispatch(this.appInfo?O({link:i}):x({link:i})),!0}},e.prototype.getContentType=function(e){return Object.values(Pe.a).find((function(t){return e.endsWith("."+t)}))},e.prototype.getFolder=function(e){for(var t=[];e.parentNode;)t.push(e.parentNode.dataItem.label),e=e.parentNode;return t.reverse().join("/")},e.prototype.deleteNode=function(e){var t=this,n=e.dataItem;this.dialogService.confirmation("Delete "+(n.children?"folder":"file")+" "+n.label).subscribe((function(i){if(i){var o=t.getLinks(n);t.store.dispatch(w({links:o})),t.store.dispatch(N({links:o})),e.remove()}}))},e.prototype.getLinks=function(e){var t=this;return e.children?Object(Pi.flatten)(e.children.map((function(e){return t.getLinks(e)}))):[e.link]},e.prototype.validateName=function(e){var t=this.getNodeText(e),n=!!e.dataItem.children;if(n&&!t.length)return this.showError(r="Folder name can't be empty",e),!1;if(!n){var i=Object.values(Pe.a),o=i.find((function(e){return t.endsWith("."+e)}));if(!o){var r="File should be one of the types: "+i.join(", ");return this.showError(r,e),!1}if(!t.replace(o,"").length)return this.showError(r="File name can't be empty",e),!1}return!0},e.prototype.validateNameUnique=function(e){var t=this.getNodeText(e);return!(e.parentNode?e.parentNode.nodes.map((function(e){return e.dataItem})):this.links).find((function(n){return e.dataItem!==n&&n.label===t}))||(this.showError('File or folder name - "'+t+'" already exist.',e),!1)},e.prototype.getNodeText=function(e){return e.element.innerText.replace(/\r?\n|\r/g,"").trim()},e.prototype.showError=function(e,t){this.notify&&this.notify.instance.modal.isShown||(this.notify=this.notificationService.open({type:Ne.NotificationType.DANGER,message:e}),this.notify.instance.modal.onHide.subscribe((function(){t.element.querySelector(".wj-node-text").focus()}))),t.element.classList.add("error"),t.element.setAttribute("title",e)},e.prototype.createNode=function(e,t){var n=0===this.links.length;!e.selectedNode||this.addToRoot?n?this.links=[t]:e.selectedNode=e.addChildNode(0,t):e.selectedNode=e.selectedNode.addChildNode(0,t),setTimeout((function(){n&&(e.selectedNode=e.nodes[0]),e.startEditing(e.selectedNode)}),100)},e.\u0275fac=function(t){return new(t||e)(Te.Nb(r.h),Te.Nb(Ie.a),Te.Nb(Ie.f),Te.Nb(le.e),Te.Nb(le.b))},e.\u0275cmp=Te.Hb({type:e,selectors:[["app-tree"]],viewQuery:function(e,t){var n;1&e&&(Te.Ac(Bi,!0),Te.Ac(Fi,!0),Te.Ac(s.b,!0)),2&e&&(Te.rc(n=Te.cc())&&(t.folderMenu=n.first),Te.rc(n=Te.cc())&&(t.fileMenu=n.first),Te.rc(n=Te.cc())&&(t.tree=n.first))},inputs:{appInfo:"appInfo",isReadOnly:"isReadOnly"},decls:28,vars:3,consts:[["ngClass","vs-tree","displayMemberPath","label","childItemsPath","children",1,"p-2",3,"itemsSource","isReadOnly","allowDragging","itemClicked","contextmenu","nodeEditStarting","nodeEditEnding","nodeEditEnded","formatItem","dragStart","dragOver","drop"],["treeview",""],[2,"display","none",3,"itemClicked"],["folderMenu",""],["value","new-folder"],["value","new-script"],["value","new-page"],["value","new-sql"],["value","new-rest"],["value","new-json"],["value","rename"],["value","delete"],["fileMenu",""]],template:function(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"wj-tree-view",0,1),Te.bc("itemClicked",(function(){Te.vc(n);var e=Te.sc(1);return t.onFileSelect(e)}))("contextmenu",(function(e){Te.vc(n);var i=Te.sc(1);return t.showContextMenu(e,i)}))("nodeEditStarting",(function(e){return t.onEditStarting(e)}))("nodeEditEnding",(function(e){return t.onEditEnding(e)}))("nodeEditEnded",(function(e){return t.onEditEnded(e)}))("formatItem",(function(e){return t.formatItem(e)}))("dragStart",(function(e){return t.onDragStart(e)}))("dragOver",(function(e){return t.onDragOver(e)}))("drop",(function(e){return t.onDrop(e)})),Te.Sb(),Te.Tb(2,"wj-menu",2,3),Te.bc("itemClicked",(function(){Te.vc(n);var e=Te.sc(3),i=Te.sc(1);return t.folderMenuClick(e,i)})),Te.Tb(4,"wj-menu-item",4),Te.Ec(5,"New Folder"),Te.Sb(),Te.Tb(6,"wj-menu-item",5),Te.Ec(7,"New Script"),Te.Sb(),Te.Tb(8,"wj-menu-item",6),Te.Ec(9,"New Page"),Te.Sb(),Te.Tb(10,"wj-menu-item",7),Te.Ec(11,"New SQL Query"),Te.Sb(),Te.Tb(12,"wj-menu-item",8),Te.Ec(13,"New Rest"),Te.Sb(),Te.Tb(14,"wj-menu-item",9),Te.Ec(15,"New JSON"),Te.Sb(),Te.Ob(16,"wj-menu-separator"),Te.Tb(17,"wj-menu-item",10),Te.Ec(18,"Rename Folder"),Te.Sb(),Te.Tb(19,"wj-menu-item",11),Te.Ec(20,"Delete Folder"),Te.Sb(),Te.Sb(),Te.Tb(21,"wj-menu",2,12),Te.bc("itemClicked",(function(){Te.vc(n);var e=Te.sc(22),i=Te.sc(1);return t.fileMenuClick(e,i)})),Te.Tb(23,"wj-menu-item",10),Te.Ec(24,"Rename"),Te.Sb(),Te.Ob(25,"wj-menu-separator"),Te.Tb(26,"wj-menu-item",11),Te.Ec(27,"Delete File"),Te.Sb(),Te.Sb()}2&e&&Te.jc("itemsSource",t.links)("isReadOnly",!0===t.isReadOnly)("allowDragging",!0)},directives:[s.b,o.k,l.d,l.e,l.f],styles:['@charset "UTF-8";[_ngcontent-%COMP%]:root{--bg:#fff;--body-bg:#e4e5e6;--header-bg:#ebedef;--color:#4f5d73;--border-color:#c4c9d0;--wj-alt:#f7f7f7;--form-input-bg:#fff;--form-input-color:#768192;--nav-link-color:#8a93a2;--secondary-color:#c4c9d0;--opacity:0.05;--hover:"#f0f3f5"}wj-tree-view.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-node-text{min-width:20px}wj-tree-view.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-node.error{border:1px solid #e55353}wj-tree-view.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-node.error:before{visibility:hidden}wj-tree-view.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-node.error .wj-node-text{position:relative}wj-tree-view.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-node.error .wj-node-text:after{color:#e55353;content:"\uf071";font-family:FontAwesome;position:absolute;right:-1.25rem;top:0}wj-tree-view.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-node.error .fa{visibility:hidden}.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-node{font-size:.85rem}.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-node .fa{font-size:.75rem}.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-nodelist>.wj-node, .vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-nodelist>.wj-nodelist{border-left:1px solid var(--border-color)}.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist .wj-node:not(.wj-state-empty):before{border:none;content:"\uf107";font-family:FontAwesome;font-size:1.5rem;font-size:1.25rem;left:-2px;line-height:10px;opacity:.8;top:2px;transition:all .3s cubic-bezier(.4,0,.2,1)}.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist .wj-node.wj-state-empty:before{display:none}.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-node.wj-state-selected{background:var(--border-color)}']}),e}(),$i=n("Ji7U"),zi=n("LK+K"),_i=n("1OyB"),Li=n("vuIU"),Ui=n("yCtX"),Qi=n("DH7j"),Hi=n("7o/Q"),Vi=n("Lhse"),Ji=n("zx2A"),Xi=function(){function e(t){Object(_i.a)(this,e),this.resultSelector=t}return Object(Li.a)(e,[{key:"call",value:function(e,t){return t.subscribe(new Gi(e,this.resultSelector))}}]),e}(),Gi=function(e){Object($i.a)(n,e);var t=Object(zi.a)(n);function n(e,i){var o;return arguments.length>2&&void 0!==arguments[2]||Object.create(null),Object(_i.a)(this,n),(o=t.call(this,e)).resultSelector=i,o.iterators=[],o.active=0,o.resultSelector="function"==typeof i?i:void 0,o}return Object(Li.a)(n,[{key:"_next",value:function(e){var t=this.iterators;Object(Qi.a)(e)?t.push(new Wi(e)):t.push("function"==typeof e[Vi.a]?new Ki(e[Vi.a]()):new Zi(this.destination,this,e))}},{key:"_complete",value:function(){var e=this.iterators,t=e.length;if(this.unsubscribe(),0!==t){this.active=t;for(var n=0;n<t;n++){var i=e[n];i.stillUnsubscribed?this.destination.add(i.subscribe()):this.active--}}else this.destination.complete()}},{key:"notifyInactive",value:function(){this.active--,0===this.active&&this.destination.complete()}},{key:"checkIterators",value:function(){for(var e=this.iterators,t=e.length,n=this.destination,i=0;i<t;i++){var o=e[i];if("function"==typeof o.hasValue&&!o.hasValue())return}for(var r=!1,c=[],a=0;a<t;a++){var s=e[a],l=s.next();if(s.hasCompleted()&&(r=!0),l.done)return void n.complete();c.push(l.value)}this.resultSelector?this._tryresultSelector(c):n.next(c),r&&n.complete()}},{key:"_tryresultSelector",value:function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),n}(Hi.a),Ki=function(){function e(t){Object(_i.a)(this,e),this.iterator=t,this.nextResult=t.next()}return Object(Li.a)(e,[{key:"hasValue",value:function(){return!0}},{key:"next",value:function(){var e=this.nextResult;return this.nextResult=this.iterator.next(),e}},{key:"hasCompleted",value:function(){var e=this.nextResult;return Boolean(e&&e.done)}}]),e}(),Wi=function(){function e(t){Object(_i.a)(this,e),this.array=t,this.index=0,this.length=0,this.length=t.length}return Object(Li.a)(e,[{key:Vi.a,value:function(){return this}},{key:"next",value:function(e){var t=this.index++;return t<this.length?{value:this.array[t],done:!1}:{value:null,done:!0}}},{key:"hasValue",value:function(){return this.array.length>this.index}},{key:"hasCompleted",value:function(){return this.array.length===this.index}}]),e}(),Zi=function(e){Object($i.a)(n,e);var t=Object(zi.a)(n);function n(e,i,o){var r;return Object(_i.a)(this,n),(r=t.call(this,e)).parent=i,r.observable=o,r.stillUnsubscribed=!0,r.buffer=[],r.isComplete=!1,r}return Object(Li.a)(n,[{key:Vi.a,value:function(){return this}},{key:"next",value:function(){var e=this.buffer;return 0===e.length&&this.isComplete?{value:null,done:!0}:{value:e.shift(),done:!1}}},{key:"hasValue",value:function(){return this.buffer.length>0}},{key:"hasCompleted",value:function(){return 0===this.buffer.length&&this.isComplete}},{key:"notifyComplete",value:function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()}},{key:"notifyNext",value:function(e){this.buffer.push(e),this.parent.checkIterators()}},{key:"subscribe",value:function(){return Object(Ji.c)(this.observable,new Ji.a(this))}}]),n}(Ji.b),Yi=function(){function e(e,t,n,i,o,r){this.dbService=e,this.notificationService=t,this.store=n,this.actions$=i,this.router=o,this.route=r,this.connections=[],this.destroy$=new $e.a,this.loadConnection=this._loadConnection.bind(this)}return e.prototype.ngOnInit=function(){var e=this;this.connections$=this.store.select(Se).pipe(Object(oe.a)((function(e){return e.map((function(e){return{label:e.connectionName,children:[],data:e}}))})),Object(Ee.a)((function(t){return e.connections=t}))),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[t.length-1];return"function"==typeof i&&t.pop(),Object(Ui.a)(t,void 0).lift(new Xi(i))}(this.connections$.pipe(Object(ce.a)((function(e){return Boolean(null==e?void 0:e.length)})),Object(Fe.a)(1)),this.store.select(we),this.store.select(me)).pipe(Object(ze.a)(this.destroy$)).subscribe((function(t){var n,i,o,r,c=t[1],a=t[2],s=null==a?void 0:a.info;if((null==a?void 0:a.tabType)===X.a.DB){e.tree.selectedItem=void 0;var l=Object(d.e)(e.tree.itemsSource,"children").find((function(e){return Object(H.a)(e.data,s)}));l||(l=null===(n=e.tree.itemsSource)||void 0===n?void 0:n.find((function(e){return e.data.connectionName===c.connectionName})),e.select=s),l&&l!==e.tree.selectedItem&&(e.tree.selectedItem=l,e.select&&(null===(i=e.tree.selectedNode)||void 0===i||i.element.click()))}else c?(e.tree.selectedItem=null===(o=e.tree.itemsSource)||void 0===o?void 0:o.find((function(e){return e.data.connectionName===c.connectionName})),null===(r=e.tree.selectedNode)||void 0===r||r.element.click()):e.tree.selectedItem=null})),this.actions$.pipe(Object(c.e)(R),Object(ze.a)(this.destroy$)).subscribe((function(t){var n=t.link,i=e.tree.selectedNode.dataItem;Object(H.a)(i.data,n)&&(e.tree.selectedNode.remove(),e.tree.selectedItem=void 0)})),this.actions$.pipe(Object(c.e)(F),Object(ze.a)(this.destroy$)).subscribe((function(){e.store.dispatch(_())}))},e.prototype._loadConnection=function(e,t){return Object(h.b)(this,void 0,void 0,(function(){var n,i,o,r,c,a,s=this;return Object(h.e)(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,this.dbService.getObjects(e.dataItem.data.connectionName).toPromise()];case 1:return n=l.sent(),i=Object(Pi.groupBy)(n,"objectType"),o=i.map((function(t){return{label:t[0].objectType,children:t.map((function(t){return{label:t.schemaName+"."+t.objectName,data:{sqlObject:t,connection:e.dataItem.data}}}))}})),t(o),this.select&&(r=Object(d.e)(this.tree.itemsSource,"children"),c=r.find((function(e){return Object(H.a)(e.data,s.select)})),this.tree.selectedItem=c,this.select=null),[3,3];case 2:return a=l.sent(),this.notificationService.error(a),t(),[3,3];case 3:return[2]}}))}))},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.onSelect=function(e){if(!e.selectedItem.children&&e.selectedItem.data){var t=e.selectedItem.data,n=t.connection,i=t.sqlObject,o=this.route.snapshot.queryParams.tab;this.router.navigate([],{relativeTo:this.route,queryParams:{connection:Object(H.f)(n,i),tab:o}})}},e.prototype.formatItem=function(e){var t,n;n=0===e.level?"fa-database":e.dataItem.children?"fa-folder-o":((t={})[Ne.DbObjectType.Table]="fa-table",t[Ne.DbObjectType.View]="fa-file-text-o",t)[e.dataItem.data.objectType],e.element.innerHTML='<i class="fa '+n+'"></i> '+e.element.innerHTML},e.\u0275fac=function(t){return new(t||e)(Te.Nb(le.f),Te.Nb(le.e),Te.Nb(r.h),Te.Nb(c.a),Te.Nb(Ie.f),Te.Nb(Ie.a))},e.\u0275cmp=Te.Hb({type:e,selectors:[["app-db-tree"]],viewQuery:function(e,t){var n;1&e&&Te.Ac(s.b,!0),2&e&&Te.rc(n=Te.cc())&&(t.tree=n.first)},inputs:{appInfo:"appInfo"},decls:2,vars:3,consts:[["ngClass","vs-tree","displayMemberPath","label","childItemsPath","children",1,"p-2",3,"itemsSource","lazyLoadFunction","isReadOnly","itemClicked","formatItem"],["treeview",""]],template:function(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"wj-tree-view",0,1),Te.bc("itemClicked",(function(){Te.vc(n);var e=Te.sc(1);return t.onSelect(e)}))("formatItem",(function(e){return t.formatItem(e)})),Te.Sb()}2&e&&Te.jc("itemsSource",t.connections)("lazyLoadFunction",t.loadConnection)("isReadOnly",!1)},directives:[s.b,o.k],styles:['@charset "UTF-8";[_ngcontent-%COMP%]:root{--bg:#fff;--body-bg:#e4e5e6;--header-bg:#ebedef;--color:#4f5d73;--border-color:#c4c9d0;--wj-alt:#f7f7f7;--form-input-bg:#fff;--form-input-color:#768192;--nav-link-color:#8a93a2;--secondary-color:#c4c9d0;--opacity:0.05;--hover:"#f0f3f5"}wj-tree-view.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-node-text{min-width:20px}wj-tree-view.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-node.error{border:1px solid #e55353}wj-tree-view.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-node.error:before{visibility:hidden}wj-tree-view.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-node.error .wj-node-text{position:relative}wj-tree-view.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-node.error .wj-node-text:after{color:#e55353;content:"\uf071";font-family:FontAwesome;position:absolute;right:-1.25rem;top:0}wj-tree-view.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-node.error .fa{visibility:hidden}.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-node{font-size:.85rem}.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-node .fa{font-size:.75rem}.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-nodelist>.wj-node, .vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist>.wj-nodelist>.wj-nodelist{border-left:1px solid var(--border-color)}.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist .wj-node:not(.wj-state-empty):before{border:none;content:"\uf107";font-family:FontAwesome;font-size:1.5rem;font-size:1.25rem;left:-2px;line-height:10px;opacity:.8;top:2px;transition:all .3s cubic-bezier(.4,0,.2,1)}.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-nodelist .wj-node.wj-state-empty:before{display:none}.vs-tree.wj-treeview[_ngcontent-%COMP%]     .wj-node.wj-state-selected{background:var(--border-color)}']}),e}();function eo(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"a",24),Te.bc("click",(function(){return Te.vc(n),Te.dc(3).onSelect(null)})),Te.Ob(1,"i",25),Te.Ec(2," User Files "),Te.Sb()}}function to(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"a",26),Te.bc("click",(function(){Te.vc(n);var e=t.$implicit;return Te.dc(3).onSelect(e)})),Te.Ob(1,"i",27),Te.Ec(2),Te.Sb()}if(2&e){var i=t.$implicit;Te.kc("title",i.title),Te.Bb(2),Te.Hc(" ",i.appName," (",i.ownerName,") ")}}function no(e,t){if(1&e&&(Te.Tb(0,"div",21),Te.Cc(1,eo,3,0,"a",22),Te.Cc(2,to,3,3,"a",23),Te.Sb()),2&e){var n=Te.dc(2);Te.Bb(1),Te.jc("ngIf",null==n.app?null:n.app.appName),Te.Bb(1),Te.jc("ngForOf",n.customApps)}}function io(e,t){if(1&e&&(Te.Tb(0,"span",18),Te.Tb(1,"h3",19),Te.bc("click",(function(){return!1})),Te.Ec(2),Te.Ob(3,"i",5),Te.Sb(),Te.Cc(4,no,3,2,"div",20),Te.Sb()),2&e){var n=Te.dc();Te.Bb(2),Te.Gc("",(null==n.app?null:n.app.appName)||"User Files"," ")}}function oo(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"a",32),Te.bc("click",(function(){return Te.vc(n),Te.dc(2).createApp()})),Te.Ec(1,"Create new Application"),Te.Sb()}}function ro(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"a",32),Te.bc("click",(function(){return Te.vc(n),Te.dc(2).editApp()})),Te.Ec(1,"Edit Application"),Te.Sb()}}function co(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"a",32),Te.bc("click",(function(){return Te.vc(n),Te.dc(2).downloadApp()})),Te.Ec(1,"Download App"),Te.Sb()}}function ao(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"a",32),Te.bc("click",(function(){return Te.vc(n),Te.dc(2).downloadApp()})),Te.Ec(1,"Download Files"),Te.Sb()}}function so(e,t){if(1&e){var n=Te.Ub();Te.Rb(0),Te.Tb(1,"a",32),Te.bc("click",(function(){return Te.vc(n),Te.dc(2),Te.sc(17).createContentFile("new-folder",null,!0)})),Te.Ec(2,"Create Folder"),Te.Sb(),Te.Tb(3,"a",32),Te.bc("click",(function(){return Te.vc(n),Te.dc(2),Te.sc(17).createContentFile("new-script","jspy",!0)})),Te.Ec(4,"New Script"),Te.Sb(),Te.Tb(5,"a",32),Te.bc("click",(function(){return Te.vc(n),Te.dc(2),Te.sc(17).createContentFile("new-page","page.xml",!0)})),Te.Ec(6,"New Page"),Te.Sb(),Te.Tb(7,"a",32),Te.bc("click",(function(){return Te.vc(n),Te.dc(2),Te.sc(17).createContentFile("new-sql","sql",!0)})),Te.Ec(8,"New SQL Query"),Te.Sb(),Te.Tb(9,"a",32),Te.bc("click",(function(){return Te.vc(n),Te.dc(2),Te.sc(17).createContentFile("new-rest","rest",!0)})),Te.Ec(10,"New Rest"),Te.Sb(),Te.Tb(11,"a",32),Te.bc("click",(function(){return Te.vc(n),Te.dc(2),Te.sc(17).createContentFile("new-json","json",!0)})),Te.Ec(12,"New JSON"),Te.Sb(),Te.Tb(13,"a",32),Te.bc("click",(function(){return Te.vc(n),Te.dc(2),Te.sc(17).createContentFile("new-query","query",!0)})),Te.Ec(14,"New Query"),Te.Sb(),Te.Ob(15,"li",30),Te.Qb()}}function lo(e,t){if(1&e){var n=Te.Ub();Te.Rb(0),Te.Tb(1,"a",32),Te.bc("click",(function(e){return Te.vc(n),Te.dc(2).createTable(e)})),Te.Ec(2,"Create DB Table"),Te.Sb(),Te.Tb(3,"a",32),Te.bc("click",(function(e){return Te.vc(n),Te.dc(2).createSqlQuery(e)})),Te.Ec(4,"Create DB View/Procedure"),Te.Sb(),Te.Qb()}}function uo(e,t){if(1&e&&(Te.Tb(0,"div",28),Te.Cc(1,oo,2,0,"a",29),Te.Cc(2,ro,2,0,"a",29),Te.Cc(3,co,2,0,"a",29),Te.Cc(4,ao,2,0,"a",29),Te.Ob(5,"li",30),Te.Cc(6,so,16,0,"ng-container",31),Te.Cc(7,lo,5,0,"ng-container",31),Te.Sb()),2&e){var n=Te.dc();Te.Bb(1),Te.jc("ngIf",n.isAuthenticated),Te.Bb(1),Te.jc("ngIf",n.app&&!n.isReadOnly),Te.Bb(1),Te.jc("ngIf",n.app),Te.Bb(1),Te.jc("ngIf",!n.app),Te.Bb(2),Te.jc("ngIf",!n.isReadOnly),Te.Bb(1),Te.jc("ngIf",n.isAuthenticated)}}function po(e,t){if(1&e){var n=Te.Ub();Te.Tb(0,"as-split-area",33,34),Te.Tb(2,"div",11),Te.Tb(3,"div",35),Te.Tb(4,"h5",36),Te.bc("click",(function(){return Te.vc(n),Te.dc().toggleConnection()})),Te.Ec(5,"CONNECTION"),Te.Sb(),Te.Tb(6,"span",37),Te.bc("click",(function(e){return Te.vc(n),Te.dc().refresh(e)})),Te.Ob(7,"i",38),Te.Sb(),Te.Sb(),Te.Tb(8,"div",14),Te.Ob(9,"app-db-tree"),Te.Sb(),Te.Sb(),Te.Sb()}}var bo="code-sidebar-files-size",fo=function(){function e(e,t,n,i,o,r,c){this.store=e,this.router=t,this.route=n,this.dialogService=i,this.appService=o,this.authService=r,this.container=c,this.defaultAppInfo=Ai.b,this.hasContentToSave=!1,this.isAuthenticated=!1,this.topContentSize=200,this.collapsed=!1,this.destroy=new $e.a}return Object.defineProperty(e.prototype,"isReadOnly",{get:function(){var e;return(null===(e=this.appService.appContentService)||void 0===e?void 0:e.source)===Pe.b.FROM_FILE},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.appService.myApps$.subscribe((function(t){e.customApps=t})),this.appService.currentApp$.subscribe((function(t){e.app=t})),this.topContentSize=mt.a.settingsVariables[bo]||this.container.element.nativeElement.offsetHeight/2,this.authService.isAuthenticated$.subscribe((function(t){var n;e.isAuthenticated=t,t?(e.store.dispatch(_()),(null===(n=e.customApps)||void 0===n?void 0:n.length)||e.store.dispatch(v()),e.getCurrentPath()===Pe.b.FILES&&e.store.dispatch(C())):e.customApps=[]})),this.store.select(je).subscribe((function(t){e.contentsToSave=t,e.hasContentToSave=Boolean(t&&t.length)})),this.store.select(Se).subscribe((function(t){e.connections=t})),this.store.select(he).pipe(Object(oe.a)((function(e){return Object(Pi.groupBy)(e||[],"contentType").reduce((function(e,t){return e[t[0].contentType]=t.map((function(e){return Object(qe.b)(e)})),e}),{})}))).subscribe((function(t){e.scripts=t[Pe.a.SCRIPT]||[],e.shells=t[Pe.a.SHELL]||[]})),this.route.firstChild&&this.getCurrentPath()!==Pe.b.FROM_FILE&&this.onAppSelect(this.route.firstChild.snapshot.params),this.router.events.pipe(Object(ze.a)(this.destroy),Object(ce.a)((function(t){return Boolean(t instanceof Ie.c)&&e.getCurrentPath()!==Pe.b.FROM_FILE})),Object(oe.a)((function(){var t;return null===(t=e.route.firstChild)||void 0===t?void 0:t.snapshot.params}))).subscribe((function(t){e.onAppSelect(t)}))},e.prototype.downloadApp=function(){this.appService.downloadLinks(this.isAuthenticated?this.filesTree.links:Object(H.g)(this.contentsToSave))},e.prototype.editApp=function(){var e=this;if(this.app){this.store.dispatch(m({app:this.app}));var t=this.dialogService.open(qi.a,{class:"modal-xl full-height"});t.config={appInfo:this.app,scripts:this.scripts,shells:this.shells},t.init.subscribe((function(){t.component.save.pipe(Object(ie.a)((function(t){return e.appService.saveAppInfo(t.appInfo).pipe(Object(Ee.a)((function(){return e.app=t.appInfo})))}))).toPromise(),t.component.delete.pipe(Object(ie.a)((function(t){return e.appService.deleteApp(t)}))).subscribe((function(){e.store.dispatch(v()),e.router.navigate(["/code"]),e.app=null,e.store.dispatch(M()),e.store.dispatch(I({}))}))}))}},e.prototype.createApp=function(){var e=this,t=this.dialogService.open(qi.a,{class:"modal-xl full-height"});t.config={appInfo:Object(h.a)(Object(h.a)({},this.defaultAppInfo),{ownerName:this.authService.user.userName})},t.init.pipe(Object(ie.a)((function(){return t.component.save})),Object(ie.a)((function(t){var n=t.appInfo,i=t.permissionsToSave;return e.appService.saveAppInfo(n).pipe(Object(oe.a)((function(e){return Object(h.a)(Object(h.a)({},n),{appId:e,permissions:i})})))}))).subscribe((function(t){t.permissions&&t.permissions.forEach((function(n){n.appId=t.appId,e.appService.saveAppPermission(n).toPromise()})),e.store.dispatch(v()),e.router.navigate(["code",t.ownerName,t.appName])}))},e.prototype.onSelect=function(e){var t=this;this.hasContentToSave?this.dialogService.confirmation("Not all changes are saved. Continue?").subscribe((function(n){n&&t.router.navigate(e?["code",e.ownerName,e.appName]:["code"])})):this.router.navigate(e?["code",e.ownerName,e.appName]:["code"])},e.prototype.createSqlQuery=function(e){e.preventDefault(),e.stopImmediatePropagation(),this.store.dispatch(E({tabType:X.a.SQLQuery,app:null,info:this.connections})),this.router.navigate([],{relativeTo:this.route,queryParams:{}})},e.prototype.createTable=function(e){e.preventDefault(),e.stopImmediatePropagation();var t=this.connections[0];this.router.navigate([],{relativeTo:this.route,queryParams:{connection:Object(H.f)(t,{objectName:"",schemaName:t.defaultSchema,objectType:Ne.DbObjectType.Table})}})},e.prototype.import=function(e){var t=this;e.preventDefault(),e.stopImmediatePropagation();var n=this.dialogService.open(De.a,{class:"modal-xl full-height",keyboard:!1});n.config={connections:this.connections,connection:null},n.init.pipe(Object(ie.a)((function(){return n.component.import}))).subscribe((function(e){e.newTable&&t.store.dispatch(_())}))},e.prototype.refresh=function(e){e.preventDefault(),e.stopImmediatePropagation(),this.store.dispatch(_())},e.prototype.ngOnDestroy=function(){this.destroy.next(),this.destroy.complete()},e.prototype.compareApps=function(e,t){return e&&t&&e.appName===t.appName&&e.ownerName===t.ownerName},e.prototype.resize=function(e){e&&e.sizes&&mt.a.setSettingsVariable(bo,e.sizes[0])},e.prototype.toggleExplorer=function(){this.collapsed?(this.collapsed=!1,this.topContentSize=this.container.element.nativeElement.offsetHeight/2):(this.collapsed=!0,this.topContentSize=40)},e.prototype.toggleConnection=function(){this.collapsed?(this.collapsed=!1,this.topContentSize=this.container.element.nativeElement.offsetHeight/2):(this.collapsed=!0,this.topContentSize=this.container.element.nativeElement.offsetHeight-90)},e.prototype.getCurrentPath=function(){var e,t=null===(e=this.route.firstChild)||void 0===e?void 0:e.snapshot.url;return 2===(null==t?void 0:t.length)?Pe.b.APP:1===t.length&&t[0].path===Pe.b.FROM_FILE?Pe.b.FROM_FILE:Pe.b.FILES},e.prototype.onAppSelect=function(e){(null==e?void 0:e.appName)?this.app&&this.app.appName===(null==e?void 0:e.appName)&&this.app.ownerName===(null==e?void 0:e.ownerName)?this.app.appName===(null==e?void 0:e.appName)&&this.app.ownerName===(null==e?void 0:e.ownerName)||(this.store.dispatch(y({app:this.app,links:[]})),this.store.dispatch(j())):(this.store.dispatch(M()),this.store.dispatch(I({})),this.store.dispatch(m({app:e}))):this.app&&(this.store.dispatch(M()),this.store.dispatch(I({})),this.appService.reset(),this.store.dispatch(C()))},e.\u0275fac=function(t){return new(t||e)(Te.Nb(r.h),Te.Nb(Ie.f),Te.Nb(Ie.a),Te.Nb(le.b),Te.Nb(ue.a),Te.Nb(Ae.b),Te.Nb(Te.R))},e.\u0275cmp=Te.Hb({type:e,selectors:[["app-code-sidebar"]],viewQuery:function(e,t){var n;1&e&&Te.Ac(Ri,!0),2&e&&Te.rc(n=Te.cc())&&(t.filesTree=n.first)},decls:19,vars:7,consts:[[1,"mb-1","d-flex"],["class","ml-2 dropdown","dropdown","",4,"ngIf"],["dropdown","","placement","bottom right",1,"dropdown","ml-auto"],["id","add-btn-dropdown","data-toggle","dropdown","role","button","aria-haspopup","true","aria-expanded","false","dropdownToggle","","aria-controls","add-dropdown",1,"btn","btn-primary","btn-sm",3,"click"],[1,"fa","fa-plus"],[1,"fa","fa-caret-down","ml-1"],["id","add-dropdown","class","dropdown-menu dropdown-menu-right","aria-labelledby","add-btn-dropdown",4,"dropdownMenu"],[1,"d-flex","flex-column","overflow-hidden","h-100"],["direction","vertical","unit","pixel",3,"useTransition","gutterSize","dragEnd","transitionEnd"],[1,"d-flex","mb-0","position-relative",3,"size"],["area0","asSplitArea"],[1,"card","w-100","h-100","m-0"],[1,"card-header","p-2","d-flex"],[1,"m-0","flex-fill","cursor-pointer",3,"click"],[1,"card-body","p-0","overflow-auto"],[3,"isReadOnly","appInfo"],["tree",""],["size","*","class","d-flex overflow-auto flex-column explorer-section position-relative",4,"ngIf"],["dropdown","",1,"ml-2","dropdown"],["data-toggle","dropdown","role","button","aria-haspopup","true","aria-expanded","false","dropdownToggle","",1,"my-0","cursor-pointer",3,"click"],["class","dropdown-menu","aria-labelledby","apps-dropdown",4,"dropdownMenu"],["aria-labelledby","apps-dropdown",1,"dropdown-menu"],["class","dropdown-item","title","User Files",3,"click",4,"ngIf"],["class","dropdown-item",3,"title","click",4,"ngFor","ngForOf"],["title","User Files",1,"dropdown-item",3,"click"],[1,"fa","fa-files-o"],[1,"dropdown-item",3,"title","click"],[1,"fa","fa-play"],["id","add-dropdown","aria-labelledby","add-btn-dropdown",1,"dropdown-menu","dropdown-menu-right"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"divider","dropdown-divider"],[4,"ngIf"],[1,"dropdown-item",3,"click"],["size","*",1,"d-flex","overflow-auto","flex-column","explorer-section","position-relative"],["area1","asSplitArea"],[1,"card-header","px-2","py-1","d-flex"],[1,"m-0","align-self-center","flex-fill","cursor-pointer",3,"click"],[1,"mx-1","align-self-center","action","my-0","p-1","cursor-pointer",3,"click"],["title","Refresh connections",1,"fa","fa-refresh"]],template:function(e,t){1&e&&(Te.Tb(0,"div",0),Te.Cc(1,io,5,1,"span",1),Te.Tb(2,"div",2),Te.Tb(3,"button",3),Te.bc("click",(function(){return!1})),Te.Ob(4,"i",4),Te.Ob(5,"i",5),Te.Sb(),Te.Cc(6,uo,8,6,"div",6),Te.Sb(),Te.Sb(),Te.Tb(7,"div",7),Te.Tb(8,"as-split",8),Te.bc("dragEnd",(function(e){return t.resize(e)}))("transitionEnd",(function(e){return t.resize(e)})),Te.Tb(9,"as-split-area",9,10),Te.Tb(11,"div",11),Te.Tb(12,"div",12),Te.Tb(13,"h5",13),Te.bc("click",(function(){return t.toggleExplorer()})),Te.Ec(14,"EXPLORER"),Te.Sb(),Te.Sb(),Te.Tb(15,"div",14),Te.Ob(16,"app-tree",15,16),Te.Sb(),Te.Sb(),Te.Sb(),Te.Cc(18,po,10,0,"as-split-area",17),Te.Sb(),Te.Sb()),2&e&&(Te.Bb(1),Te.jc("ngIf",t.isAuthenticated),Te.Bb(7),Te.jc("useTransition",!0)("gutterSize",t.collapsed?0:11),Te.Bb(1),Te.jc("size",t.topContentSize),Te.Bb(7),Te.jc("isReadOnly",t.isReadOnly)("appInfo",t.app),Te.Bb(2),Te.jc("ngIf",t.isAuthenticated))},directives:[o.m,Ge.a,Ge.d,Ge.b,Ke.c,Ke.b,Ri,o.l,Yi],styles:["span.disabled[_ngcontent-%COMP%]{opacity:.5}.files-panel[_ngcontent-%COMP%]     .panel.card{height:100%}.files-panel[_ngcontent-%COMP%]     .panel-title .accordion-toggle>button{color:var(--color);padding-left:.5rem;text-decoration:none}.files-panel[_ngcontent-%COMP%]     .panel-body.card-block.card-body{padding:0}.files-panel[_ngcontent-%COMP%]     .panel-collapse.collapse.in.show{overflow:auto!important}.files-panel[_ngcontent-%COMP%]     app-tree{min-height:100px;display:block}.files-panel.panel-open[_ngcontent-%COMP%]{flex:1 1 auto}.files-panel[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{margin-bottom:8px}.files-panel[_ngcontent-%COMP%]   .fa.fa-folder-o[_ngcontent-%COMP%]{margin-left:-7px;position:absolute;top:11px}.files-panel[_ngcontent-%COMP%]   .fa.fa-file-o[_ngcontent-%COMP%]{margin-left:-6px;position:absolute;top:9px}accordion[_ngcontent-%COMP%]     .accordion-toggle{display:flex}accordion[_ngcontent-%COMP%]     .panel.card{margin-bottom:1px}"]}),e}(),ho=n("IzEk"),vo=n("wuWQ"),go=function(){function e(e,t,n,i){this.store=e,this.router=t,this.appService=n,this.fromApi=i}return e.prototype.canActivate=function(e,t){var n=this,i=e.params;return this.fromApi.init(i.ownerName,i.appName),this.appService.appContentService=this.fromApi,this.store.dispatch(v()),this.store.select(pe).pipe(Object(ce.a)((function(e){return void 0!==e})),Object(oe.a)((function(e){return!(i||!(null==e?void 0:e.length))||!i||!!(null==e?void 0:e.some((function(e){return e.ownerName===i.ownerName&&e.appName===i.appName})))||void n.router.navigate(["code"])})),Object(ho.a)(1))},e.\u0275fac=function(t){return new(t||e)(Te.Xb(r.h),Te.Xb(Ie.f),Te.Xb(ue.a),Te.Xb(vo.a))},e.\u0275prov=Te.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),mo=function(){function e(e,t,n){this.router=e,this.authService=t,this.loginService=n}return e.prototype.canActivate=function(e,t){var n=this;return this.authService.isAuthenticated$.pipe(Object(oe.a)((function(t){return e.queryParams.connection&&!t&&n.loginService.openDialog(),!0})))},e.\u0275fac=function(t){return new(t||e)(Te.Xb(Ie.f),Te.Xb(Ae.b),Te.Xb(Ae.c))},e.\u0275prov=Te.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),jo=function(){function e(e,t){this.router=e,this.authService=t}return e.prototype.canActivate=function(e,t){var n=this;return this.authService.isAuthenticated$.pipe(Object(oe.a)((function(t){return t&&n.router.navigate(["/code",n.authService.user.userName],{queryParams:e.queryParams}),!0})))},e.\u0275fac=function(t){return new(t||e)(Te.Xb(Ie.f),Te.Xb(Ae.b))},e.\u0275prov=Te.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),yo=function(){function e(e,t,n,i){this.router=e,this.authService=t,this.loginService=n,this.notificationService=i}return e.prototype.canActivate=function(e,t){var n=this,i=e.params.ownerName;return this.authService.isAuthenticated$.pipe(Object(oe.a)((function(t){if(t){var o=n.authService.user.userName;i!==o&&(e.queryParams.file||e.queryParams.connection||(n.notificationService.error(null,"You are not allowed to access "+i+" folder!"),n.router.navigate(["code",o])))}else e.queryParams.file||e.queryParams.connection||i&&(n.notificationService.error(null,"Login as "+i+" to access this folder!"),n.loginService.openDialog());return!0})))},e.\u0275fac=function(t){return new(t||e)(Te.Xb(Ie.f),Te.Xb(Ae.b),Te.Xb(Ae.c),Te.Xb(le.e))},e.\u0275prov=Te.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),Oo=n("Ibwl"),So=function(){function e(e,t,n,i){this.store=e,this.router=t,this.appService=n,this.fromFile=i}return e.prototype.canActivate=function(e,t){var n=this,i=e.queryParams;return i.source?(this.fromFile.init(i.source),this.appService.appContentService=this.fromFile,this.appService.getAppInfo().pipe(Object(oe.a)((function(e){return n.store.dispatch(y({app:e,links:[]})),n.store.dispatch(j()),!0})),Object(re.a)((function(e){return n.router.navigate(["/code"])})))):this.router.navigate(["/code"])},e.\u0275fac=function(t){return new(t||e)(Te.Xb(r.h),Te.Xb(Ie.f),Te.Xb(ue.a),Te.Xb(Oo.a))},e.\u0275prov=Te.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}(),wo=[{path:"",component:Ni,canActivate:[mo],children:[{path:"",component:fo,children:[{path:"",canActivate:[jo]},{path:"fromFileApi",canActivate:[So]},{path:":ownerName",canActivate:[yo]},{path:":ownerName/:appName",canActivate:[go]}]}]}],Co=function(){function e(){}return e.\u0275mod=Te.Lb({type:e}),e.\u0275inj=Te.Kb({factory:function(t){return new(t||e)},providers:[go,So],imports:[[Ie.i.forChild(wo)],Ie.i]}),e}(),To=function(){function e(e,t,n,i,o,r,a,s){var l=this;this.actions$=e,this.dbService=t,this.notificationService=n,this.connectionsService=i,this.codeService=o,this.store=r,this.router=a,this.route=s,this.loadConnections$=Object(c.d)((function(){return l.actions$.pipe(Object(c.e)(_),Object(ie.a)((function(){return l.connectionsService.loadMyDbConnections().pipe(Object(oe.a)((function(e){return L({connections:e})})),Object(re.a)((function(e){return l.notificationService.error(e),ne.a})))})))})),this.saveAppContent$=Object(c.d)((function(){return l.actions$.pipe(Object(c.e)(A),Object(ae.a)(l.store.select(be),l.store.select(je)),Object(ie.a)((function(e){var t=e[1],n=e[2];return Object(ee.a)((n||[]).map((function(e){return l.codeService.saveContent(t,e).pipe(Object(oe.a)((function(){return{app:null==t?void 0:t.app,link:e}})),Object(re.a)((function(t){return Object(te.a)({link:e,error:t.message})})))}))).pipe(Object(ie.a)((function(){l.notificationService.success("Saved app contents");var e=[B()];return t&&n.find((function(e){return e.name+"."+e.contentType===Ai.a.app}))&&e.push(m({app:t.app})),e})),Object(re.a)((function(e){return l.notificationService.error(null,e.error+" ("+Object(qe.b)(e.link)+")"),Object(Y.a)($(e))})))})))})),this.saveDbTables$=Object(c.d)((function(){return l.actions$.pipe(Object(c.e)(D),Object(ae.a)(l.store.select(ye)),Object(ie.a)((function(e){var t=e[1];return Object(ee.a)(Object.values(t).map((function(e){return e.structure.objectType===Ne.DbObjectType.Table?l.saveTable(e):l.saveView(e)}))).pipe(Object(ie.a)((function(){l.notificationService.success("Saved tables");var e=Object.values(t).filter((function(e){return e.structureChange})),n=e.map((function(e){return Object(H.f)(e.connection,e.structureChange)}));return[z({changes:e}),F({keys:Object(h.g)(Object.keys(t),n)})]})),Object(re.a)((function(e){return l.notificationService.error(e,"Failed to save app content."),Object(Y.a)({type:"[Code Tabs] failed to save db tables"})})))})))})),this.updateTabTables$=Object(c.d)((function(){return l.actions$.pipe(Object(c.e)(z),Object(ae.a)(l.store.select(me)),Object(oe.a)((function(e){var t=e[0].changes,n=e[1];if(n.tabType===X.a.DB&&n.info.sqlObject&&(null==t?void 0:t.length)){var i=n.info,o=i.connection,r=i.sqlObject;l.router.navigate([],{relativeTo:l.route,queryParams:{connection:Object(H.f)(o,r)},queryParamsHandling:"merge"})}return{type:"Active tab route checked"}})))})),this.closeTabs$=Object(c.d)((function(){return l.actions$.pipe(Object(c.e)(N),Object(oe.a)((function(e){return I({links:e.links.filter((function(e){return e.name}))})})))})),this.openTab$=Object(c.d)((function(){return l.actions$.pipe(Object(c.e)(E),Object(ce.a)((function(e){return e.tabType===X.a.DB})),Object(oe.a)((function(e){return U({connection:e.info.connection})})))}))}return e.prototype.saveTable=function(e){var t=this,n=e.dataChange,i=e.structureChange,o=e.connection,r=e.structure;if(i){var c=(r.schemaName||i.schemaName)+"."+(r.objectName||i.objectName);return n?this.dbService.generateObject(o.connectionName,i,c).pipe(Object(ie.a)((function(){return t.dbService.mergeInData$(o.connectionName,i.schemaName+"."+i.objectName,{tableData:Object(Bt.toTable)(n.data),itemsToDelete:n.dataToDelete})}))):this.dbService.generateObject(o.connectionName,i,c)}if(n){var a=i||r;return this.dbService.mergeInData$(o.connectionName,a.schemaName+"."+a.objectName,{tableData:Object(Bt.toTable)(null==n?void 0:n.data),itemsToDelete:n.dataToDelete})}},e.prototype.saveView=function(e){return this.dbService.generateObject(e.connection.connectionName,e.structure)},e.\u0275fac=function(t){return new(t||e)(Te.Xb(c.a),Te.Xb(le.f),Te.Xb(le.e),Te.Xb(le.a),Te.Xb(xe),Te.Xb(r.h),Te.Xb(Ie.f),Te.Xb(Ie.a))},e.\u0275prov=Te.Jb({token:e,factory:e.\u0275fac}),e}(),xo=n("/IbS"),ko=n("+MQa"),Io=function(){function e(){}return e.\u0275mod=Te.Lb({type:e}),e.\u0275inj=Te.Kb({factory:function(t){return new(t||e)},providers:[Ce.a],imports:[[o.c,i.d,d.c,p.a,Co,xo.DatabaseManagerModule,s.a,l.c,ko.CustomAppModule,u.g,r.j.forRoot(W,{metaReducers:Z,runtimeChecks:{strictStateImmutability:!1,strictActionImmutability:!1}}),c.c.forRoot([ke,To]),a.a.instrument({maxAge:25,logOnly:f.a.production}),b.RestClientModule]]}),e}()}}]);