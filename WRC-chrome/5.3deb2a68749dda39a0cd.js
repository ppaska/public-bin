(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"/IbS":function(e,t,n){"use strict";n.r(t),n.d(t,"DatabaseManagerModule",(function(){return It}));var i=n("ofXK"),o=n("3Pt+"),c=n("kt0X"),a=n("B3rN"),r=n("snw9"),s=n("ODXe"),l=n("vuIU"),b=n("1OyB"),d=n("fXoL"),u=n("tyNb"),f=n("zp1y"),p=function e(){Object(b.a)(this,e)},h=function(){function e(){Object(b.a)(this,e)}return Object(l.a)(e,[{key:"serialize",value:function(e){return{root:this.serializeRoute(e.root),url:e.url}}},{key:"serializeRoute",value:function(e){var t=this,n=e.children.map((function(e){return t.serializeRoute(e)}));return{params:e.params,paramMap:e.paramMap,data:e.data,url:e.url,outlet:e.outlet,routeConfig:e.routeConfig?{component:e.routeConfig.component,path:e.routeConfig.path,pathMatch:e.routeConfig.pathMatch,redirectTo:e.routeConfig.redirectTo,outlet:e.routeConfig.outlet}:null,queryParams:e.queryParams,queryParamMap:e.queryParamMap,fragment:e.fragment,component:e.routeConfig?e.routeConfig.component:void 0,root:void 0,parent:void 0,firstChild:n[0],pathFromRoot:void 0,children:n}}}]),e}(),m=function(){function e(){Object(b.a)(this,e)}return Object(l.a)(e,[{key:"serialize",value:function(e){return{root:this.serializeRoute(e.root),url:e.url}}},{key:"serializeRoute",value:function(e){var t=this,n=e.children.map((function(e){return t.serializeRoute(e)}));return{params:e.params,data:e.data,url:e.url,outlet:e.outlet,routeConfig:e.routeConfig?{path:e.routeConfig.path,pathMatch:e.routeConfig.pathMatch,redirectTo:e.routeConfig.redirectTo,outlet:e.routeConfig.outlet}:null,queryParams:e.queryParams,fragment:e.fragment,firstChild:n[0],children:n}}}]),e}(),g=function(){var e={PreActivation:1,PostActivation:2};return e[e.PreActivation]="PreActivation",e[e.PostActivation]="PostActivation",e}(),v=new d.s("@ngrx/router-store Internal Configuration"),j=new d.s("@ngrx/router-store Configuration");function S(e){return Object.assign({stateKey:"router",serializer:m,navigationActionTiming:g.PreActivation},e)}var y,O,w,T=function(){var e={NONE:1,ROUTER:2,STORE:3};return e[e.NONE]="NONE",e[e.ROUTER]="ROUTER",e[e.STORE]="STORE",e}(),C=function(){var e=function(){function e(t,n,i,o,c){Object(b.a)(this,e),this.store=t,this.router=n,this.serializer=i,this.errorHandler=o,this.config=c,this.lastEvent=null,this.routerState=null,this.trigger=T.NONE,this.stateKey=this.config.stateKey,this.setUpStoreStateListener(),this.setUpRouterEventsListener()}return Object(l.a)(e,[{key:"setUpStoreStateListener",value:function(){var e=this;this.store.pipe(Object(c.t)(this.stateKey),Object(f.a)(this.store)).subscribe((function(t){var n=Object(s.a)(t,2);e.navigateIfNeeded(n[0],n[1])}))}},{key:"navigateIfNeeded",value:function(e,t){var n=this;if(e&&e.state&&this.trigger!==T.ROUTER&&!(this.lastEvent instanceof u.e)){var i=e.state.url;this.router.url!==i&&(this.storeState=t,this.trigger=T.STORE,this.router.navigateByUrl(i).catch((function(e){n.errorHandler.handleError(e)})))}}},{key:"setUpRouterEventsListener",value:function(){var e,t=this,n=this.config.navigationActionTiming===g.PostActivation;this.router.events.pipe(Object(f.a)(this.store)).subscribe((function(i){var o=Object(s.a)(i,2),c=o[0],a=o[1];t.lastEvent=c,c instanceof u.e?(t.routerState=t.serializer.serialize(t.router.routerState.snapshot),t.trigger!==T.STORE&&(t.storeState=a,t.dispatchRouterRequest(c))):c instanceof u.k?(e=c,n||t.trigger===T.STORE||t.dispatchRouterNavigation(c)):c instanceof u.b?(t.dispatchRouterCancel(c),t.reset()):c instanceof u.d?(t.dispatchRouterError(c),t.reset()):c instanceof u.c&&(t.trigger!==T.STORE&&(n&&t.dispatchRouterNavigation(e),t.dispatchRouterNavigated(c)),t.reset())}))}},{key:"dispatchRouterRequest",value:function(e){this.dispatchRouterAction("@ngrx/router-store/request",{event:e})}},{key:"dispatchRouterNavigation",value:function(e){var t=this.serializer.serialize(e.state);this.dispatchRouterAction("@ngrx/router-store/navigation",{routerState:t,event:new u.k(e.id,e.url,e.urlAfterRedirects,t)})}},{key:"dispatchRouterCancel",value:function(e){this.dispatchRouterAction("@ngrx/router-store/cancel",{storeState:this.storeState,event:e})}},{key:"dispatchRouterError",value:function(e){this.dispatchRouterAction("@ngrx/router-store/error",{storeState:this.storeState,event:new u.d(e.id,e.url,"".concat(e))})}},{key:"dispatchRouterNavigated",value:function(e){var t=this.serializer.serialize(this.router.routerState.snapshot);this.dispatchRouterAction("@ngrx/router-store/navigated",{event:e,routerState:t})}},{key:"dispatchRouterAction",value:function(e,t){this.trigger=T.ROUTER;try{this.store.dispatch({type:e,payload:Object.assign(Object.assign({routerState:this.routerState},t),{event:0===this.config.routerState?t.event:{id:t.event.id,url:t.event.url}})})}finally{this.trigger=T.NONE}}},{key:"reset",value:function(){this.trigger=T.NONE,this.storeState=null,this.routerState=null}}],[{key:"forRoot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[{provide:v,useValue:t},{provide:j,useFactory:S,deps:[v]},{provide:p,useClass:t.serializer?t.serializer:0===t.routerState?h:m}]}}}]),e}();return e.\u0275mod=d.Lb({type:e}),e.\u0275inj=d.Kb({factory:function(t){return new(t||e)(d.Xb(c.h),d.Xb(u.f),d.Xb(p),d.Xb(d.o),d.Xb(j))}}),e}(),N=n("44PX"),x=n("psEu"),B=n("dZIy"),E=n("s3T5"),q=n("EDFS"),M=n("S8xs"),I=n("fEDK"),R=n("ZOsW"),$=n("9Ejp"),k=n("AytR"),D=n("mrSG"),F=Object(c.n)("[DB Manager] load sql objects",Object(c.s)()),P=Object(c.n)("[DB Manager] loaded sql objects",Object(c.s)()),z=Object(c.n)("[DB Manager] select connection",Object(c.s)()),L=Object(c.n)("[DB Manager] loaded connections",Object(c.s)()),U=(Object(c.u)({loadSqlObjectsAction:F,loadedSqlObjects:P,selectConnection:z,loadedConnections:L}),{list:[],loading:!1}),A=Object(c.p)(U,Object(c.r)(F,(function(e){return Object(D.a)(Object(D.a)({},e),{list:[],loading:!0})})),Object(c.r)(P,(function(e,t){var n=t.objects;return Object(D.a)(Object(D.a)({},e),{list:n,loading:!1})}))),H={list:[],current:null},X=Object(c.p)(H,Object(c.r)(z,(function(e,t){var n=t.connection;return Object(D.a)(Object(D.a)({},e),{current:n})})),Object(c.r)(L,(function(e,t){var n=t.connections;return Object(D.a)(Object(D.a)({},e),{list:n})}))),Q=Object(c.n)("[DB Manager] load sql object structure",Object(c.s)()),V=Object(c.n)("[DB Manager] loaded sql object structure",Object(c.s)()),K=Object(c.n)("[DB Manager] deleted sql object"),G=Object(c.n)("[DB Manager] save sql object structure",Object(c.s)()),_=Object(c.n)("[DB Manager] saved sql object structure"),J=Object(c.n)("[DB Manager] refresh sql object",Object(c.s)()),Z=(Object(c.u)({loadSqlObjectStructure:Q,loadedSqlObjectStructure:V,saveSqlObjectStructure:G,refreshSqlObject:J}),n("TwVa")),W=n("zSvW"),Y={fields:[],objectId:0,schemaName:null,objectName:null,objectType:Z.DbObjectType.Table},ee={structure:Object(D.a)({},Y),loading:[]},te=Object(c.p)(ee,Object(c.r)(Q,(function(e,t){var n=t.dbObject;return Object(D.a)(Object(D.a)({},e),{structure:Object(D.a)(Object(D.a)({},Y),n),loading:Array.from(new Set(Object(D.g)(e.loading,[W.b.STRUCTURE_LOAD])))})})),Object(c.r)(V,(function(e,t){var n=t.structure||Object(D.a)({},Y);return Object(D.a)(Object(D.a)({},e),{structure:n,loading:e.loading.filter((function(e){return e!==W.b.STRUCTURE_LOAD}))})}))),ne={sqlObjects:function(e,t){return void 0===e&&(e=U),A(e,t)},dbConnections:function(e,t){return void 0===e&&(e=H),X(e,t)},sqlObject:function(e,t){return void 0===e&&(e=ee),te(e,t)},router:function(e,t){var n=t;switch(n.type){case"@ngrx/router-store/navigation":case"@ngrx/router-store/error":case"@ngrx/router-store/cancel":return{state:n.payload.routerState,navigationId:n.payload.event.id};default:return e}}},ie=n("LRne"),oe=n("eIep"),ce=n("lJxs"),ae=n("JIr8"),re=function(e){return e.ERROR="[DB Manager] error",e.SUCCESS="[DB Manager] success",e}({}),se=function(){return function(e){this.payload=e,this.type=re.ERROR}}(),le=function(){return function(e){this.payload=e,this.type=re.SUCCESS}}(),be=n("ZF+8"),de=n("M0ag"),ue=Object(c.o)("sqlObject"),fe=Object(c.q)(ue,(function(e){return e.structure})),pe=Object(c.q)(ue,(function(e){return e.loading})),he=Object(c.q)(pe,(function(e){return e.length?{messages:e.map((function(e){return W.a[e]}))}:null})),me=function(e){return e.dbConnections},ge=Object(c.q)((function(e){return e.sqlObjects}),(function(e){return e.list})),ve=Object(c.q)(me,(function(e){return e.list})),je=Object(c.q)(me,(function(e){return e.current})),Se=Object(c.q)(me,(function(e){if(e.current&&e.list.length)return e.list.find((function(t){return t.connectionName===e.current}))})),ye=Object(c.o)("router"),Oe=(y=ye,O=Object(c.q)(y,(function(e){return e&&e.state})),w=Object(c.q)(O,(function(e){if(e){for(var t=e.root;t.firstChild;)t=t.firstChild;return t}})),Object(c.q)(w,(function(e){return e&&e.queryParams})),Object(c.q)(w,(function(e){return e&&e.params})),Object(c.q)(w,(function(e){return e&&e.data})),Object(c.q)(O,(function(e){return e&&e.url}))),we=Object(c.q)(ye,(function(e,t){if(void 0===t&&(t=null),!e.state)return{};for(var n=e.state.root,i=Object(D.a)({},n.params);n.firstChild;)n=n.firstChild,i=Object(D.a)(Object(D.a)({},i),n.params);return t?Object.entries(i).reduce((function(e,n){var i=n[0],o=n[1];return t.includes(i)&&(e[i]=o),e}),{}):i})),Te=Object(c.q)(we,(function(e,t){return e[t]})),Ce=function(){function e(e,t,n,i){var o=this;this.actions$=e,this.sqlDb=t,this.store=n,this.router=i,this.loadSqlObjectStructure$=this.actions$.pipe(Object(r.e)(Q),Object(f.a)(this.store),Object(oe.a)((function(e){var t=e[0].dbObject;return o.sqlDb.getMetaDataObject(e[1].dbConnections.current,t.schemaName,t.objectName,t.objectType).pipe(Object(ce.a)((function(e){return V({structure:e})})),Object(ae.a)((function(e){return Object(ie.a)(new se(e.message),V({}))})))}))),this.saveSqlObjectStructure$=this.actions$.pipe(Object(r.e)(G),Object(f.a)(this.store),Object(oe.a)((function(e){var t=e[0].structure,n=e[1];return Object(de.e)(t,n.sqlObject.structure)?[_(),{type:"Sql structure not changed"}]:o.sqlDb.generateObject(n.dbConnections.current,t).pipe(Object(oe.a)((function(e){return[F({connection:n.dbConnections.current}),V({structure:e}),_(),new le("SQL Structure saved")]})),Object(ae.a)((function(e){return Object(ie.a)(new se(Object(de.i)(e)))})))}))),this.deletedSqlObject$=Object(r.d)((function(){return o.actions$.pipe(Object(r.e)(K),Object(f.a)(o.store.select(je)),Object(oe.a)((function(e){var t=e[1];return o.router.navigate(["/sql-client",t]),[F({connection:t}),V({})]})))})),this.refreshSqlObject$=Object(r.d)((function(){return o.actions$.pipe(Object(r.e)(J),Object(ce.a)((function(e){return Q({dbObject:e.dbObject})})))})),this.loadedSqlObject$=this.actions$.pipe(Object(r.e)(V),Object(f.a)(this.store),Object(ce.a)((function(e){var t=e[0].structure,n=["/sql-client",e[1].dbConnections.current];if(t){var i=t.schemaName,c=t.objectName,a=t.objectType;a===Z.DbObjectType.View?n.push("view"):a===Z.DbObjectType.Procedure&&n.push("procedure"),n=Object(D.g)(n,[i,c]),o.router.navigate(n,{queryParamsHandling:"merge"})}return{type:"Route checked after table structure update"}})))}return e.\u0275fac=function(t){return new(t||e)(d.Xb(r.a),d.Xb(be.f),d.Xb(c.h),d.Xb(u.f))},e.\u0275prov=d.Jb({token:e,factory:e.\u0275fac}),Object(D.c)([Object(r.b)(),Object(D.f)("design:type",Object)],e.prototype,"loadSqlObjectStructure$",void 0),Object(D.c)([Object(r.b)(),Object(D.f)("design:type",Object)],e.prototype,"saveSqlObjectStructure$",void 0),Object(D.c)([Object(r.b)(),Object(D.f)("design:type",Object)],e.prototype,"loadedSqlObject$",void 0),e}(),Ne=function(){function e(e,t,n){var i=this;this.actions$=e,this.notificationService=t,this.sqlDb=n,this.loadSqlObjects$=this.actions$.pipe(Object(r.e)(F),Object(oe.a)((function(e){return i.sqlDb.getObjects(e.connection).pipe(Object(ce.a)((function(e){return P({objects:e})})),Object(ae.a)((function(e){return Object(ie.a)(P({objects:[]}),new se(e.message))})))}))),this.errorHandler$=this.actions$.pipe(Object(r.e)(re.ERROR),Object(ce.a)((function(e){var t=e.payload;return i.notificationService.open({message:t,type:Z.NotificationType.DANGER}),{type:"[DB Manager] Shown Error: "+t}}))),this.successHandler$=this.actions$.pipe(Object(r.e)(re.SUCCESS),Object(ce.a)((function(e){var t=e.payload;return i.notificationService.open({message:t,type:Z.NotificationType.SUCCESS}),{type:"[DB Manager] Shown Success: "+t}})))}return e.\u0275fac=function(t){return new(t||e)(d.Xb(r.a),d.Xb(be.e),d.Xb(be.f))},e.\u0275prov=d.Jb({token:e,factory:e.\u0275fac}),Object(D.c)([Object(r.b)(),Object(D.f)("design:type",Object)],e.prototype,"loadSqlObjects$",void 0),Object(D.c)([Object(r.b)(),Object(D.f)("design:type",Object)],e.prototype,"errorHandler$",void 0),Object(D.c)([Object(r.b)(),Object(D.f)("design:type",Object)],e.prototype,"successHandler$",void 0),e}(),xe=n("OaQ9"),Be=n("pLZG"),Ee=n("/uUt"),qe=n("1G5W"),Me=n("XNiG"),Ie=n("iFvM"),Re=n("1ua0"),$e=n("Xn/w");function ke(e,t){if(1&e){var n=d.Ub();d.Tb(0,"li",6),d.Tb(1,"a",7),d.bc("click",(function(){d.vc(n);var e=t.$implicit;return d.dc(2).onConnectionSelect(e.connectionName)})),d.Ec(2),d.Sb(),d.Sb()}if(2&e){var i=t.$implicit;d.Bb(2),d.Fc(i.connectionName)}}function De(e,t){if(1&e&&(d.Tb(0,"ul",4),d.Cc(1,ke,3,1,"li",5),d.ec(2,"async"),d.Sb()),2&e){var n=d.dc();d.Bb(1),d.jc("ngForOf",d.fc(2,1,n.connections$))}}var Fe=function(){function e(e,t){this.router=e,this.store=t}return e.prototype.ngOnInit=function(){this.connections$=this.store.select(ve),this.selectedConnection$=this.store.select(Te,"connectionName")},e.prototype.onConnectionSelect=function(e){this.router.navigate(["/sql-client",e])},e.\u0275fac=function(t){return new(t||e)(d.Nb(u.f),d.Nb(c.h))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-db-connections"]],decls:6,vars:3,consts:[["dropdown","","placement","bottom right",1,"btn-group","align-self-center"],["id","connections-btn-group","dropdownToggle","","type","button","title","Select connection","aria-controls","dropdown-menu-connections","tabindex","0","role","button",1,"btn","btn-light","dropdown-toggle","btn-sm","m-0"],[1,"caret"],["id","dropdown-menu-connections","class","dropdown-menu dropdown-menu-right","role","menu","aria-labelledby","connections-btn-group",4,"dropdownMenu"],["id","dropdown-menu-connections","role","menu","aria-labelledby","connections-btn-group",1,"dropdown-menu","dropdown-menu-right"],["role","menuitem",4,"ngFor","ngForOf"],["role","menuitem"],[1,"dropdown-item","cursor-pointer",3,"click"]],template:function(e,t){1&e&&(d.Tb(0,"div",0),d.Tb(1,"button",1),d.Ec(2),d.ec(3,"async"),d.Ob(4,"span",2),d.Sb(),d.Cc(5,De,3,3,"ul",3),d.Sb()),2&e&&(d.Bb(2),d.Gc(" ",d.fc(3,1,t.selectedConnection$)," "))},directives:[B.a,B.d,B.b,i.l],pipes:[i.b],styles:[""],changeDetection:0}),e}(),Pe=n("GXwU"),ze=n("fQZA"),Le=["listView"],Ue=function(e){return["/sql-client",e,"sql-query"]},Ae=function(e){return["/sql-client",e]};function He(e,t){if(1&e&&(d.Tb(0,"ul",11),d.Tb(1,"li",12),d.Tb(2,"a",13),d.Ec(3,"SQL Query"),d.Sb(),d.Sb(),d.Tb(4,"li",12),d.Tb(5,"a",13),d.Ec(6,"Table"),d.Sb(),d.Sb(),d.Sb()),2&e){var n=d.dc();d.Bb(2),d.jc("routerLink",d.nc(2,Ue,n.connectionName)),d.Bb(3),d.jc("routerLink",d.nc(4,Ae,n.connectionName))}}var Xe=function(e,t,n){return["/sql-client",e,t,n]};function Qe(e,t){if(1&e&&(d.Tb(0,"a",16),d.Ob(1,"i",17),d.Ec(2),d.Sb()),2&e){var n=d.dc().$implicit,i=d.dc();d.kc("title",n.objectType),d.jc("routerLink",d.pc(4,Xe,i.connectionName,n.schemaName,n.objectName)),d.Bb(2),d.Hc(" ",n.schemaName,".",n.objectName," ")}}var Ve=function(e,t,n){return["/sql-client",e,"view",t,n]};function Ke(e,t){if(1&e&&(d.Tb(0,"a",16),d.Ob(1,"i",18),d.Ec(2),d.Sb()),2&e){var n=d.dc().$implicit,i=d.dc();d.kc("title",n.objectType),d.jc("routerLink",d.pc(4,Ve,i.connectionName,n.schemaName,n.objectName)),d.Bb(2),d.Hc(" ",n.schemaName,".",n.objectName," ")}}var Ge=function(e,t,n){return["/sql-client",e,"procedure",t,n]};function _e(e,t){if(1&e&&(d.Tb(0,"a",19),d.Ob(1,"i",20),d.Ec(2),d.Sb()),2&e){var n=d.dc().$implicit,i=d.dc();d.kc("title",n.objectType),d.jc("routerLink",d.pc(4,Ge,i.connectionName,n.schemaName,n.objectName)),d.Bb(2),d.Hc(" ",n.schemaName,".",n.objectName," ")}}function Je(e,t){if(1&e&&(d.Cc(0,Qe,3,8,"a",14),d.Cc(1,Ke,3,8,"a",14),d.Cc(2,_e,3,8,"a",15)),2&e){var n=t.$implicit;d.jc("ngIf","Table"===n.objectType),d.Bb(1),d.jc("ngIf","View"===n.objectType),d.Bb(1),d.jc("ngIf","Procedure"===n.objectType)}}var Ze=function(e,t,n){return{"fa-table":e,"fa-cubes":t,"fa-file-code-o":n}};function We(e,t){if(1&e&&d.Ob(0,"i",21),2&e){var n=t.$implicit;d.jc("ngClass",d.pc(1,Ze,"Table"===n.value,"View"===n.value,"Procedure"===n.value))}}function Ye(e,t){1&e&&(d.Tb(0,"div",22),d.Tb(1,"div",23),d.Tb(2,"span",24),d.Ec(3,"Loading..."),d.Sb(),d.Sb(),d.Sb())}var et=function(){function e(e,t,n){this.store=e,this.dialogService=t,this.router=n,this.destroy$=new Me.a}return e.prototype.ngOnInit=function(){var e=this;this.list$=this.store.select(ge).pipe(Object(qe.a)(this.destroy$)),this.store.select(Te,"connectionName").pipe(Object(Be.a)((function(e){return Boolean(e)})),Object(qe.a)(this.destroy$)).subscribe((function(t){e.connectionName=t,e.store.dispatch(F({connection:t}))})),this.store.select(fe).pipe(Object(qe.a)(this.destroy$)).subscribe((function(t){e.listView.selectItem(t)})),this.store.select(me).subscribe((function(t){e.connections=t.list})),this.loading$=this.store.select((function(e){return e.sqlObjects.loading}))},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.areObjectsEqual=function(e,t){return e&&t&&e.objectName===t.objectName&&e.schemaName===t.schemaName},e.prototype.refresh=function(){this.store.dispatch(F({connection:this.connectionName})),this.store.dispatch(J({dbObject:this.listView.selectedItem}))},e.prototype.import=function(){var e=this,t=this.dialogService.open(Pe.a,{class:"modal-xl full-height",keyboard:!1});t.config={connection:this.connections.find((function(t){return t.connectionName===e.connectionName})),connections:this.connections},t.init.pipe(Object(oe.a)((function(){return t.component.import}))).subscribe((function(t){var n=t.metaData,i=t.connection;t.newTable&&e.store.dispatch(F({connection:i})),e.router.navigate(["/sql-client",i,n.schemaName,n.objectName])}))},e.\u0275fac=function(t){return new(t||e)(d.Nb(c.h),d.Nb(be.b),d.Nb(u.f))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-sql-objects"]],viewQuery:function(e,t){var n;1&e&&d.Ac(Le,!0),2&e&&d.rc(n=d.cc())&&(t.listView=n.first)},decls:18,vars:7,consts:[[1,"toolbar","mb-2"],["dropdown","",1,"btn-group","mr-2"],["id","button-basic","dropdownToggle","","type","button","aria-controls","dropdown-basic",1,"btn","btn-primary","dropdown-toggle"],[1,"caret"],["id","dropdown-basic","class","dropdown-menu","role","menu","aria-labelledby","button-basic",4,"dropdownMenu"],["type","button",1,"btn","btn-secondary","mr-2",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"],["group","objectType","orderBy","id",1,"d-flex","h-100","overflow-auto",3,"comparator","list"],["listView",""],["icon",""],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],["id","dropdown-basic","role","menu","aria-labelledby","button-basic",1,"dropdown-menu"],["role","menuitem"],[1,"dropdown-item",3,"routerLink"],["queryParamsHandling","merge","class","p-1 pl-4 btn-link w-100",3,"routerLink","title",4,"ngIf"],["class","p-1 pl-4 btn-link w-100",3,"routerLink","title",4,"ngIf"],["queryParamsHandling","merge",1,"p-1","pl-4","btn-link","w-100",3,"routerLink","title"],[1,"fa","fa-table"],[1,"fa","fa-cubes"],[1,"p-1","pl-4","btn-link","w-100",3,"routerLink","title"],[1,"fa","fa-file-code-o"],[1,"fa","mx-1",3,"ngClass"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(e,t){1&e&&(d.Tb(0,"div",0),d.Tb(1,"div",1),d.Tb(2,"button",2),d.Ec(3,"New "),d.Ob(4,"span",3),d.Sb(),d.Cc(5,He,7,6,"ul",4),d.Sb(),d.Tb(6,"button",5),d.bc("click",(function(){return t.refresh()})),d.Ec(7," Refresh "),d.Sb(),d.Tb(8,"button",6),d.bc("click",(function(){return t.import()})),d.Ec(9," Import "),d.Sb(),d.Sb(),d.Tb(10,"app-list-view",7,8),d.ec(12,"async"),d.Cc(13,Je,3,3,"ng-template"),d.Cc(14,We,1,5,"ng-template",null,9,d.Dc),d.Sb(),d.Cc(16,Ye,4,0,"div",10),d.ec(17,"async")),2&e&&(d.Bb(10),d.jc("comparator",t.areObjectsEqual)("list",d.fc(12,3,t.list$)),d.Bb(6),d.jc("ngIf",d.fc(17,5,t.loading$)))},directives:[B.a,B.d,B.b,ze.a,i.m,u.h,i.k],pipes:[i.b],styles:["[_nghost-%COMP%]{position:relative}"]}),e}();function tt(e,t){if(1&e){var n=d.Ub();d.Tb(0,"button",7),d.bc("click",(function(){return d.vc(n),d.dc().openSqlConnectionForm()})),d.Ec(1,"Edit"),d.Sb()}}var nt=function(){function e(e,t){this.store=e,this.dialogService=t,this.layoutConfig={icon:"assets/img/rc-logo-64x64.png",smIcon:"assets/img/rc-logo-36x36.png",appName:"database-manager",noMargin:!0},this.destroy$=new Me.a}return e.prototype.ngOnInit=function(){var e=this;this.store.select(Te,"connectionName").pipe(Object(Be.a)((function(e){return Boolean(e)})),Object(Ee.a)(),Object(qe.a)(this.destroy$)).subscribe((function(t){e.store.dispatch(z({connection:t}))})),this.store.select(Oe).pipe(Object(Ee.a)((function(e,t){return e.replace(/\?.*/,"")===t.replace(/\?.*/,"")})),Object(qe.a)(this.destroy$),Object(oe.a)((function(t){return e.store.select(we,["schemaName","objectName"]).pipe(Object(Ee.a)((function(e,t){return JSON.stringify(e)===JSON.stringify(t)})),Object(qe.a)(e.destroy$),Object(ce.a)((function(e){return{params:e,url:t}})))}))).subscribe((function(t){var n=t.params,i=t.url,o=n.schemaName,c=n.objectName;if(o&&c){var a=Object(Ie.r)(i);e.store.dispatch(Q({dbObject:{schemaName:o,objectName:c,objectType:a}}))}else e.store.dispatch(V({}))})),this.store.select(Se).subscribe((function(t){e.connection=t}))},e.prototype.openSqlConnectionForm=function(){this.dialogService.open(Re.b,{class:"modal-lg full-height"}).config=this.connection},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.\u0275fac=function(t){return new(t||e)(d.Nb(c.h),d.Nb(be.b))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-manager-layout"]],decls:11,vars:2,consts:[[3,"config"],["title","",1,"mb-0","top-sub-header","col-10","col-md","px-0"],["header",""],[1,"ml-md-auto","d-flex","mr-2"],["class","btn btn-light btn-sm align-self-center mr-2",3,"click",4,"ngIf"],["sidebar","",1,"h-100","w-100","py-2","pl-2","d-flex","flex-column"],["content",""],[1,"btn","btn-light","btn-sm","align-self-center","mr-2",3,"click"]],template:function(e,t){1&e&&(d.Tb(0,"app-layout",0),d.Tb(1,"h2",1),d.Ec(2,"WORKSHEET "),d.Tb(3,"span"),d.Ec(4,"SYSTEMS"),d.Sb(),d.Ec(5," - SQL Client"),d.Sb(),d.Rb(6,2),d.Ob(7,"app-db-connections",3),d.Cc(8,tt,2,0,"button",4),d.Qb(),d.Ob(9,"app-sql-objects",5),d.Ob(10,"router-outlet",6),d.Sb()),2&e&&(d.jc("config",t.layoutConfig),d.Bb(8),d.jc("ngIf",t.connection&&t.connection.isAdmin))},directives:[$e.a,Fe,i.m,et,u.j],styles:[""]}),e}(),it=function(){function e(e,t,n){this.store=e,this.dbConnnectionsService=t,this.router=n}return e.prototype.canActivate=function(){var e=this;return this.store.select(Te,"connectionName").pipe(Object(oe.a)((function(t){return t?e.dbConnnectionsService.loadMyDbConnections().pipe(Object(ae.a)((function(e){return Object(ie.a)([])})),Object(ce.a)((function(n){try{e.store.dispatch(L({connections:n}))}catch(i){return!1}return n.map((function(e){return e.connectionName.toLowerCase()})).includes(t.toLowerCase())}))):(e.router.navigate(["/login"]),Object(ie.a)(!1))})))},e.\u0275fac=function(t){return new(t||e)(d.Xb(c.h),d.Xb(be.a),d.Xb(u.f))},e.\u0275prov=d.Jb({token:e,factory:e.\u0275fac}),e}(),ot=n("xpqn");function ct(e,t){if(1&e){var n=d.Ub();d.Tb(0,"app-db-view",4),d.bc("viewSaved",(function(e){return d.vc(n),d.dc().onSave(e)}))("deleted",(function(){return d.vc(n),d.dc().onDeleted()})),d.Sb()}if(2&e){var i=d.dc();d.jc("saveBtn",!0)("dataObject",i.dataObject)("connection",i.connection)}}function at(e,t){if(1&e&&(d.Tb(0,"h5"),d.Ec(1),d.Sb()),2&e){var n=t.$implicit;d.Bb(1),d.Fc(n)}}function rt(e,t){if(1&e&&(d.Tb(0,"div",5),d.Tb(1,"div",6),d.Tb(2,"span",7),d.Ec(3,"Loading..."),d.Sb(),d.Sb(),d.Cc(4,at,2,1,"h5",8),d.Sb()),2&e){var n=d.dc();d.Bb(4),d.jc("ngForOf",n.loading.messages)}}var st=function(){function e(e){this.store=e,this.destroy$=new Me.a}return e.prototype.ngOnInit=function(){var e=this;this.store.select(fe).pipe(Object(qe.a)(this.destroy$)).subscribe((function(t){e.dataObject=t})),this.store.select(he).pipe(Object(qe.a)(this.destroy$)).subscribe((function(t){e.loading=t})),this.store.select(Se).pipe(Object(qe.a)(this.destroy$)).subscribe((function(t){e.connection=t}))},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.onDeleted=function(){this.store.dispatch(K())},e.prototype.onSave=function(e){this.store.dispatch(V({structure:e}))},e.\u0275fac=function(t){return new(t||e)(d.Nb(c.h))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-db-view-content"]],decls:4,vars:3,consts:[[1,"tabset-fx","sql-object-tab","nav-tabs-boxed"],[1,"h-100","position-relative",3,"heading"],["class","h-100",3,"saveBtn","dataObject","connection","viewSaved","deleted",4,"ngIf"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[1,"h-100",3,"saveBtn","dataObject","connection","viewSaved","deleted"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(d.Tb(0,"tabset",0),d.Tb(1,"tab",1),d.Cc(2,ct,1,3,"app-db-view",2),d.Cc(3,rt,5,1,"div",3),d.Sb(),d.Sb()),2&e&&(d.Bb(1),d.jc("heading",(null==t.dataObject?null:t.dataObject.objectName)||"Create view"),d.Bb(1),d.jc("ngIf",!t.loading&&t.dataObject),d.Bb(1),d.jc("ngIf",t.loading))},directives:[N.d,N.a,i.m,ot.a,i.l],styles:[""]}),e}(),lt=n("AXyZ");function bt(e,t){if(1&e&&(d.Tb(0,"h5"),d.Ec(1),d.Sb()),2&e){var n=t.$implicit;d.Bb(1),d.Fc(n)}}function dt(e,t){if(1&e&&(d.Tb(0,"div",4),d.Tb(1,"div",5),d.Tb(2,"span",6),d.Ec(3,"Loading..."),d.Sb(),d.Sb(),d.Cc(4,bt,2,1,"h5",7),d.Sb()),2&e){var n=t.ngIf;d.Bb(4),d.jc("ngForOf",n.messages)}}function ut(e,t){if(1&e){var n=d.Ub();d.Tb(0,"app-db-table",9),d.bc("deleted",(function(){return d.vc(n),d.dc(2).onTableDeleted()}))("tableSaved",(function(e){return d.vc(n),d.dc(2).onSave(e)}))("savedToNewTable",(function(){return d.vc(n),d.dc(2).onNewTable()})),d.Sb()}if(2&e){var i=d.dc(2);d.jc("dataObject",i.dataObject)("connection",i.connection)("saveBtn",!0)("connections",i.connections)}}function ft(e,t){if(1&e&&d.Cc(0,ut,1,4,"app-db-table",8),2&e){var n=d.dc();d.jc("ngIf",n.dataObject)}}var pt=function(){function e(e){this.store=e,this.destroy$=new Me.a}return e.prototype.ngOnInit=function(){var e=this;this.store.select(fe).pipe(Object(qe.a)(this.destroy$)).subscribe((function(t){e.dataObject=t})),this.loading$=this.store.select(he),this.store.select(Se).pipe(Object(qe.a)(this.destroy$)).subscribe((function(t){e.connection=t})),this.store.select(me).pipe(Object(qe.a)(this.destroy$)).subscribe((function(t){e.connections=t.list}))},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.onTableDeleted=function(){this.store.dispatch(K())},e.prototype.onSave=function(e){this.store.dispatch(V({structure:e}))},e.prototype.onNewTable=function(){this.store.dispatch(F({connection:this.connection.connectionName}))},e.\u0275fac=function(t){return new(t||e)(d.Nb(c.h))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-db-table-content"]],viewQuery:function(e,t){var n;1&e&&d.Jc(lt.a,!0),2&e&&d.rc(n=d.cc())&&(t.dbTable=n.first)},decls:6,vars:5,consts:[[1,"tabset-fx","sql-object-tab","nav-tabs-boxed"],[1,"h-100","position-relative",3,"heading"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf","ngIfElse"],["content",""],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"],[4,"ngFor","ngForOf"],["class","d-flex flex-column h-100",3,"dataObject","connection","saveBtn","connections","deleted","tableSaved","savedToNewTable",4,"ngIf"],[1,"d-flex","flex-column","h-100",3,"dataObject","connection","saveBtn","connections","deleted","tableSaved","savedToNewTable"]],template:function(e,t){if(1&e&&(d.Tb(0,"tabset",0),d.Tb(1,"tab",1),d.Cc(2,dt,5,1,"div",2),d.ec(3,"async"),d.Cc(4,ft,1,1,"ng-template",null,3,d.Dc),d.Sb(),d.Sb()),2&e){var n=d.sc(5);d.Bb(1),d.jc("heading",(null==t.dataObject?null:t.dataObject.objectName)||"Create table"),d.Bb(1),d.jc("ngIf",d.fc(3,3,t.loading$))("ngIfElse",n)}},directives:[N.d,N.a,i.m,i.l,lt.a],pipes:[i.b],styles:["tabset.sql-object-tab[_ngcontent-%COMP%] > .tab-content[_ngcontent-%COMP%]{position:relative}.spinner[_ngcontent-%COMP%]{left:0}"]}),e}(),ht=n("8gf/");function mt(e,t){if(1&e&&(d.Tb(0,"h5"),d.Ec(1),d.Sb()),2&e){var n=t.$implicit;d.Bb(1),d.Fc(n)}}function gt(e,t){if(1&e&&(d.Tb(0,"div",4),d.Tb(1,"div",5),d.Tb(2,"span",6),d.Ec(3,"Loading..."),d.Sb(),d.Sb(),d.Cc(4,mt,2,1,"h5",7),d.Sb()),2&e){var n=t.ngIf;d.Bb(4),d.jc("ngForOf",n.messages)}}function vt(e,t){if(1&e){var n=d.Ub();d.Tb(0,"app-db-procedure",9),d.bc("procedureSaved",(function(e){return d.vc(n),d.dc(2).onSave(e)}))("procedureDeleted",(function(){return d.vc(n),d.dc(2).onDeleted()})),d.Sb()}if(2&e){var i=d.dc(2);d.jc("dataObject",i.dataObject)("connection",i.connection)("saveBtn",!0)}}function jt(e,t){if(1&e&&d.Cc(0,vt,1,3,"app-db-procedure",8),2&e){var n=d.dc();d.jc("ngIf",n.dataObject)}}var St=function(){function e(e){this.store=e,this.destroy$=new Me.a}return e.prototype.ngOnInit=function(){var e=this;this.store.select(fe).pipe(Object(qe.a)(this.destroy$)).subscribe((function(t){e.dataObject=t})),this.loading$=this.store.select(he),this.store.select(Se).pipe(Object(qe.a)(this.destroy$)).subscribe((function(t){e.connection=t}))},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.onSave=function(e){this.store.dispatch(V({structure:e}))},e.prototype.onDeleted=function(){this.store.dispatch(K())},e.\u0275fac=function(t){return new(t||e)(d.Nb(c.h))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-db-procedure-content"]],decls:6,vars:5,consts:[[1,"tabset-fx","sql-object-tab","nav-tabs-boxed"],[1,"h-100","position-relative",3,"heading"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf","ngIfElse"],["content",""],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"],[4,"ngFor","ngForOf"],["class","h-100",3,"dataObject","connection","saveBtn","procedureSaved","procedureDeleted",4,"ngIf"],[1,"h-100",3,"dataObject","connection","saveBtn","procedureSaved","procedureDeleted"]],template:function(e,t){if(1&e&&(d.Tb(0,"tabset",0),d.Tb(1,"tab",1),d.Cc(2,gt,5,1,"div",2),d.ec(3,"async"),d.Cc(4,jt,1,1,"ng-template",null,3,d.Dc),d.Sb(),d.Sb()),2&e){var n=d.sc(5);d.Bb(1),d.jc("heading",t.dataObject?t.dataObject.objectName:"Create table"),d.Bb(1),d.jc("ngIf",d.fc(3,3,t.loading$))("ngIfElse",n)}},directives:[N.d,N.a,i.m,i.l,ht.a],pipes:[i.b],styles:[""]}),e}(),yt=n("FbUF"),Ot=function(){function e(e){this.store=e}return e.prototype.ngOnInit=function(){var e=this;this.store.select(me).subscribe((function(t){var n=t.list;e.connection=t.current,e.connections=n}))},e.prototype.onExecutedQuery=function(){this.store.dispatch(F({connection:this.connection}))},e.\u0275fac=function(t){return new(t||e)(d.Nb(c.h))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-db-query-content"]],decls:3,vars:2,consts:[[1,"tabset-fx","sql-object-tab","nav-tabs-boxed"],["heading","Sql Query",1,"h-100","position-relative"],[1,"h-100","w-100",3,"connections","defaultConnection","executedQuery"]],template:function(e,t){1&e&&(d.Tb(0,"tabset",0),d.Tb(1,"tab",1),d.Tb(2,"app-db-query",2),d.bc("executedQuery",(function(){return t.onExecutedQuery()})),d.Sb(),d.Sb(),d.Sb()),2&e&&(d.Bb(2),d.jc("connections",t.connections)("defaultConnection",t.connection))},directives:[N.d,N.a,yt.a],styles:[""]}),e}(),wt=n("c9YK");function Tt(e,t){1&e&&(d.Tb(0,"div",7),d.Tb(1,"div",8),d.Tb(2,"span",9),d.Ec(3,"Loading..."),d.Sb(),d.Sb(),d.Sb())}function Ct(e,t){if(1&e){var n=d.Ub();d.Tb(0,"app-db-connection-config",10),d.bc("saved",(function(){return d.vc(n),d.dc().loadConnections()}))("skip",(function(){return d.vc(n),d.dc().onSkip()})),d.Sb()}if(2&e){var i=d.dc();d.jc("config",i.dbConnection)}}function Nt(e,t){if(1&e){var n=d.Ub();d.Tb(0,"button",19),d.bc("click",(function(e){d.vc(n);var t=d.dc().$implicit;return d.dc(2).openSqlConnectionForm(t),e.stopImmediatePropagation(),e.preventDefault()})),d.Ob(1,"i",20),d.Sb()}}var xt=function(e){return["/sql-client",e,"sql-query"]};function Bt(e,t){if(1&e&&(d.Tb(0,"a",16),d.Tb(1,"h5",17),d.Ec(2),d.Sb(),d.Ec(3),d.Cc(4,Nt,2,0,"button",18),d.Sb()),2&e){var n=t.$implicit;d.jc("routerLink",d.nc(4,xt,n.connectionName)),d.Bb(2),d.Fc(n.connectionName),d.Bb(1),d.Gc("",n.connectionType," "),d.Bb(1),d.jc("ngIf",n.isAdmin)}}function Et(e,t){if(1&e){var n=d.Ub();d.Tb(0,"section",11),d.Tb(1,"h3",12),d.Ec(2,"SQL Connections"),d.Sb(),d.Tb(3,"div",13),d.Cc(4,Bt,5,6,"a",14),d.Tb(5,"button",15),d.bc("click",(function(){return d.vc(n),d.dc().openSqlConnectionForm()})),d.Ec(6,"New SQL Connection"),d.Sb(),d.Sb(),d.Sb()}if(2&e){var i=d.dc();d.Bb(4),d.jc("ngForOf",i.myConnections)}}var qt=[{path:"",component:function(){function e(e,t,n){this.connectionsService=e,this.router=t,this.dialogService=n,this.layoutConfig={icon:"assets/img/rc-logo-64x64.png",smIcon:"assets/img/rc-logo-36x36.png",appName:"database-manager",noMargin:!0,sidebar:Z.SidebarState.Hidden},this.dbConnection=Object(D.a)({},W.c),this.loading=!1,this.destroy$=new Me.a}return e.prototype.ngOnInit=function(){var e=this;this.connectionsService.myConnections$.pipe(Object(qe.a)(this.destroy$)).subscribe((function(t){e.myConnections=t})),this.loadConnections()},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.loadConnections=function(){return Object(D.b)(this,void 0,void 0,(function(){return Object(D.e)(this,(function(e){switch(e.label){case 0:return this.loading=!0,[4,this.connectionsService.loadMyDbConnections().toPromise()];case 1:return e.sent(),this.loading=!1,[2]}}))}))},e.prototype.openSqlConnectionForm=function(e){this.dialogService.open(de.b,{class:"modal-lg full-height"}).config=e||Object(D.a)({},W.c)},e.prototype.onSkip=function(){this.router.navigate(["/"])},e.\u0275fac=function(t){return new(t||e)(d.Nb(be.a),d.Nb(u.f),d.Nb(be.b))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-create-connection"]],decls:12,vars:4,consts:[[3,"config"],["title","",1,"mb-0","ml-0","top-sub-header","w-md-down-50","mr-auto"],["header","",1,"ml-auto","d-flex"],["content","",1,"container","rounded"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[3,"config","saved","skip",4,"ngIf","ngIfElse"],["list",""],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"],[3,"config","saved","skip"],[1,"py-3"],[1,"border-bottom","border-gray","pb-2","mb-0"],[1,"mt-2"],["class","d-flex my-3 connection-item align-items-center",3,"routerLink",4,"ngFor","ngForOf"],[1,"btn","btn-primary","mr-2",3,"click"],[1,"d-flex","my-3","connection-item","align-items-center",3,"routerLink"],[1,"mr-2","mb-0"],["class","btn btn-link",3,"click",4,"ngIf"],[1,"btn","btn-link",3,"click"],[1,"fa","fa-edit"]],template:function(e,t){if(1&e&&(d.Tb(0,"app-layout",0),d.Tb(1,"h2",1),d.Ec(2,"WORKSHEET "),d.Tb(3,"span"),d.Ec(4,"SYSTEMS"),d.Sb(),d.Ec(5," - SQL Client"),d.Sb(),d.Ob(6,"div",2),d.Tb(7,"div",3),d.Cc(8,Tt,4,0,"div",4),d.Cc(9,Ct,1,1,"app-db-connection-config",5),d.Cc(10,Et,7,1,"ng-template",null,6,d.Dc),d.Sb(),d.Sb()),2&e){var n=d.sc(11);d.jc("config",t.layoutConfig),d.Bb(8),d.jc("ngIf",t.loading),d.Bb(1),d.jc("ngIf",!(null!=t.myConnections&&t.myConnections.length))("ngIfElse",n)}},directives:[$e.a,i.m,wt.a,i.l,u.h],styles:[".container[_ngcontent-%COMP%]{background:var(--bg)}.connection-item[_ngcontent-%COMP%]{color:var(--color)}.connection-item[_ngcontent-%COMP%]:hover{text-decoration:none}"]}),e}()},{path:":connectionName",component:nt,canActivate:[it],children:[{component:pt,path:""},{component:pt,path:":schemaName/:objectName"},{component:st,path:"view"},{component:st,path:"view/:schemaName/:objectName"},{component:Ot,path:"sql-query"},{component:St,path:"procedure/:schemaName/:objectName"}]}],Mt=function(){function e(){}return e.\u0275mod=d.Lb({type:e}),e.\u0275inj=d.Kb({factory:function(t){return new(t||e)},imports:[[u.i.forChild(qt)],u.i]}),e}(),It=function(){function e(){}return e.\u0275mod=d.Lb({type:e}),e.\u0275inj=d.Kb({factory:function(t){return new(t||e)},providers:[it,be.b],imports:[[i.c,o.d,de.d,c.j.forRoot(ne,{runtimeChecks:{strictStateImmutability:!1,strictActionImmutability:!1}}),C.forRoot({serializer:h}),r.c.forRoot([Ne,Ce]),Mt,a.a.instrument({maxAge:25,logOnly:k.a.production}),I.c,x.b.forRoot(),E.b.forRoot(),B.c.forRoot(),N.c.forRoot(),q.b.forRoot(),M.b.forRoot(),$.b.forRoot(),xe.a,R.b]]}),e}()},"8gf/":function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var i=n("mrSG"),o=n("fXoL"),c=n("tcrU"),a=n("bU/s"),r=n("XNiG"),s=n("xgIS"),l=n("1G5W"),b=n("Kj3r"),d=n("ZF+8"),u=n("M0ag"),f=n("TwVa"),p=n("ztEp"),h=n("ofXK"),m=n("0Iky"),g=n("cdP3"),v=n("RsUz"),j=n("3s35"),S=n("3Pt+"),y=n("s3T5"),O=["sqlEditor"];function w(e,t){if(1&e){var n=o.Ub();o.Tb(0,"button",36),o.bc("click",(function(){return o.vc(n),o.dc().onSave()})),o.Ec(1,"Save"),o.Sb()}if(2&e){var i=o.dc();o.jc("disabled",!i.isChanged)}}function T(e,t){if(1&e&&o.Ob(0,"wj-flex-grid-column",37),2&e){var n=t.$implicit;o.jc("header",n.headerText)("binding",n.bindingName)("dataType",n.dataType)}}function C(e,t){1&e&&(o.Tb(0,"div",38),o.Tb(1,"div",39),o.Tb(2,"span",40),o.Ec(3,"Loading..."),o.Sb(),o.Sb(),o.Sb())}var N=function(){function e(e,t,n){this.dbService=e,this.notificationService=t,this.dialogService=n,this.procedureChanged=new o.p,this.procedureSaved=new o.p,this.procedureDeleted=new o.p,this.isChanged=!1,this.data=null,this.fields=[],this.collection=new c.CollectionView,this.codeContentSize=50,this.parametersSize=30,this.modeState={code:!0,result:!0,parameters:!0},this.loading=!1,this.parameters=[],this.destroy$=new r.a}return e.prototype.ngOnInit=function(){var e=this;this.sqlEditor=Object(a.edit)(this.sqlElement.nativeElement,{mode:"ace/mode/sql",autoScrollEditorIntoView:!0,value:this.dataObject.sqlText||"",theme:Object(u.g)()}),Object(s.a)(this.sqlEditor,"change").pipe(Object(l.a)(this.destroy$),Object(b.a)(200)).subscribe((function(){var t=e.sqlEditor.getValue();e.isChanged=e.dataObject.sqlText!==t;var n=e.isChanged?{structure:Object(i.a)(Object(i.a)({},e.dataObject),{sqlText:t}),connection:e.connection}:null;e.procedureChanged.emit(n)})),this.collection.sourceCollection=(this.dataObject.parameters||[]).map((function(e){return{name:e.parameterName,value:null,isNullable:e.isNullable}}))},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.ngOnChanges=function(e){e.dataObject.firstChange||(this.isChanged=!1)},e.prototype.onRun=function(){return Object(i.b)(this,void 0,void 0,(function(){var e,t,n;return Object(i.e)(this,(function(i){switch(i.label){case 0:this.loading=!0,e=this.collection.sourceCollection.filter((function(e){return null!=e.value})).reduce((function(e,t){return e[t.name.replace("@","")]=t.value,e}),{}),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this.dbService.executeQuery(this.connection.connectionName,{commandType:"StoredProcedure",params:e,sql:this.dataObject.schemaName+"."+this.dataObject.objectName}).toPromise()];case 2:return t=i.sent(),this.fields=t.fields.map((function(e){return{bindingName:e.fieldName,dataType:f.SqlTypesToWijmoMap[f.DataTypeToSqlTypesMap[e.dataType]],headerText:e.fieldName}})),this.data=Object(p.fromTable)(t.table),[3,5];case 3:return n=i.sent(),this.data=null,this.notificationService.error(n),[3,5];case 4:return this.loading=!1,[7];case 5:return[2]}}))}))},e.prototype.onSave=function(){var e=this,t=this.sqlEditor.getValue();this.dbService.generateObject(this.connection.connectionName,Object(i.a)(Object(i.a)({},this.dataObject),{sqlText:t})).subscribe((function(t){e.procedureSaved.emit(t),e.notificationService.success("Procedure "+t.schemaName+"."+t.objectName+" saved")}),(function(t){return e.notificationService.error(t)}))},e.prototype.onDelete=function(){var e=this;if(this.dataObject){var t=this.dataObject,n=t.objectName,i=t.schemaName;this.dialogService.confirmation("Delete procedure "+i+"."+n+". Are you sure?").subscribe((function(t){t&&e.dbService.deleteObject(e.connection.connectionName,e.dataObject).subscribe((function(){e.notificationService.success("Procedure "+i+"."+n+" deleted"),e.procedureDeleted.emit()}),(function(t){return e.notificationService.error(t)}))}))}},e.prototype.onModeState=function(e){var t=this.modeState.parameters||this.modeState.result;this.codeContentSize=this.modeState.code&&!t?100:this.modeState.code&&t?50:0,this.parametersSize=this.modeState.parameters&&!this.modeState.result?100:this.modeState.parameters&&this.modeState.result?30:0},e.prototype.resize=function(){},e.\u0275fac=function(t){return new(t||e)(o.Nb(d.f),o.Nb(d.e),o.Nb(d.b))},e.\u0275cmp=o.Hb({type:e,selectors:[["app-db-procedure"]],viewQuery:function(e,t){var n;1&e&&o.Ac(O,!0),2&e&&o.rc(n=o.cc())&&(t.sqlElement=n.first)},inputs:{dataObject:"dataObject",connection:"connection",saveBtn:"saveBtn"},outputs:{procedureChanged:"procedureChanged",procedureSaved:"procedureSaved",procedureDeleted:"procedureDeleted"},features:[o.zb],decls:47,vars:35,consts:[[1,"mb-2","d-flex"],[1,"m-0","align-self-center"],[1,"row","mx-0","ml-auto"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-primary ml-2",3,"disabled","click",4,"ngIf"],[1,"btn","btn-secondary","ml-2",3,"click"],[3,"disabled","dataObject","grid"],[1,"card","overflow-hidden","mb-0","w-100","h-100"],[1,"card-body","d-flex","p-0","flex-column","h-100","position-relative"],[3,"useTransition","gutterSize","dragEnd","transitionEnd"],[1,"d-flex","mb-0","position-relative",3,"size"],["area0","asSplitArea"],["left","",1,"h-100","p-2","w-100"],["sqlEditor",""],[1,"d-flex","overflow-auto","flex-column","explorer-section",3,"size"],["area1","asSplitArea"],["direction","vertical","restrictMove","true",3,"useTransition","gutterSize"],[3,"size"],[1,"d-flex","flex-column","p-2"],[1,"mb-2"],["headersVisibility","Column",1,"h-100",3,"itemsSource","allowDelete","allowAddNew"],["header","Parameter","binding","name","dataType","String",3,"width","isReadOnly"],["header","Value","binding","value","width","*"],["header","Nullable","binding","isNullable","dataType","Boolean",3,"isReadOnly","width"],[1,"d-flex","flex-column","p-2","h-100"],[1,"h-100",3,"itemsSource","isReadOnly","itemsSourceChange"],["grid",""],[3,"header","binding","dataType",4,"ngFor","ngForOf"],[1,"btn-group","d-block","mode"],["ngDefaultControl","","btnCheckbox","","tabindex","0","role","button","name","mode-code","title","SQL Procedure panel",1,"btn","btn-secondary","btn-sm","cursor-pointer","mb-0",3,"ngModel","ngModelChange","click"],[1,"fa","fa-code","fa-lg"],["ngDefaultControl","","btnCheckbox","","tabindex","0","role","button","name","mode-result","title","Result panel",1,"btn","btn-secondary","btn-sm","cursor-pointer","mb-0",3,"ngModel","ngModelChange","click"],[1,"fa","fa-table","fa-lg"],["ngDefaultControl","","btnCheckbox","","tabindex","0","role","button","name","mode-parameters",1,"btn","btn-secondary","btn-sm","cursor-pointer","mb-0",3,"ngModel","ngModelChange","click"],[1,"fa","fa-check","fa-lg"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[1,"btn","btn-primary","ml-2",3,"disabled","click"],[3,"header","binding","dataType"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(e,t){if(1&e&&(o.Tb(0,"div",0),o.Tb(1,"h5",1),o.Ec(2),o.Sb(),o.Tb(3,"div",2),o.Tb(4,"button",3),o.bc("click",(function(){return t.onRun()})),o.Ec(5,"Run"),o.Sb(),o.Cc(6,w,2,1,"button",4),o.Tb(7,"button",5),o.bc("click",(function(){return t.onDelete()})),o.Ec(8,"Delete"),o.Sb(),o.Ob(9,"app-export-menu",6),o.Sb(),o.Sb(),o.Tb(10,"div",7),o.Tb(11,"div",8),o.Tb(12,"as-split",9),o.bc("dragEnd",(function(){return t.resize()}))("transitionEnd",(function(){return t.resize()})),o.Tb(13,"as-split-area",10,11),o.Ob(15,"div",12,13),o.Sb(),o.Tb(17,"as-split-area",14,15),o.Tb(19,"as-split",16),o.Tb(20,"as-split-area",17),o.Tb(21,"div",18),o.Tb(22,"h4",19),o.Ec(23,"Parameters"),o.Sb(),o.Tb(24,"wj-flex-grid",20),o.Ob(25,"wj-flex-grid-column",21),o.Ob(26,"wj-flex-grid-column",22),o.Ob(27,"wj-flex-grid-column",23),o.Sb(),o.Sb(),o.Sb(),o.Tb(28,"as-split-area",17),o.Tb(29,"div",24),o.Tb(30,"h4",19),o.Ec(31,"Result"),o.Sb(),o.Tb(32,"wj-flex-grid",25,26),o.bc("itemsSourceChange",(function(e){return t.data=e})),o.Cc(34,T,1,3,"wj-flex-grid-column",27),o.Ob(35,"wj-flex-grid-filter"),o.Sb(),o.Sb(),o.Sb(),o.Sb(),o.Sb(),o.Sb(),o.Sb(),o.Sb(),o.Tb(36,"div",28),o.Tb(37,"label",29),o.bc("ngModelChange",(function(e){return t.modeState.code=e}))("click",(function(){return t.onModeState("code")})),o.Ob(38,"i",30),o.Ec(39," SQL Procedure "),o.Sb(),o.Tb(40,"label",31),o.bc("ngModelChange",(function(e){return t.modeState.result=e}))("click",(function(){return t.onModeState("result")})),o.Ob(41,"i",32),o.Ec(42," Result "),o.Sb(),o.Tb(43,"label",33),o.bc("ngModelChange",(function(e){return t.modeState.parameters=e}))("click",(function(){return t.onModeState("parameters")})),o.Ob(44,"i",34),o.Ec(45," Parameters "),o.Sb(),o.Sb(),o.Cc(46,C,4,0,"div",35)),2&e){var n=o.sc(33);o.Bb(2),o.Hc("",t.dataObject.schemaName,".",t.dataObject.objectName,""),o.Bb(2),o.jc("disabled",t.isChanged),o.Bb(2),o.jc("ngIf",t.saveBtn),o.Bb(3),o.jc("disabled",!(null!=t.data&&t.data.length))("dataObject",t.dataObject)("grid",n),o.Bb(3),o.jc("useTransition",!0)("gutterSize",50===t.codeContentSize?11:0),o.Bb(1),o.jc("size",t.codeContentSize),o.Bb(4),o.jc("size",100-t.codeContentSize),o.Bb(2),o.jc("useTransition",!0)("gutterSize",30===t.parametersSize?11:0),o.Bb(1),o.jc("size",t.parametersSize),o.Bb(4),o.jc("itemsSource",t.collection)("allowDelete",!1)("allowAddNew",!1),o.Bb(1),o.jc("width",200)("isReadOnly",!0),o.Bb(2),o.jc("isReadOnly",!0)("width",70),o.Bb(1),o.jc("size",100-t.parametersSize),o.Bb(4),o.jc("itemsSource",t.data)("isReadOnly",!0),o.Bb(2),o.jc("ngForOf",t.fields),o.Bb(3),o.Fb("active",t.modeState.code),o.jc("ngModel",t.modeState.code),o.Bb(3),o.Fb("active",t.modeState.result),o.jc("ngModel",t.modeState.result),o.Bb(3),o.Fb("active",t.modeState.parameters),o.jc("ngModel",t.modeState.parameters),o.Bb(3),o.jc("ngIf",t.loading)}},directives:[h.m,m.a,g.c,g.b,v.a,v.c,h.l,j.a,S.b,y.a,S.i,S.l],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"]}),e}()},AXyZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));var i=n("fXoL"),o=n("XNiG"),c=n("2Vo4"),a=n("1G5W"),r=n("lJxs"),s=n("vkgz"),l=n("/uUt"),b=n("lMX+"),d=n("M0ag"),u=n("44PX"),f=n("j/Mj"),p=n("mrSG"),h=n("ztEp");function m(e,t,n){var i,o;void 0===n&&(n=!0);var c=e.added,a=e.edited,r=e.deleted,s=e.columns,l=[],b={oldValues:e.oldValues};if(a&&(l=Object(p.g)(l,a)),null==c?void 0:c.length)l=Object(p.g)(l,c.filter((function(e){return e})));else{var d=s;(null===(i=t.primaryKeys)||void 0===i?void 0:i.length)&&(d=Object(p.g)(null===(o=t.primaryKeys)||void 0===o?void 0:o.map((function(e){return e.fieldName})),s)),l=l.map((function(e){return d.reduce((function(t,n){return t[n]=e[n],t}),{})}))}if(l.length&&(b.data=l),r){var u=n?r.filter((function(e){return Boolean(e)})).map((function(e){var n,i=null===(n=t.primaryKeys)||void 0===n?void 0:n.map((function(e){return e.fieldName}));return(null==i?void 0:i.length)||(i=Object.keys(e)),i.reduce((function(t,n){var i=e[n];return i instanceof Date&&(i=Object(h.dateToString)(i)),t[n]=i,t}),{})})):r;u.length&&(b.dataToDelete=u)}return b}var g=n("tyNb"),v=n("ofXK"),j=n("EY2u"),S=n("tcrU"),y=n("iFvM"),O=n("TwVa"),w=n("ZF+8"),T=n("JIr8"),C=n("a5yf"),N=n("3Pt+"),x=n("RsUz"),B=n("dZIy"),E=["form"],q=["grid"];function M(e,t){if(1&e&&(i.Tb(0,"button",30),i.Ec(1,"Save"),i.Sb()),2&e){var n=i.dc(2);i.jc("disabled",!n.isChanged&&!n.isRenamedTable)}}function I(e,t){if(1&e){var n=i.Ub();i.Tb(0,"button",31),i.bc("click",(function(){return i.vc(n),i.dc(2).onTableDelete()})),i.Ec(1,"Delete"),i.Sb()}}function R(e,t){if(1&e){var n=i.Ub();i.Tb(0,"li",38),i.Tb(1,"a",39),i.bc("click",(function(){i.vc(n);var e=t.$implicit;return i.dc(4).onConnectionChange(e)})),i.Ec(2),i.Sb(),i.Sb()}if(2&e){var o=t.$implicit;i.Bb(2),i.Fc(o.connectionName)}}function $(e,t){if(1&e&&(i.Tb(0,"ul",36),i.Cc(1,R,3,1,"li",37),i.Sb()),2&e){var n=i.dc(3);i.Bb(1),i.jc("ngForOf",n.connections)}}function k(e,t){if(1&e&&(i.Tb(0,"div",32),i.Tb(1,"button",33),i.Ec(2),i.Ob(3,"span",34),i.Sb(),i.Cc(4,$,2,1,"ul",35),i.Sb()),2&e){var n=i.dc(2);i.Bb(2),i.Fc(n.connection.connectionName)}}function D(e,t){1&e&&(i.Tb(0,"div"),i.Ec(1,"Schema Name is required."),i.Sb())}function F(e,t){if(1&e&&(i.Tb(0,"div",40),i.Cc(1,D,2,0,"div",41),i.Sb()),2&e){i.dc();var n=i.sc(14);i.Bb(1),i.jc("ngIf",n.errors.required)}}function P(e,t){1&e&&(i.Tb(0,"div"),i.Ec(1,"Table Name is required."),i.Sb())}function z(e,t){if(1&e&&(i.Tb(0,"div",40),i.Cc(1,P,2,0,"div",41),i.Sb()),2&e){i.dc();var n=i.sc(20);i.Bb(1),i.jc("ngIf",n.errors.required)}}function L(e,t){if(1&e){var n=i.Ub();i.Tb(0,"form",1,2),i.bc("ngSubmit",(function(){return i.vc(n),i.dc().onSubmit()})),i.Tb(2,"div",3),i.Tb(3,"h5",4),i.Ec(4,"Table Information"),i.Sb(),i.Tb(5,"div",5),i.Cc(6,M,2,1,"button",6),i.Cc(7,I,2,0,"button",7),i.Cc(8,k,5,1,"div",8),i.Sb(),i.Sb(),i.Tb(9,"div",9),i.Tb(10,"div",10),i.Tb(11,"label",11),i.Ec(12,"Schema"),i.Sb(),i.Tb(13,"input",12,13),i.bc("input",(function(){return i.vc(n),i.dc().onUpdate()}))("ngModelChange",(function(e){return i.vc(n),i.dc().dataObjectForm.schemaName=e})),i.Sb(),i.Cc(15,F,2,1,"div",14),i.Sb(),i.Tb(16,"div",15),i.Tb(17,"label",16),i.Ec(18,"Table Name"),i.Sb(),i.Tb(19,"input",17,18),i.bc("input",(function(){return i.vc(n),i.dc().onUpdate()}))("ngModelChange",(function(e){return i.vc(n),i.dc().dataObjectForm.objectName=e})),i.Sb(),i.Cc(21,z,2,1,"div",14),i.Sb(),i.Sb(),i.Tb(22,"div",19),i.Tb(23,"h5",20),i.Ec(24,"Define Table Fields"),i.Sb(),i.Tb(25,"div",21),i.Tb(26,"wj-flex-grid",22,23),i.bc("initialized",(function(){i.vc(n);var e=i.sc(27);return i.dc().initializedGrid(e)}))("deletedRow",(function(){return i.vc(n),i.dc().onUpdate()})),i.Ob(28,"wj-flex-grid-column",24),i.Ob(29,"wj-flex-grid-column",25),i.Ob(30,"wj-flex-grid-column",26),i.Ob(31,"wj-flex-grid-column",27),i.Ob(32,"wj-flex-grid-column",28),i.Ob(33,"wj-flex-grid-column",29),i.Sb(),i.Sb(),i.Sb(),i.Sb()}if(2&e){var o=i.sc(14),c=i.sc(20),a=i.dc();i.Bb(6),i.jc("ngIf",a.saveBtn),i.Bb(1),i.jc("ngIf",a.dataObject.objectName),i.Bb(1),i.jc("ngIf",!a.dataObject.objectName),i.Bb(5),i.jc("ngModel",a.dataObjectForm.schemaName),i.Bb(2),i.jc("ngIf",o.invalid&&(o.dirty||o.touched)),i.Bb(4),i.jc("ngModel",a.dataObjectForm.objectName),i.Bb(2),i.jc("ngIf",c.invalid&&(c.dirty||c.touched)),i.Bb(5),i.jc("itemsSource",a.collection)("allowDelete",!0)("allowAddNew",!0)("itemFormatter",a.formatItem),i.Bb(2),i.jc("width",50),i.Bb(1),i.jc("minWidth",50)("width","*"),i.Bb(1),i.jc("dataMap",a.dataTypes),i.Bb(1),i.jc("width",70),i.Bb(1),i.jc("width",90),i.Bb(1),i.jc("width",70)}}var U=function(){function e(e,t,n){var c=this;this.dialogService=e,this.dbService=t,this.notificationService=n,this.dataTypes=Object.values(O.SQLDataTypes),this.update=new i.p,this.deletedTable=new i.p,this.tableSaved=new i.p,this.collection=new S.CollectionView,this.renamedFields=new Map,this.editCollectionMap=new Map,this.addCollectionSet=new Set,this.destroy$=new o.a,this.formatItem=function(e,t,n,i){var o=e.rows[t].dataItem,a=e.columns[n].binding,r=c.editCollectionMap.get(o);e.cellType===b.CellType.Cell&&o&&(c.addCollectionSet.has(o)?i.classList.add("added-item"):r&&r.hasOwnProperty(a)?i.classList.add("edited-item"):(i.classList.remove("added-item"),i.classList.remove("edited-item")))}}return e.prototype.ngOnInit=function(){this.setDataObjectForm();var e=Object(d.l)(this.dataObject);Object(d.n)(Object(y.o)(this.collection.items),e)||(this.collection.sourceCollection=e)},e.prototype.ngOnChanges=function(e){var t=e.dataObject;t&&!t.firstChange&&this.setDataObjectForm()},e.prototype.onConnectionChange=function(e){this.connection=e,this.dataObjectForm.schemaName=e.defaultSchema},e.prototype.setDataObjectForm=function(){this.dataObjectForm=Object(p.a)({},this.dataObject),null===this.dataObjectForm.schemaName&&(this.dataObjectForm.schemaName=this.connection.defaultSchema)},e.prototype.initializedGrid=function(e){var t=this;this.gridContext=Object(C.c)(e),e.cellEditEnding.addHandler((function(e){var n=t.collection.currentEditItem;!0===n.isNullable?(n.isKey=!1,t.collection.editItem(n)):!0===n.isKey&&(n.isNullable=!1,t.collection.editItem(n))})),e.cellEditEnded.addHandler((function(e){return t.changeHandler()})),e.deletedRow.addHandler((function(){return t.changeHandler()})),this.collection.trackChanges=!0},e.prototype.changeHandler=function(){var e,t,n,i=this,o=m(this.gridContext.state,this.dataObject);this.isChanged=Boolean((null===(e=o.data)||void 0===e?void 0:e.length)||(null===(t=o.dataToDelete)||void 0===t?void 0:t.length)),this.renamedFields.clear(),null===(n=o.oldValues)||void 0===n||n.forEach((function(e,t){e.hasOwnProperty("fieldName")&&i.renamedFields.set(o.data[t].fieldName,e.fieldName)})),this.onUpdate()},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.onUpdate=function(){this.isRenamedTable=this.dataObject.objectName!==this.dataObjectForm.objectName||this.dataObject.schemaName!==this.dataObjectForm.schemaName,this.update.emit(this.getCurrentState())},e.prototype.onTableDelete=function(){var e=this;if(this.dataObject){var t=this.dataObject,n=t.objectName,i=t.schemaName;this.dialogService.confirmation("Delete table "+i+"."+n+". Are you sure?").subscribe((function(t){t&&e.dbService.deleteObject(e.connection.connectionName,e.dataObject).pipe(Object(s.a)((function(){e.notificationService.success("Table "+i+"."+n+" deleted."),e.deletedTable.emit()})),Object(T.a)((function(t){return e.notificationService.error(t),j.a}))).toPromise()}))}},e.prototype.onSubmit=function(){var e=this;if(this.form.valid){var t=this.dataObject.objectName?this.dataObject.schemaName+"."+this.dataObject.objectName:null;this.dbService.generateObject(this.connection.connectionName,this.getCurrentState(),t).subscribe((function(t){e.tableSaved.emit(t),e.gridContext.clear(),e.isChanged=!1,e.grid.refresh(!0),e.notificationService.success("Table "+t.schemaName+"."+t.objectName+" saved")}),(function(t){return e.notificationService.error(t)}))}},e.prototype.getCurrentState=function(){return Object(p.a)(Object(p.a)({},this.dataObjectForm),{fields:Object(y.p)(this.collection.items,this.renamedFields),primaryKeys:Object(y.s)(this.collection.items)})},e.\u0275fac=function(t){return new(t||e)(i.Nb(w.b),i.Nb(w.f),i.Nb(w.e))},e.\u0275cmp=i.Hb({type:e,selectors:[["app-structure-editor"]],viewQuery:function(e,t){var n;1&e&&(i.Jc(E,!0),i.Jc(q,!0)),2&e&&(i.rc(n=i.cc())&&(t.form=n.first),i.rc(n=i.cc())&&(t.grid=n.first))},inputs:{dataObject:"dataObject",saveBtn:"saveBtn",connection:"connection",connections:"connections"},outputs:{update:"update",deletedTable:"deletedTable",tableSaved:"tableSaved"},features:[i.zb],decls:1,vars:1,consts:[["class","d-flex flex-column h-100 overflow-hidden",3,"ngSubmit",4,"ngIf"],[1,"d-flex","flex-column","h-100","overflow-hidden",3,"ngSubmit"],["form","ngForm"],[1,"row","mx-0"],[1,"px-0"],[1,"row","ml-auto","mr-0"],["type","submit","class","btn btn-primary mr-1",3,"disabled",4,"ngIf"],["type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["class","btn-group","dropdown","",4,"ngIf"],[1,"row","mx-0",2,"max-width","750px"],[1,"form-group","col-sm-3","px-0","mb-2"],["for","schemaName"],["type","text","id","schemaName","required","","name","schemaName","placeholder","Enter shema name",1,"form-control",3,"ngModel","input","ngModelChange"],["schemaName","ngModel"],["class","alert alert-danger py-1 px-2 m-0 w-100",4,"ngIf"],[1,"form-group","col-sm-9","px-0","pl-md-2","mb-2"],["for","name"],["type","text","id","objectName","required","","name","objectName","placeholder","Enter Table name",1,"form-control",3,"ngModel","input","ngModelChange"],["objectName","ngModel"],[1,"d-flex","flex-fill","mx-0","flex-column","h-100","overflow-hidden",2,"max-width","750px"],[1,"col-sm-12","table-title","px-0"],[1,"col","fields-container","d-flex","h-100","px-0","mb-2","overflow-hidden"],[1,"h-100",3,"itemsSource","allowDelete","allowAddNew","itemFormatter","initialized","deletedRow"],["grid",""],["header","IsKey","binding","isKey","dataType","Boolean",3,"width"],["header","Field Name","binding","fieldName",3,"minWidth","width"],["header","Field Data Type","binding","dataType",3,"dataMap"],["header","Size","binding","size","dataType","Number",3,"width"],["header","Allow Nulls","binding","isNullable","dataType","Boolean",3,"width"],["header","Identity","binding","isIdentity","dataType","Boolean",3,"width"],["type","submit",1,"btn","btn-primary","mr-1",3,"disabled"],["type","button",1,"btn","btn-secondary",3,"click"],["dropdown","",1,"btn-group"],["id","button-basic","dropdownToggle","","type","button","aria-controls","dropdown-basic",1,"btn","btn-primary","dropdown-toggle"],[1,"caret"],["id","dropdown-basic","class","dropdown-menu","role","menu","aria-labelledby","button-basic",4,"dropdownMenu"],["id","dropdown-basic","role","menu","aria-labelledby","button-basic",1,"dropdown-menu"],["role","menuitem",4,"ngFor","ngForOf"],["role","menuitem"],[1,"dropdown-item",3,"click"],[1,"alert","alert-danger","py-1","px-2","m-0","w-100"],[4,"ngIf"]],template:function(e,t){1&e&&i.Cc(0,L,34,18,"form",0),2&e&&i.jc("ngIf",t.dataObjectForm)},directives:[v.m,N.t,N.j,N.k,N.b,N.q,N.i,N.l,x.a,x.c,B.a,B.d,B.b,v.l],styles:[".table-title[_ngcontent-%COMP%] {\n      flex: 0;\n    }"]}),e}(),A=n("Xwp4");function H(e,t){if(1&e){var n=i.Ub();i.Tb(0,"app-rows-limit",8),i.bc("limitChange",(function(e){return i.vc(n),i.dc().onLimitRowsChange(e)}))("count",(function(e){return i.vc(n),i.dc().rowsCount=e}))("sortByChange",(function(e){return i.vc(n),i.dc().onSortChange(e)})),i.Sb()}if(2&e){var o=i.dc();i.jc("connection",o.connection)("sqlObject",o.dataObject)}}function X(e,t){if(1&e&&(i.Ob(0,"i",9),i.Ec(1),i.ec(2,"async")),2&e){var n=i.dc();i.Bb(1),i.Gc(" Structure ",i.fc(2,1,n.isStructureChanged$)?"*":""," ")}}function Q(e,t){if(1&e&&(i.Tb(0,"h5"),i.Ec(1),i.Sb()),2&e){var n=t.$implicit;i.Bb(1),i.Fc(n)}}function V(e,t){if(1&e&&(i.Tb(0,"div",10),i.Tb(1,"div",11),i.Tb(2,"span",12),i.Ec(3,"Loading..."),i.Sb(),i.Sb(),i.Cc(4,Q,2,1,"h5",13),i.Sb()),2&e){var n=t.ngIf;i.Bb(4),i.jc("ngForOf",n.messages)}}function K(e,t){if(1&e&&(i.Ob(0,"i",14),i.Ec(1),i.ec(2,"async")),2&e){var n=i.dc();i.Bb(1),i.Gc(" Data ",i.fc(2,1,n.isDataChanged$)?"*":""," ")}}function G(e,t){if(1&e){var n=i.Ub();i.Tb(0,"dc-db-grid",15),i.bc("eventHandlers",(function(e){return i.vc(n),i.dc().eventHandler(e)})),i.Sb()}if(2&e){var o=i.dc();i.jc("uiModel",o.gridUIModel)}}var _=function(){function e(e,t){this.route=e,this.router=t,this.tableChange=new i.p,this.tableSaved=new i.p,this.deleted=new i.p,this.savedToNewTable=new i.p,this.loading$=new o.a,this.destroy$=new o.a,this.dataState$=new c.a({}),this.limitRowsCount=1e3,this.rowsCount=0,this.sortBy=[],this.dataTabShown=!1,this.gridUIModel={type:"db-grid",itemProperties:{tableSource:{connection:null,name:null,alias:null},showHeaderRowFilter:!0,showHeader:!0,onChange:"change(gridContext)",onSaveToNewTable:"toNewTable()",isReadOnly:!1,selectionMode:b.SelectionMode.Cell,showMenu:!0,showFooterRow:!0}}}return e.prototype.ngOnInit=function(){var e=this;this.gridUIModel.itemProperties.tableSource.connection=this.connection.connectionName,this.gridUIModel.itemProperties.tableSource.name=this.dataObject.schemaName+"."+this.dataObject.objectName,this.gridUIModel.itemProperties.limitRows=this.limitRowsCount,this.gridUIModel.itemProperties.orderBy=this.sortBy,this.route.queryParams.pipe(Object(a.a)(this.destroy$)).subscribe((function(t){var n="data"===t.tab;n&&!e.dataTabShown&&(e.dataTabShown=!0),e.tabs.tabs[+n].active=!0})),this.dataObjectState$=new c.a(this.dataObject),this.isStructureChanged$=this.dataObjectState$.pipe(Object(r.a)((function(t){return!Object(d.e)(e.dataObject,t)})),Object(s.a)((function(t){e.dataObjectState=t?e.dataObjectState$.value:null,e.emitChange()})),Object(l.a)()),this.isDataChanged$=this.dataState$.pipe(Object(s.a)((function(t){e.dataState=t,e.emitChange()})),Object(r.a)((function(e){var t,n;return Boolean((null===(t=e.data)||void 0===t?void 0:t.length)||(null===(n=e.dataToDelete)||void 0===n?void 0:n.length))})),Object(l.a)())},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.onSortChange=function(e){var t;this.gridUIModel.itemProperties.orderBy=e,null===(t=this.grid)||void 0===t||t.refresh()},e.prototype.onLimitRowsChange=function(e){var t;this.gridUIModel.itemProperties.limitRows=e,null===(t=this.grid)||void 0===t||t.refresh()},e.prototype.ngOnChanges=function(e){var t=e.dataObject;t&&!t.firstChange&&this.dataObjectState$.next(t.currentValue)},e.prototype.eventHandler=function(e){if("change"===e.eventName){var t=m(e.parameters.gridContext.state,this.dataObjectState$.value);this.dataState$.next(t)}else"toNewTable"===e.eventName&&this.savedToNewTable.emit()},e.prototype.onSave=function(e){this.tableSaved.emit(e)},e.prototype.tabSelect=function(e){this.router.navigate([],{queryParamsHandling:"merge",queryParams:{tab:e},relativeTo:this.route})},e.prototype.emitChange=function(){this.dataObjectState||this.dataState&&Object.keys(this.dataState).length?this.tableChange.emit({connection:this.connection,structureChange:this.dataObjectState,dataChange:this.dataState,structure:this.dataObject}):this.tableChange.emit(null)},e.\u0275fac=function(t){return new(t||e)(i.Nb(g.a),i.Nb(g.f))},e.\u0275cmp=i.Hb({type:e,selectors:[["app-db-table"]],viewQuery:function(e,t){var n;1&e&&(i.Ac(u.d,!0),i.Jc(f.a,!0)),2&e&&(i.rc(n=i.cc())&&(t.tabs=n.first),i.rc(n=i.cc())&&(t.grid=n.first))},inputs:{dataObject:"dataObject",connection:"connection",connections:"connections",saveBtn:"saveBtn"},outputs:{tableChange:"tableChange",tableSaved:"tableSaved",deleted:"deleted",savedToNewTable:"savedToNewTable"},features:[i.zb],decls:10,vars:9,consts:[[3,"connection","sqlObject","limitChange","count","sortByChange",4,"ngIf"],[1,"tabset-fx","nav-tabs-boxed"],[1,"position-relative",3,"selectTab"],["tabHeading",""],[1,"w-100","h-100",3,"saveBtn","dataObject","connection","connections","update","deletedTable","tableSaved"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[3,"selectTab"],["class","h-100 d-flex position-relative",3,"uiModel","eventHandlers",4,"ngIf"],[3,"connection","sqlObject","limitChange","count","sortByChange"],[1,"fa","fa-cogs","fa-lg"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"],[4,"ngFor","ngForOf"],[1,"fa","fa-table","fa-lg"],[1,"h-100","d-flex","position-relative",3,"uiModel","eventHandlers"]],template:function(e,t){1&e&&(i.Cc(0,H,1,2,"app-rows-limit",0),i.Tb(1,"tabset",1),i.Tb(2,"tab",2),i.bc("selectTab",(function(){return t.tabSelect("structure")})),i.Cc(3,X,3,3,"ng-template",3),i.Tb(4,"app-structure-editor",4),i.bc("update",(function(e){return t.dataObjectState$.next(e)}))("deletedTable",(function(){return t.deleted.emit()}))("tableSaved",(function(e){return t.onSave(e)})),i.Sb(),i.Cc(5,V,5,1,"div",5),i.ec(6,"async"),i.Sb(),i.Tb(7,"tab",6),i.bc("selectTab",(function(){return t.tabSelect("data")})),i.Cc(8,K,3,3,"ng-template",3),i.Cc(9,G,1,1,"dc-db-grid",7),i.Sb(),i.Sb()),2&e&&(i.jc("ngIf",t.dataObject),i.Bb(4),i.jc("saveBtn",t.saveBtn)("dataObject",t.dataObject)("connection",t.connection)("connections",t.connections),i.Bb(1),i.jc("ngIf",i.fc(6,7,t.loading$)),i.Bb(4),i.jc("ngIf",t.dataTabShown))},directives:[v.m,u.d,u.a,u.b,U,A.a,v.l,f.a],pipes:[v.b],styles:["tabset.sql-object-tab[_ngcontent-%COMP%] > .tab-content[_ngcontent-%COMP%]{position:relative}.spinner[_ngcontent-%COMP%]{left:0}"]}),e}()},FbUF:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var i=n("fXoL"),o=n("bU/s"),c=n("LRne"),a=n("JIr8"),r=n("lMX+"),s=n("M0ag"),l=n("TwVa"),b=n("ztEp"),d=n("efbX"),u=n("ZF+8"),f=n("dZIy"),p=n("ofXK"),h=n("0Iky"),m=n("Yh5v"),g=n("psEu"),v=["sqlElement"],j=["dcGrid"];function S(e,t){if(1&e){var n=i.Ub();i.Tb(0,"li",22),i.Tb(1,"a",23),i.bc("click",(function(){i.vc(n);var e=t.$implicit;return i.dc(2).connection=e.connectionName})),i.Ec(2),i.Sb(),i.Sb()}if(2&e){var o=t.$implicit;i.Bb(2),i.Fc(o.connectionName)}}function y(e,t){if(1&e&&(i.Tb(0,"ul",20),i.Cc(1,S,3,1,"li",21),i.Sb()),2&e){var n=i.dc();i.Bb(1),i.jc("ngForOf",n.connections)}}function O(e,t){if(1&e&&(i.Tb(0,"span",24),i.Ec(1),i.Sb()),2&e){var n=i.dc();i.Bb(1),i.Gc("",n.data.length," rows")}}function w(e,t){1&e&&(i.Tb(0,"div",25),i.Tb(1,"div",26),i.Tb(2,"span",27),i.Ec(3,"Loading..."),i.Sb(),i.Sb(),i.Sb())}function T(e,t){if(1&e&&(i.Tb(0,"alert",28),i.Tb(1,"strong"),i.Ec(2,"Error:"),i.Sb(),i.Ec(3),i.Sb()),2&e){var n=i.dc();i.Bb(3),i.Gc(" ",n.error," ")}}function C(e,t){if(1&e&&i.Ob(0,"dc-grid",29,30),2&e){var n=i.dc();i.jc("uiModel",n.gridUIModel)("dataModel",n.dataModel)}}var N=function(){function e(e){this.sqlDbService=e,this.executedQuery=new i.p,this.executed=!1,this.loading=!1,this.gridUIModel={type:"grid",itemProperties:{headersVisibility:r.HeadersVisibility.All,binding:"$.data",footer:!1,isReadOnly:!0,selectionMode:r.SelectionMode.MultiRange}},this.dataModel={data:[]}}return e.prototype.handleKeyboardEvent=function(e){("F5"===e.key||e.ctrlKey&&"Enter"===e.key)&&(e.preventDefault(),e.stopImmediatePropagation(),this.onRun())},e.prototype.ngOnInit=function(){this.connection=this.defaultConnection||this.connections[0].connectionName,this.sqlEditor=Object(o.edit)(this.sqlElement.nativeElement,{mode:"ace/mode/sql",autoScrollEditorIntoView:!0,theme:Object(s.g)()})},e.prototype.onRun=function(){var e=this;this.loading=!0,this.sqlDbService.executeQuery(this.connection,{sql:this.sqlEditor.getSelectedText()||this.sqlEditor.getValue()}).pipe(Object(a.a)((function(t){return e.error="string"==typeof t.error?t.error:"Failed to query data.",Object(c.a)(null)}))).subscribe((function(t){t?(e.error=null,e.fields=t.fields.map((function(e){return{bindingName:e.fieldName,dataType:l.SqlTypesToWijmoMap[e.dataType],headerText:e.fieldName}})),e.data=Object(b.fromTable)(t.table),e.executedQuery.emit()):(e.fields=null,e.data=null),e.gridUIModel.itemProperties.columns=e.fields,e.dataModel.data=e.data,e.executed=!0,e.loading=!1,setTimeout((function(){var t;e.grid=null===(t=e.dcGrid)||void 0===t?void 0:t.grid}))}))},e.\u0275fac=function(t){return new(t||e)(i.Nb(u.f))},e.\u0275cmp=i.Hb({type:e,selectors:[["app-db-query"]],viewQuery:function(e,t){var n;1&e&&(i.Ac(v,!0),i.Jc(j,!0)),2&e&&(i.rc(n=i.cc())&&(t.sqlElement=n.first),i.rc(n=i.cc())&&(t.dcGrid=n.first))},hostBindings:function(e,t){1&e&&i.bc("keydown",(function(e){return t.handleKeyboardEvent(e)}),!1,i.tc)},inputs:{connections:"connections",defaultConnection:"defaultConnection"},outputs:{executedQuery:"executedQuery"},decls:25,vars:7,consts:[[1,"row","mx-0","mb-2"],[1,"mb-0","align-self-center"],["dropdown","",1,"ml-auto","btn-group"],["id","button-basic","dropdownToggle","","type","button","aria-controls","dropdown-basic",1,"btn","btn-primary","dropdown-toggle"],[1,"caret"],["id","dropdown-basic","class","dropdown-menu","role","menu","aria-labelledby","button-basic",4,"dropdownMenu"],["class","mx-1 align-self-center",4,"ngIf"],["type","button",1,"btn","btn-primary","mx-1",3,"click"],[3,"grid","disabled"],[1,"h-100","overflow-hidden"],["left","",1,"w-100"],["sqlElement",""],["right",""],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner",4,"ngIf"],["type","danger",4,"ngIf"],[3,"uiModel","dataModel",4,"ngIf"],["left-label",""],[1,"fa","fa-cogs","fa-lg"],["right-label",""],[1,"fa","fa-table","fa-lg"],["id","dropdown-basic","role","menu","aria-labelledby","button-basic",1,"dropdown-menu"],["role","menuitem",4,"ngFor","ngForOf"],["role","menuitem"],[1,"dropdown-item",3,"click"],[1,"mx-1","align-self-center"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner"],["role","status",1,"spinner-border"],[1,"sr-only"],["type","danger"],[3,"uiModel","dataModel"],["dcGrid",""]],template:function(e,t){1&e&&(i.Tb(0,"div",0),i.Tb(1,"h5",1),i.Ec(2,"Sql Query"),i.Sb(),i.Tb(3,"div",2),i.Tb(4,"button",3),i.Ec(5),i.Ob(6,"span",4),i.Sb(),i.Cc(7,y,2,1,"ul",5),i.Sb(),i.Cc(8,O,2,1,"span",6),i.Tb(9,"button",7),i.bc("click",(function(){return t.onRun()})),i.Ec(10,"Run"),i.Sb(),i.Ob(11,"app-export-menu",8),i.Sb(),i.Tb(12,"app-split-content",9),i.Ob(13,"div",10,11),i.Rb(15,12),i.Cc(16,w,4,0,"div",13),i.Cc(17,T,4,1,"alert",14),i.Cc(18,C,2,2,"dc-grid",15),i.Qb(),i.Rb(19,16),i.Ob(20,"i",17),i.Ec(21," SQL "),i.Qb(),i.Rb(22,18),i.Ob(23,"i",19),i.Ec(24," Data "),i.Qb(),i.Sb()),2&e&&(i.Bb(5),i.Fc(t.connection),i.Bb(3),i.jc("ngIf",null==t.data?null:t.data.length),i.Bb(3),i.jc("grid",t.grid)("disabled",!t.grid||!(null!=t.data&&t.data.length)),i.Bb(5),i.jc("ngIf",t.loading),i.Bb(1),i.jc("ngIf",t.error),i.Bb(1),i.jc("ngIf",t.executed&&!t.error))},directives:[f.a,f.d,f.b,p.m,h.a,m.a,p.l,g.a,d.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"]}),e}()},Xwp4:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("mrSG"),o=n("fXoL"),c=n("XNiG"),a=n("EDFS"),r=n("ZF+8"),s=n("9Ejp"),l=n("3Pt+"),b=n("ofXK"),d=n("dZIy"),u=["pop"];function f(e,t){if(1&e&&(o.Tb(0,"span",8),o.Ec(1),o.Sb()),2&e){var n=o.dc();o.Bb(1),o.Fc(n.sortByList)}}function p(e,t){if(1&e){var n=o.Ub();o.Tb(0,"li",20),o.Ec(1),o.Tb(2,"select",21),o.bc("ngModelChange",(function(e){return o.vc(n),t.$implicit.direction=e})),o.Tb(3,"option",22),o.Ec(4,"DESC"),o.Sb(),o.Tb(5,"option",23),o.Ec(6,"ASC"),o.Sb(),o.Sb(),o.Ob(7,"i",24),o.Tb(8,"i",25),o.bc("click",(function(e){o.vc(n);var i=t.index;return o.dc(2).removeField(e,i)})),o.Sb(),o.Sb()}if(2&e){var i=t.$implicit;o.Bb(1),o.Gc(" ",i.fieldName," "),o.Bb(1),o.jc("ngModel",i.direction)}}function h(e,t){if(1&e){var n=o.Ub();o.Tb(0,"li",28),o.Tb(1,"a",29),o.bc("click",(function(){o.vc(n);var e=t.$implicit;return o.dc(3).addField(e)})),o.Ec(2),o.Sb(),o.Sb()}if(2&e){var i=t.$implicit;o.Bb(2),o.Fc(i.fieldName)}}function m(e,t){if(1&e&&(o.Tb(0,"ul",26),o.Cc(1,h,3,1,"li",27),o.Sb()),2&e){var n=o.dc(2);o.Bb(1),o.jc("ngForOf",n.fields)}}function g(e,t){if(1&e){var n=o.Ub();o.Tb(0,"div",9),o.Tb(1,"h4",10),o.Ec(2,"Manage Sort By"),o.Sb(),o.Tb(3,"div",11),o.Tb(4,"ul",12),o.bc("dragulaModelChange",(function(e){return o.vc(n),o.dc().sortBy=e})),o.Cc(5,p,9,2,"li",13),o.Sb(),o.Tb(6,"div",14),o.Tb(7,"button",15),o.Ec(8,"Add field "),o.Sb(),o.Cc(9,m,2,1,"ul",16),o.Sb(),o.Sb(),o.Tb(10,"div",17),o.Tb(11,"button",18),o.bc("click",(function(){return o.vc(n),o.dc().onApply()})),o.Ec(12,"Apply"),o.Sb(),o.Tb(13,"button",19),o.bc("click",(function(){return o.vc(n),o.dc().onCancel()})),o.Ec(14,"Cancel"),o.Sb(),o.Sb(),o.Sb()}if(2&e){var i=o.dc();o.Bb(4),o.jc("dragula",i.getKey()+"-sortBy")("dragulaModel",i.sortBy),o.Bb(1),o.jc("ngForOf",i.sortBy),o.Bb(2),o.jc("disabled",!i.fields.length)}}var v=function(){function e(e,t,n){this.dbService=e,this.dragulaService=t,this.notificationService=n,this.limitChange=new o.p,this.count=new o.p,this.sortByChange=new o.p,this.sortBy=[],this.appliedSortBy=[],this.destroy$=new c.a}return e.prototype.ngOnInit=function(){var e=this;this.sqlObject.objectName&&(this.fields=this.sqlObject.fields,this.loadRowsCount()),this.pop.onHidden.subscribe((function(){e.sortBy=Object(i.g)(e.appliedSortBy)})),this.dragulaService.createGroup(this.getKey()+"-sortBy",{moves:function(e,t,n){return n.classList.contains("handle")}})},e.prototype.ngOnDestroy=function(){this.dragulaService.destroy(this.getKey()+"-sortBy"),this.destroy$.next(),this.destroy$.complete()},e.prototype.loadRowsCount=function(){var e=this;this.dbService.selectSqlObjectData$(this.connection.connectionName,this.sqlObject.schemaName,this.sqlObject.objectName,{fields:["count(1) Count"]}).subscribe((function(t){e.rowsCount=t.rows[0][0],e.count.emit(e.rowsCount)}),(function(t){return e.notificationService.error(t)}))},e.prototype.onRowsCountSelect=function(e){this.limitChange.emit(+e.target.value)},e.prototype.addField=function(e){this.sortBy.push({fieldName:e.fieldName,direction:"ASC"})},e.prototype.onApply=function(){this.appliedSortBy=Object(i.g)(this.sortBy),this.sortByChange.emit(this.appliedSortBy),this.pop.hide(),this.sortByList=this.appliedSortBy.map((function(e){return e.fieldName+" "+e.direction})).join(", ")},e.prototype.onCancel=function(){this.pop.hide()},e.prototype.removeField=function(e,t){e.stopImmediatePropagation(),this.sortBy.splice(t,1)},e.prototype.getKey=function(){return this.connection.connectionName+this.sqlObject.schemaName+this.sqlObject.objectName},e.\u0275fac=function(t){return new(t||e)(o.Nb(r.f),o.Nb(s.c),o.Nb(r.e))},e.\u0275cmp=o.Hb({type:e,selectors:[["app-rows-limit"]],viewQuery:function(e,t){var n;1&e&&o.Ac(u,!0),2&e&&o.rc(n=o.cc())&&(t.pop=n.first)},inputs:{connection:"connection",sqlObject:"sqlObject",fields:"fields"},outputs:{limitChange:"limitChange",count:"count",sortByChange:"sortByChange"},decls:21,vars:6,consts:[[1,"rows-count","pr-2"],["value","1000",1,"form-control","py-0",3,"change"],["value",""],["containerClass","sort-by-popover","placement","bottom","container","body",1,"mx-2","cursor-pointer",3,"popover","outsideClick"],["pop","bs-popover"],["class","form-control form-control-sm d-inline",4,"ngIf"],[1,"fa","fa-angle-down"],["popTemplate",""],[1,"form-control","form-control-sm","d-inline"],[1,"d-flex","flex-column"],[1,"pull-left"],[1,"d-flex","flex-column","h-100"],[1,"container",3,"dragula","dragulaModel","dragulaModelChange"],["class","row py-1 my-1 pl-2 border rounded align-items-baseline",4,"ngFor","ngForOf"],["dropdown","",1,"btn-group","mr-2","mb-2","align-self-baseline"],["id","button-basic","dropdownToggle","","type","button","aria-controls","dropdown-basic",1,"btn","btn-primary","dropdown-toggle","align-self-baseline","btn-sm",3,"disabled"],["id","dropdown-basic","class","dropdown-menu overflow-auto","role","menu","aria-labelledby","button-basic",4,"dropdownMenu"],[1,"row","w-100","mx-0","px-0"],["type","button",1,"btn","btn-primary","ml-auto","mr-2",3,"click"],["type","button",1,"btn","btn-light",3,"click"],[1,"row","py-1","my-1","pl-2","border","rounded","align-items-baseline"],[1,"form-control","form-control-sm","ml-3","select-direction",3,"ngModel","ngModelChange"],["value","DESC"],["value","ASC","selected",""],[1,"fa","fa-arrows","ml-auto","handle"],[1,"fa","fa-remove","mx-2","cursor-pointer",3,"click"],["id","dropdown-basic","role","menu","aria-labelledby","button-basic",1,"dropdown-menu","overflow-auto"],["role","menuitem",4,"ngFor","ngForOf"],["role","menuitem"],[1,"dropdown-item","cursor-pointer",3,"click"]],template:function(e,t){if(1&e&&(o.Tb(0,"div",0),o.Ec(1,"Show max "),o.Tb(2,"select",1),o.bc("change",(function(e){return t.onRowsCountSelect(e)})),o.Tb(3,"option"),o.Ec(4,"1000"),o.Sb(),o.Tb(5,"option"),o.Ec(6,"10000"),o.Sb(),o.Tb(7,"option"),o.Ec(8,"50000"),o.Sb(),o.Tb(9,"option",2),o.Ec(10,"ALL"),o.Sb(),o.Sb(),o.Ec(11," rows. "),o.Tb(12,"span",3,4),o.Ec(14," Sort By "),o.Cc(15,f,2,1,"span",5),o.Ob(16,"i",6),o.Sb(),o.Ec(17),o.ec(18,"number"),o.Sb(),o.Cc(19,g,15,4,"ng-template",null,7,o.Dc)),2&e){var n=o.sc(20);o.Bb(12),o.jc("popover",n)("outsideClick",!0),o.Bb(3),o.jc("ngIf",t.sortByList),o.Bb(2),o.Gc(" Total ",o.fc(18,4,t.rowsCount)," rows.")}},directives:[l.m,l.s,a.a,b.m,s.a,b.l,d.a,d.d,d.b,l.r,l.i,l.l],pipes:[b.f],styles:["[_nghost-%COMP%]{display:flex}.rows-count[_ngcontent-%COMP%]{position:absolute;right:0;z-index:11}.rows-count[_ngcontent-%COMP%], .rows-count[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{display:inline-block;width:auto}.rows-count[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{height:1.5rem}.select-direction[_ngcontent-%COMP%]{width:75px}  .sort-by-popover{min-width:400px}@media (max-width:991.98px){  .sort-by-popover{min-width:300px}.rows-count[_ngcontent-%COMP%]{position:static}}"]}),e}()},Yh5v:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var i=n("fXoL"),o=n("ofXK"),c=n("cdP3"),a=n("3Pt+");function r(e,t){1&e&&i.Pb(0)}function s(e,t){if(1&e&&(i.Tb(0,"div",10),i.Cc(1,r,1,0,"ng-container",11),i.hc(2,2),i.Sb()),2&e){i.dc();var n=i.sc(12);i.Bb(1),i.jc("ngTemplateOutlet",n)}}function l(e,t){1&e&&i.Pb(0)}function b(e,t){if(1&e&&(i.Rb(0),i.Cc(1,l,1,0,"ng-container",11),i.Qb()),2&e){i.dc();var n=i.sc(12);i.Bb(1),i.jc("ngTemplateOutlet",n)}}var d=function(e){return{"ml-3":e}},u=function(e){return{"btn-sm":e}};function f(e,t){if(1&e){var n=i.Ub();i.Tb(0,"div",12),i.Tb(1,"label",13),i.bc("ngModelChange",(function(e){return i.vc(n),i.dc().modeState.left=e}))("click",(function(){return i.vc(n),i.dc().onModeState("left")})),i.hc(2,3),i.Sb(),i.Tb(3,"label",14),i.bc("ngModelChange",(function(e){return i.vc(n),i.dc().modeState.right=e}))("click",(function(){return i.vc(n),i.dc().onModeState("right")})),i.hc(4,4),i.Sb(),i.Sb()}if(2&e){var o=i.dc();i.jc("ngClass",i.nc(9,d,o.toggleTop)),i.Bb(1),i.Fb("active",o.modeState.left),i.jc("ngClass",i.nc(11,u,!o.toggleTop))("ngModel",o.modeState.left),i.Bb(2),i.Fb("active",o.modeState.right),i.jc("ngClass",i.nc(13,u,!o.toggleTop))("ngModel",o.modeState.right)}}var p=[[["","left",""]],[["","right",""]],[["","actions",""]],[["","left-label",""]],[["","right-label",""]]],h=["[left]","[right]","[actions]","[left-label]","[right-label]"],m=function(){function e(){this.resized=new i.p,this.leftContentSize=50,this.modeState={left:!0,right:!0}}return e.prototype.ngOnInit=function(){"number"==typeof this.initLeftSize&&(this.leftContentSize=this.initLeftSize,100===this.initLeftSize?this.modeState.right=!1:0===this.initLeftSize&&(this.modeState.left=!1))},e.prototype.onModeState=function(e){this.modeState[e]=!this.modeState[e],this.leftContentSize=this.modeState.left&&!this.modeState.right?100:this.modeState.left&&this.modeState.right?50:0},e.prototype.resize=function(){this.resized.emit(this.modeState)},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Hb({type:e,selectors:[["app-split-content"]],inputs:{initLeftSize:"initLeftSize"},outputs:{resized:"resized"},ngContentSelectors:h,decls:13,vars:6,consts:[[1,"card","overflow-hidden","mb-0","w-100","h-100"],["class","card-header d-flex pl-0 py-2 pr-2",4,"ngIf"],[1,"card-body","d-flex","p-0","flex-column","h-100"],[3,"useTransition","gutterSize","dragEnd","transitionEnd"],[1,"d-flex","mb-0","position-relative",3,"size"],["area0","asSplitArea"],[1,"d-flex","overflow-auto","flex-column","explorer-section","position-relative",3,"size"],["area1","asSplitArea"],[4,"ngIf"],["toggles",""],[1,"card-header","d-flex","pl-0","py-2","pr-2"],[4,"ngTemplateOutlet"],[1,"btn-group","d-block",3,"ngClass"],["ngDefaultControl","","btnCheckbox","","tabindex","0","role","button","name","mode-left",1,"btn","btn-secondary","cursor-pointer","mb-0",3,"ngClass","ngModel","ngModelChange","click"],["ngDefaultControl","","btnCheckbox","","tabindex","0","role","button","name","mode-right",1,"btn","btn-secondary","cursor-pointer","mb-0",3,"ngClass","ngModel","ngModelChange","click"]],template:function(e,t){1&e&&(i.ic(p),i.Tb(0,"div",0),i.Cc(1,s,3,1,"div",1),i.Tb(2,"div",2),i.Tb(3,"as-split",3),i.bc("dragEnd",(function(){return t.resize()}))("transitionEnd",(function(){return t.resize()})),i.Tb(4,"as-split-area",4,5),i.hc(6),i.Sb(),i.Tb(7,"as-split-area",6,7),i.hc(9,1),i.Sb(),i.Sb(),i.Sb(),i.Sb(),i.Cc(10,b,2,1,"ng-container",8),i.Cc(11,f,5,15,"ng-template",null,9,i.Dc)),2&e&&(i.Bb(1),i.jc("ngIf",t.toggleTop),i.Bb(2),i.jc("useTransition",!0)("gutterSize",50===t.leftContentSize?11:0),i.Bb(1),i.jc("size",t.leftContentSize),i.Bb(3),i.jc("size",100-t.leftContentSize),i.Bb(3),i.jc("ngIf",!t.toggleTop))},directives:[o.m,c.c,c.b,o.r,o.k,a.b,a.i,a.l],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"]}),e}()},xpqn:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var i=n("mrSG"),o=n("fXoL"),c=n("XNiG"),a=n("2Vo4"),r=n("44PX"),s=n("1G5W"),l=n("Xwp4"),b=n("j/Mj"),d=n("tyNb"),u=n("tcrU"),f=n("bU/s"),p=n("ZF+8"),h=(n("TwVa"),n("M0ag")),m=n("xgIS"),g=n("Kj3r"),v=n("ofXK"),j=n("3Pt+"),S=n("Yh5v"),y=n("RsUz"),O=["form"],w=["sqlEditor"];function T(e,t){if(1&e){var n=o.Ub();o.Tb(0,"button",24),o.bc("click",(function(){return o.vc(n),o.dc(2).onSave()})),o.Ec(1,"Save"),o.Sb()}if(2&e){var i=o.dc(2);o.jc("disabled",!i.isChanged)}}function C(e,t){if(1&e){var n=o.Ub();o.Tb(0,"button",25),o.bc("click",(function(){return o.vc(n),o.dc(2).onViewDelete()})),o.Ec(1,"Delete"),o.Sb()}}function N(e,t){if(1&e&&(o.Tb(0,"form",1,2),o.Tb(2,"div",3),o.Tb(3,"h5",4),o.Ec(4),o.Sb(),o.Tb(5,"div",5),o.Cc(6,T,2,1,"button",6),o.Cc(7,C,2,0,"button",7),o.Sb(),o.Sb(),o.Tb(8,"app-split-content",8),o.Ob(9,"div",9,10),o.Rb(11,11,12),o.Tb(13,"div",13),o.Tb(14,"wj-flex-grid",14,15),o.Ob(16,"wj-flex-grid-column",16),o.Ob(17,"wj-flex-grid-column",17),o.Ob(18,"wj-flex-grid-column",18),o.Ob(19,"wj-flex-grid-column",19),o.Sb(),o.Sb(),o.Qb(),o.Rb(20,20),o.Ob(21,"i",21),o.Ec(22," SQL editor "),o.Qb(),o.Rb(23,22),o.Ob(24,"i",23),o.Ec(25," Fields "),o.Qb(),o.Sb(),o.Sb()),2&e){var n=o.dc();o.Bb(4),o.Gc("TEST ",n.dataObject.objectName,""),o.Bb(2),o.jc("ngIf",n.saveBtn),o.Bb(1),o.jc("ngIf",n.dataObject),o.Bb(7),o.jc("isReadOnly",!0)("itemsSource",n.collection)("allowDelete",!1)("allowAddNew",!1),o.Bb(2),o.jc("width",50),o.Bb(1),o.jc("minWidth",50)("width","*"),o.Bb(2),o.jc("width",70)}}var x=function(){function e(e,t,n){this.dialogService=e,this.dbService=t,this.notificationService=n,this.edit=new o.p,this.viewDeleted=new o.p,this.viewSaved=new o.p,this.collection=new u.CollectionView,this.isChanged=!1,this.destroy$=new c.a}return e.prototype.ngOnInit=function(){this.collection.sourceCollection=Object(h.l)(this.dataObject)},e.prototype.ngAfterViewInit=function(){var e=this;this.sqlEditor=Object(f.edit)(this.sqlElement.nativeElement,{mode:"ace/mode/sql",autoScrollEditorIntoView:!0,value:this.dataObject.sqlText||"0",theme:Object(h.g)()}),Object(m.a)(this.sqlEditor,"change").pipe(Object(s.a)(this.destroy$),Object(g.a)(200)).subscribe((function(){var t=e.sqlEditor.getValue();e.isChanged=e.dataObject.sqlText!==t,e.edit.emit(t)}))},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.ngOnChanges=function(e){e.dataObject.firstChange||(this.isChanged=!1,this.collection.sourceCollection=Object(h.l)(this.dataObject))},e.prototype.onViewDelete=function(){var e=this;if(this.dataObject){var t=this.dataObject,n=t.objectName,i=t.schemaName;this.dialogService.confirmation("Delete view "+i+"."+n+". Are you sure?").subscribe((function(t){t&&e.dbService.deleteObject(e.connection.connectionName,e.dataObject).subscribe((function(){e.notificationService.success("View "+i+"."+n+" deleted"),e.viewDeleted.emit()}),(function(t){return e.notificationService.error(t)}))}))}},e.prototype.onSave=function(){var e=this;this.dbService.generateObject(this.connection.connectionName,Object(i.a)(Object(i.a)({},this.dataObject),{sqlText:this.sqlEditor.getValue()})).subscribe((function(t){e.viewSaved.emit(t),e.notificationService.success("View "+t.schemaName+"."+t.objectName+" saved")}),(function(t){return e.notificationService.error(t)}))},e.\u0275fac=function(t){return new(t||e)(o.Nb(p.b),o.Nb(p.f),o.Nb(p.e))},e.\u0275cmp=o.Hb({type:e,selectors:[["app-db-view-editor"]],viewQuery:function(e,t){var n;1&e&&(o.Jc(O,!0),o.Jc(w,!0)),2&e&&(o.rc(n=o.cc())&&(t.form=n.first),o.rc(n=o.cc())&&(t.sqlElement=n.first))},inputs:{dataObject:"dataObject",saveBtn:"saveBtn",connection:"connection"},outputs:{edit:"edit",viewDeleted:"viewDeleted",viewSaved:"viewSaved"},features:[o.zb],decls:1,vars:1,consts:[["class","d-flex flex-column h-100",4,"ngIf"],[1,"d-flex","flex-column","h-100"],["form","ngForm"],[1,"row","mx-0"],[1,"px-0","m-0"],[1,"ml-auto","mb-2"],["type","submit","class","btn btn-primary ml-auto mr-1",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-secondary",3,"click",4,"ngIf"],[1,"h-100"],["left","",1,"h-100","p-2","w-100"],["sqlEditor",""],["right","",1,"w-100"],["fields",""],[1,"col","fields-container","d-flex","h-100","px-0","mb-2"],[1,"h-100","border-0",3,"isReadOnly","itemsSource","allowDelete","allowAddNew"],["grid",""],["header","IsKey","binding","isKey","dataType","Boolean",3,"width"],["header","Field Name","binding","fieldName",3,"minWidth","width"],["header","Field Data Type","binding","dataType"],["header","Size","binding","size","dataType","Number",3,"width"],["left-label",""],[1,"fa","fa-cogs","fa-lg"],["right-label",""],[1,"fa","fa-table","fa-lg"],["type","submit",1,"btn","btn-primary","ml-auto","mr-1",3,"disabled","click"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(e,t){1&e&&o.Cc(0,N,26,11,"form",0),2&e&&o.jc("ngIf",t.dataObject)},directives:[v.m,j.t,j.j,j.k,S.a,y.a,y.c],styles:[""]}),e}();function B(e,t){if(1&e&&(o.Ob(0,"i",8),o.Ec(1)),2&e){var n=o.dc();o.Bb(1),o.Gc(" Structure ",n.isSQLChanged?"*":""," ")}}function E(e,t){1&e&&(o.Tb(0,"div",9),o.Tb(1,"div",10),o.Tb(2,"span",11),o.Ec(3,"Loading..."),o.Sb(),o.Sb(),o.Sb())}function q(e,t){1&e&&(o.Ob(0,"i",12),o.Ec(1," Data "))}function M(e,t){if(1&e&&o.Ob(0,"dc-db-grid",13),2&e){var n=o.dc();o.jc("uiModel",n.gridUIModel)}}var I=function(){function e(e,t){this.route=e,this.router=t,this.viewChanged=new o.p,this.viewSaved=new o.p,this.deleted=new o.p,this.loading=!1,this.limitRowsCount=1e3,this.rowsCount=0,this.sortBy=[],this.dataTabShown=!1,this.destroy$=new c.a,this.gridUIModel={type:"db-grid",itemProperties:{tableSource:{connection:null,name:null,alias:null},showHeaderRowFilter:!0,showHeader:!0,onSaveToNewTable:"toNewTable()",isReadOnly:!0,showMenu:!0,showFooterRow:!0}}}return e.prototype.ngOnInit=function(){var e=this;this.gridUIModel.itemProperties.tableSource.connection=this.connection.connectionName,this.gridUIModel.itemProperties.tableSource.name=this.dataObject.schemaName+"."+this.dataObject.objectName,this.gridUIModel.itemProperties.limitRows=this.limitRowsCount,this.gridUIModel.itemProperties.orderBy=this.sortBy,this.dataObject$=new a.a(this.dataObject),this.route.queryParams.pipe(Object(s.a)(this.destroy$)).subscribe((function(t){var n="data"===t.tab;n&&!e.dataTabShown&&(e.dataTabShown=!0),e.tabs.tabs[+n].active=!0}))},e.prototype.ngOnChanges=function(e){var t=e.dataObject;t.firstChange||(this.isSQLChanged=!1,this.dataObject$.next(t.currentValue))},e.prototype.ngOnDestroy=function(){this.destroy$.next(),this.destroy$.complete()},e.prototype.onSortChange=function(e){var t;this.gridUIModel.itemProperties.orderBy=e,null===(t=this.grid)||void 0===t||t.refresh()},e.prototype.onLimitRowsChange=function(e){var t;this.gridUIModel.itemProperties.limitRows=e,null===(t=this.grid)||void 0===t||t.refresh()},e.prototype.onChange=function(e){this.isSQLChanged=e!==this.dataObject.sqlText;var t=this.isSQLChanged?{structure:Object(i.a)(Object(i.a)({},this.dataObject),{sqlText:e}),connection:this.connection}:null;this.viewChanged.emit(t)},e.prototype.onSaved=function(e){this.viewSaved.emit(e),this.dataTabShown=!1,this.rowsLimit.loadRowsCount()},e.prototype.tabSelect=function(e){this.router.navigate([],{queryParamsHandling:"merge",queryParams:{tab:e},relativeTo:this.route})},e.\u0275fac=function(t){return new(t||e)(o.Nb(d.a),o.Nb(d.f))},e.\u0275cmp=o.Hb({type:e,selectors:[["app-db-view"]],viewQuery:function(e,t){var n;1&e&&(o.Ac(r.d,!0),o.Ac(l.a,!0),o.Jc(b.a,!0)),2&e&&(o.rc(n=o.cc())&&(t.tabs=n.first),o.rc(n=o.cc())&&(t.rowsLimit=n.first),o.rc(n=o.cc())&&(t.grid=n.first))},inputs:{dataObject:"dataObject",connection:"connection",saveBtn:"saveBtn"},outputs:{viewChanged:"viewChanged",viewSaved:"viewSaved",deleted:"deleted"},features:[o.zb],decls:9,vars:7,consts:[[3,"connection","sqlObject","limitChange","count","sortByChange"],[1,"tabset-fx","nav-tabs-boxed"],[1,"position-relative",3,"selectTab"],["tabHeading",""],["left","",1,"w-100","h-100",3,"saveBtn","dataObject","connection","viewDeleted","edit","viewSaved"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],[3,"selectTab"],["class","h-100 d-flex position-relative",3,"uiModel",4,"ngIf"],[1,"fa","fa-cogs","fa-lg"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"],[1,"fa","fa-table","fa-lg"],[1,"h-100","d-flex","position-relative",3,"uiModel"]],template:function(e,t){1&e&&(o.Tb(0,"app-rows-limit",0),o.bc("limitChange",(function(e){return t.onLimitRowsChange(e)}))("count",(function(e){return t.rowsCount=e}))("sortByChange",(function(e){return t.onSortChange(e)})),o.Sb(),o.Tb(1,"tabset",1),o.Tb(2,"tab",2),o.bc("selectTab",(function(){return t.tabSelect("structure")})),o.Cc(3,B,2,1,"ng-template",3),o.Tb(4,"app-db-view-editor",4),o.bc("viewDeleted",(function(){return t.deleted.emit()}))("edit",(function(e){return t.onChange(e)}))("viewSaved",(function(e){return t.onSaved(e)})),o.Sb(),o.Cc(5,E,4,0,"div",5),o.Sb(),o.Tb(6,"tab",6),o.bc("selectTab",(function(){return t.tabSelect("data")})),o.Cc(7,q,2,0,"ng-template",3),o.Cc(8,M,1,1,"dc-db-grid",7),o.Sb(),o.Sb()),2&e&&(o.jc("connection",t.connection)("sqlObject",t.dataObject),o.Bb(4),o.jc("saveBtn",t.saveBtn)("dataObject",t.dataObject)("connection",t.connection),o.Bb(1),o.jc("ngIf",t.loading),o.Bb(3),o.jc("ngIf",t.dataTabShown))},directives:[l.a,r.d,r.a,r.b,x,v.m,b.a],styles:[""]}),e}()}}]);