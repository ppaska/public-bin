(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"+8P3":function(e,t,n){"use strict";n.r(t);var i=n("Valr"),o=n("QJY3"),r=n("cSvJ"),a=n("b8dF"),s=n("1PnN"),c=n("g4vN"),l=n("Hph+"),d=n("M0ag"),u=n("DUip"),p=n("mrSG"),f=n("F/XL"),m=n("xMyE"),h=n("15JJ"),v=n("9Z1F"),w=n("TwVa"),g=n("ZF+8"),x=n("iFvM"),y=n("nKjQ"),k=n("cuhF"),b=n("UShy"),M=n("TYT/"),S=n("Xn/w"),j=n("fQZA");function I(e,t){if(1&e&&(M["\u0275\u0275text"](0,"\n\t\t"),M["\u0275\u0275elementStart"](1,"div",2),M["\u0275\u0275text"](2),M["\u0275\u0275elementEnd"](),M["\u0275\u0275text"](3,"\n    ")),2&e){var n=t.$implicit;M["\u0275\u0275advance"](1),M["\u0275\u0275propertyInterpolate"]("title",n.description),M["\u0275\u0275advance"](1),M["\u0275\u0275textInterpolate"](n.worksheetName)}}var E=function(){function e(e,t,n){this.worksheetsService=e,this.router=t,this.route=n}return e.prototype.onSelect=function(e){this.router.navigate(["/",e.ownerName,e.worksheetName])},e.prototype.ngOnInit=function(){var e=this;this.route.params.subscribe((function(t){e.comparator(e.list.selectedItem,t)||e.list.selectItem(t)}))},e.prototype.comparator=function(e,t){return e&&t&&e.worksheetName===t.worksheetName&&e.ownerName===t.ownerName},e.\u0275fac=function(t){return new(t||e)(M["\u0275\u0275directiveInject"](y.a),M["\u0275\u0275directiveInject"](u.f),M["\u0275\u0275directiveInject"](u.a))},e.\u0275cmp=M["\u0275\u0275defineComponent"]({type:e,selectors:[["app-worksheets-list"]],viewQuery:function(e,t){var n;1&e&&M["\u0275\u0275staticViewQuery"](d.a,!0),2&e&&M["\u0275\u0275queryRefresh"](n=M["\u0275\u0275loadQuery"]())&&(t.list=n.first)},decls:7,vars:4,consts:[["orderBy","id","group","groupName",1,"d-flex","h-100","overflow-auto",3,"list","comparator","select"],["listView",""],[1,"m-1","pl-3",3,"title"]],template:function(e,t){1&e&&(M["\u0275\u0275elementStart"](0,"app-list-view",0,1),M["\u0275\u0275listener"]("select",(function(e){return t.onSelect(e)})),M["\u0275\u0275pipe"](2,"async"),M["\u0275\u0275text"](3,"\n\t"),M["\u0275\u0275template"](4,I,4,2,"ng-template"),M["\u0275\u0275text"](5,"\n"),M["\u0275\u0275elementEnd"](),M["\u0275\u0275text"](6,"\n")),2&e&&M["\u0275\u0275property"]("list",M["\u0275\u0275pipeBind1"](2,2,t.worksheetsService.worksheets$))("comparator",t.comparator)},directives:[j.a],pipes:[i.AsyncPipe],styles:[""]}),e}();function C(e,t){if(1&e){var n=M["\u0275\u0275getCurrentView"]();M["\u0275\u0275elementStart"](0,"button",9),M["\u0275\u0275listener"]("click",(function(){return M["\u0275\u0275restoreView"](n),M["\u0275\u0275nextContext"]().editWorksheet()})),M["\u0275\u0275text"](1,"\n      "),M["\u0275\u0275element"](2,"i",10),M["\u0275\u0275text"](3," Edit Worksheet\n    "),M["\u0275\u0275elementEnd"]()}if(2&e){var i=M["\u0275\u0275nextContext"]();M["\u0275\u0275property"]("disabled",!i.worksheet)}}function N(e,t){if(1&e){var n=M["\u0275\u0275getCurrentView"]();M["\u0275\u0275elementStart"](0,"ngx-dynamic-component",12),M["\u0275\u0275listener"]("eventHandlers",(function(e){return M["\u0275\u0275restoreView"](n),M["\u0275\u0275nextContext"](2).eventHandlers(e)})),M["\u0275\u0275elementEnd"]()}if(2&e){var i=M["\u0275\u0275nextContext"](2);M["\u0275\u0275property"]("uiModel",i.worksheet.uiModelXml)("dataModel",i.dataModel)}}function O(e,t){if(1&e&&(M["\u0275\u0275elementContainerStart"](0),M["\u0275\u0275text"](1,"\n      "),M["\u0275\u0275template"](2,N,1,2,"ngx-dynamic-component",11),M["\u0275\u0275text"](3,"\n    "),M["\u0275\u0275elementContainerEnd"]()),2&e){var n=M["\u0275\u0275nextContext"]();M["\u0275\u0275advance"](2),M["\u0275\u0275property"]("ngIf",!n.editMode)}}function W(e,t){1&e&&(M["\u0275\u0275elementStart"](0,"div",13),M["\u0275\u0275text"](1,"\n      "),M["\u0275\u0275elementStart"](2,"div",14),M["\u0275\u0275elementStart"](3,"span",15),M["\u0275\u0275text"](4,"Loading..."),M["\u0275\u0275elementEnd"](),M["\u0275\u0275elementEnd"](),M["\u0275\u0275text"](5,"\n    "),M["\u0275\u0275elementEnd"]())}var A=function(){function e(e,t,n,i){this.route=e,this.worksheetsService=t,this.notificationService=n,this.dialogService=i,this.layoutConfig={icon:"assets/img/rc-logo-64x64.png",smIcon:"assets/img/rc-logo-36x36.png",appName:"worksheet"},this.editMode=!1,this.loading=!0,this.dataModel={}}return e.prototype.ngOnInit=function(){var e=this;this.worksheetsService.loadWorksheets().toPromise(),this.route.params.pipe(Object(m.a)((function(){e.worksheet=null,e.loading=!0})),Object(h.a)((function(t){return e.worksheetsService.getWorksheet(t.ownerName,t.worksheetName)})),Object(v.a)((function(t){return e.notificationService.open({type:w.f.DANGER,message:Object(x.k)(t)}),Object(f.a)(null)}))).subscribe((function(t){e.worksheet=t,e.loading=!1,e.setMenu()})),this.interpreter=Object(b.a)()},e.prototype.editWorksheet=function(){this.dialogService.open(k.a,{class:"modal-w-90 full-height"}).config=this.worksheet},e.prototype.eventHandlers=function(e){var t=e.eventName,n=e.parameters,i=void 0===n?null:n;if(this.interpreter&&this.interpreter.hasFunction(this.worksheet.scripts,t)){this.loading=!0;try{this.interpreter.evaluate(this.worksheet.scripts,Object(p.a)({rootUIModel:this.worksheet.uiModel,dataModel:this.dataModel},i),t)}catch(o){this.interpreter.evaluate('alert("'+o.message+'")')}finally{this.loading=!1}}},e.prototype.setMenu=function(){var e=this;this.layoutConfig.menuItems=this.worksheet.isAdmin?this.editMode?[{label:"Run Mode",icon:"fa fa-play-circle-o",command:function(){e.editMode=!1,e.setMenu()}}]:[{label:"Design Mode",icon:"fa fa-paint-brush",command:function(){e.editMode=!0,e.setMenu()}}]:[]},e.\u0275fac=function(t){return new(t||e)(M["\u0275\u0275directiveInject"](u.a),M["\u0275\u0275directiveInject"](y.a),M["\u0275\u0275directiveInject"](g.e),M["\u0275\u0275directiveInject"](g.b))},e.\u0275cmp=M["\u0275\u0275defineComponent"]({type:e,selectors:[["app-worksheet-layout"]],decls:24,vars:4,consts:[[3,"config"],["title","",1,"mb-0","ml-0","top-sub-header","w-md-down-50"],["header","",1,"ml-auto","d-flex","mr-2"],["settings",""],["class","btn btn-light btn-sm mr-2 align-self-center","title","Edit Worksheet",3,"disabled","click",4,"ngIf"],["sidebar","",1,"h-100","w-100","py-2","pl-2","d-flex","flex-column"],["content",""],[4,"ngIf"],["class","d-flex justify-content-center position-absolute align-items-center w-100 h-100 spinner flex-column",4,"ngIf"],["title","Edit Worksheet",1,"btn","btn-light","btn-sm","mr-2","align-self-center",3,"disabled","click"],[1,"fa","fa-edit"],[3,"uiModel","dataModel","eventHandlers",4,"ngIf"],[3,"uiModel","dataModel","eventHandlers"],[1,"d-flex","justify-content-center","position-absolute","align-items-center","w-100","h-100","spinner","flex-column"],["role","status",1,"spinner-border"],[1,"sr-only"]],template:function(e,t){1&e&&(M["\u0275\u0275elementStart"](0,"app-layout",0),M["\u0275\u0275text"](1,"\n  "),M["\u0275\u0275elementStart"](2,"h2",1),M["\u0275\u0275text"](3,"WORKSHEET "),M["\u0275\u0275elementStart"](4,"span"),M["\u0275\u0275text"](5,"SYSTEMS"),M["\u0275\u0275elementEnd"](),M["\u0275\u0275elementEnd"](),M["\u0275\u0275text"](6,"\n  "),M["\u0275\u0275element"](7,"div",2),M["\u0275\u0275text"](8,"\n  "),M["\u0275\u0275elementContainerStart"](9,3),M["\u0275\u0275text"](10,"\n    "),M["\u0275\u0275template"](11,C,4,1,"button",4),M["\u0275\u0275text"](12,"\n  "),M["\u0275\u0275elementContainerEnd"](),M["\u0275\u0275text"](13,"\n  "),M["\u0275\u0275element"](14,"app-worksheets-list",5),M["\u0275\u0275text"](15,"\n  "),M["\u0275\u0275elementContainerStart"](16,6),M["\u0275\u0275text"](17,"\n    "),M["\u0275\u0275template"](18,O,4,1,"ng-container",7),M["\u0275\u0275text"](19,"\n    "),M["\u0275\u0275template"](20,W,6,0,"div",8),M["\u0275\u0275text"](21,"\n  "),M["\u0275\u0275elementContainerEnd"](),M["\u0275\u0275text"](22,"\n"),M["\u0275\u0275elementEnd"](),M["\u0275\u0275text"](23,"\n")),2&e&&(M["\u0275\u0275property"]("config",t.layoutConfig),M["\u0275\u0275advance"](11),M["\u0275\u0275property"]("ngIf",t.worksheet&&t.worksheet.isAdmin&&t.editMode),M["\u0275\u0275advance"](7),M["\u0275\u0275property"]("ngIf",t.worksheet),M["\u0275\u0275advance"](2),M["\u0275\u0275property"]("ngIf",t.loading))},directives:[S.a,i.NgIf,E,c.i],styles:[".btn[_ngcontent-%COMP%]   i.fa[_ngcontent-%COMP%]{width:13px}"]}),e}(),F=n("67Y/"),V=[{path:":worksheetName",component:A,canActivate:[function(){function e(e,t,n){this.router=e,this.worksheetsService=t,this.notificationService=n}return e.prototype.canActivate=function(e,t){var n=this,i=e.params;return this.worksheetsService.getWorksheet(i.ownerName,i.worksheetName).pipe(Object(F.a)((function(t){if(t)return e.data=Object(p.a)(Object(p.a)({},e.data),{guardedData:t}),!0;throw Error("Worksheet not available")})),Object(v.a)((function(e){return n.notificationService.open({type:w.f.DANGER,message:"You are not authorized to use this worksheet"}),n.router.navigate(["/login"],{queryParams:{returnUrl:t.url}}),Object(f.a)(!1)})))},e.\u0275fac=function(t){return new(t||e)(M["\u0275\u0275inject"](u.f),M["\u0275\u0275inject"](y.a),M["\u0275\u0275inject"](g.e))},e.\u0275prov=M["\u0275\u0275defineInjectable"]({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()]}],H=function(){function e(){}return e.\u0275mod=M["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=M["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[u.i.forChild(V)],u.i]}),e}();n.d(t,"WorksheetModule",(function(){return P}));var P=function(){function e(){}return e.\u0275mod=M["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=M["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.CommonModule,o.FormsModule,H,d.c,c.b,l.a,r.c.forRoot(),a.b.forRoot(),s.b]]}),e}()}}]);